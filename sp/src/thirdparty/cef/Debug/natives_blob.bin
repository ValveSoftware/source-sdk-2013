mirrorsÅ
(function(a,b){
"use strict";
var c=a.Array;
var d=a.isNaN;
var e=a.JSON.stringify;
var f;
var g;
var h=b.ImportNow("promise_state_symbol");
var i=b.ImportNow("promise_result_symbol");
var j;
var k;
b.Import(function(l){
f=l.MapEntries;
g=l.MapIteratorNext;
j=l.SetIteratorNext;
k=l.SetValues;
});
var m={
UNDEFINED_TYPE:'undefined',
NULL_TYPE:'null',
BOOLEAN_TYPE:'boolean',
NUMBER_TYPE:'number',
STRING_TYPE:'string',
SYMBOL_TYPE:'symbol',
OBJECT_TYPE:'object',
FUNCTION_TYPE:'function',
REGEXP_TYPE:'regexp',
ERROR_TYPE:'error',
PROPERTY_TYPE:'property',
INTERNAL_PROPERTY_TYPE:'internalProperty',
FRAME_TYPE:'frame',
SCRIPT_TYPE:'script',
CONTEXT_TYPE:'context',
SCOPE_TYPE:'scope',
PROMISE_TYPE:'promise',
MAP_TYPE:'map',
SET_TYPE:'set',
ITERATOR_TYPE:'iterator',
GENERATOR_TYPE:'generator',
}
var n=0;
var o=-1;
var p=[];
var q=true;
function MirrorCacheIsEmpty(){
return n==0&&p.length==0;
}
function ToggleMirrorCache(r){
q=r;
ClearMirrorCache();
}
function ClearMirrorCache(r){
n=0;
p=[];
}
function ObjectIsPromise(r){
return(%_IsJSReceiver(r))&&
!(%DebugGetProperty(r,h)===(void 0));
}
function MakeMirror(r,s){
var t;
if(!s&&q){
for(var u in p){
t=p[u];
if(t.value()===r){
return t;
}
if(t.isNumber()&&d(t.value())&&
typeof r=='number'&&d(r)){
return t;
}
}
}
if((r===(void 0))){
t=new UndefinedMirror();
}else if((r===null)){
t=new NullMirror();
}else if((typeof(r)==='boolean')){
t=new BooleanMirror(r);
}else if((typeof(r)==='number')){
t=new NumberMirror(r);
}else if((typeof(r)==='string')){
t=new StringMirror(r);
}else if((typeof(r)==='symbol')){
t=new SymbolMirror(r);
}else if((%_IsArray(r))){
t=new ArrayMirror(r);
}else if((%IsDate(r))){
t=new DateMirror(r);
}else if((%IsFunction(r))){
t=new FunctionMirror(r);
}else if((%_IsRegExp(r))){
t=new RegExpMirror(r);
}else if((%_ClassOf(r)==='Error')){
t=new ErrorMirror(r);
}else if((%_ClassOf(r)==='Script')){
t=new ScriptMirror(r);
}else if((%_ClassOf(r)==='Map')||(%_ClassOf(r)==='WeakMap')){
t=new MapMirror(r);
}else if((%_ClassOf(r)==='Set')||(%_ClassOf(r)==='WeakSet')){
t=new SetMirror(r);
}else if((%_ClassOf(r)==='Map Iterator')||(%_ClassOf(r)==='Set Iterator')){
t=new IteratorMirror(r);
}else if(ObjectIsPromise(r)){
t=new PromiseMirror(r);
}else if((%_ClassOf(r)==='Generator')){
t=new GeneratorMirror(r);
}else{
t=new ObjectMirror(r,m.OBJECT_TYPE,s);
}
if(q)p[t.handle()]=t;
return t;
}
function LookupMirror(v){
if(!q){
throw %make_error(2,"Mirror cache is disabled");
}
return p[v];
}
function GetUndefinedMirror(){
return MakeMirror((void 0));
}
function inherits(w,x){
var y=function(){};
y.prototype=x.prototype;
w.super_=x.prototype;
w.prototype=new y();
w.prototype.constructor=w;
}
var z=80;
var A={};
A.Data=0;
A.DataConstant=2;
A.AccessorConstant=3;
var B={};
B.None=0;
B.ReadOnly=1;
B.DontEnum=2;
B.DontDelete=4;
var C={Global:0,
Local:1,
With:2,
Closure:3,
Catch:4,
Block:5,
Script:6,
Eval:7,
};
function Mirror(D){
this.type_=D;
}
Mirror.prototype.type=function(){
return this.type_;
};
Mirror.prototype.isValue=function(){
return this instanceof ValueMirror;
};
Mirror.prototype.isUndefined=function(){
return this instanceof UndefinedMirror;
};
Mirror.prototype.isNull=function(){
return this instanceof NullMirror;
};
Mirror.prototype.isBoolean=function(){
return this instanceof BooleanMirror;
};
Mirror.prototype.isNumber=function(){
return this instanceof NumberMirror;
};
Mirror.prototype.isString=function(){
return this instanceof StringMirror;
};
Mirror.prototype.isSymbol=function(){
return this instanceof SymbolMirror;
};
Mirror.prototype.isObject=function(){
return this instanceof ObjectMirror;
};
Mirror.prototype.isFunction=function(){
return this instanceof FunctionMirror;
};
Mirror.prototype.isUnresolvedFunction=function(){
return this instanceof UnresolvedFunctionMirror;
};
Mirror.prototype.isArray=function(){
return this instanceof ArrayMirror;
};
Mirror.prototype.isDate=function(){
return this instanceof DateMirror;
};
Mirror.prototype.isRegExp=function(){
return this instanceof RegExpMirror;
};
Mirror.prototype.isError=function(){
return this instanceof ErrorMirror;
};
Mirror.prototype.isPromise=function(){
return this instanceof PromiseMirror;
};
Mirror.prototype.isGenerator=function(){
return this instanceof GeneratorMirror;
};
Mirror.prototype.isProperty=function(){
return this instanceof PropertyMirror;
};
Mirror.prototype.isInternalProperty=function(){
return this instanceof InternalPropertyMirror;
};
Mirror.prototype.isFrame=function(){
return this instanceof FrameMirror;
};
Mirror.prototype.isScript=function(){
return this instanceof ScriptMirror;
};
Mirror.prototype.isContext=function(){
return this instanceof ContextMirror;
};
Mirror.prototype.isScope=function(){
return this instanceof ScopeMirror;
};
Mirror.prototype.isMap=function(){
return this instanceof MapMirror;
};
Mirror.prototype.isSet=function(){
return this instanceof SetMirror;
};
Mirror.prototype.isIterator=function(){
return this instanceof IteratorMirror;
};
Mirror.prototype.allocateHandle_=function(){
if(q)this.handle_=n++;
};
Mirror.prototype.allocateTransientHandle_=function(){
this.handle_=o--;
};
Mirror.prototype.toText=function(){
return"#<"+this.constructor.name+">";
};
function ValueMirror(D,r,E){
%_Call(Mirror,this,D);
this.value_=r;
if(!E){
this.allocateHandle_();
}else{
this.allocateTransientHandle_();
}
}
inherits(ValueMirror,Mirror);
Mirror.prototype.handle=function(){
return this.handle_;
};
ValueMirror.prototype.isPrimitive=function(){
var D=this.type();
return D==='undefined'||
D==='null'||
D==='boolean'||
D==='number'||
D==='string'||
D==='symbol';
};
ValueMirror.prototype.value=function(){
return this.value_;
};
function UndefinedMirror(){
%_Call(ValueMirror,this,m.UNDEFINED_TYPE,(void 0));
}
inherits(UndefinedMirror,ValueMirror);
UndefinedMirror.prototype.toText=function(){
return'undefined';
};
function NullMirror(){
%_Call(ValueMirror,this,m.NULL_TYPE,null);
}
inherits(NullMirror,ValueMirror);
NullMirror.prototype.toText=function(){
return'null';
};
function BooleanMirror(r){
%_Call(ValueMirror,this,m.BOOLEAN_TYPE,r);
}
inherits(BooleanMirror,ValueMirror);
BooleanMirror.prototype.toText=function(){
return this.value_?'true':'false';
};
function NumberMirror(r){
%_Call(ValueMirror,this,m.NUMBER_TYPE,r);
}
inherits(NumberMirror,ValueMirror);
NumberMirror.prototype.toText=function(){
return %_NumberToString(this.value_);
};
function StringMirror(r){
%_Call(ValueMirror,this,m.STRING_TYPE,r);
}
inherits(StringMirror,ValueMirror);
StringMirror.prototype.length=function(){
return this.value_.length;
};
StringMirror.prototype.getTruncatedValue=function(F){
if(F!=-1&&this.length()>F){
return this.value_.substring(0,F)+
'... (length: '+this.length()+')';
}
return this.value_;
};
StringMirror.prototype.toText=function(){
return this.getTruncatedValue(z);
};
function SymbolMirror(r){
%_Call(ValueMirror,this,m.SYMBOL_TYPE,r);
}
inherits(SymbolMirror,ValueMirror);
SymbolMirror.prototype.description=function(){
return %SymbolDescription(%ValueOf(this.value_));
}
SymbolMirror.prototype.toText=function(){
return %SymbolDescriptiveString(%ValueOf(this.value_));
}
function ObjectMirror(r,D,E){
D=D||m.OBJECT_TYPE;
%_Call(ValueMirror,this,D,r,E);
}
inherits(ObjectMirror,ValueMirror);
ObjectMirror.prototype.className=function(){
return %_ClassOf(this.value_);
};
ObjectMirror.prototype.constructorFunction=function(){
return MakeMirror(%DebugGetProperty(this.value_,'constructor'));
};
ObjectMirror.prototype.prototypeObject=function(){
return MakeMirror(%DebugGetProperty(this.value_,'prototype'));
};
ObjectMirror.prototype.protoObject=function(){
return MakeMirror(%DebugGetPrototype(this.value_));
};
ObjectMirror.prototype.hasNamedInterceptor=function(){
var G=%GetInterceptorInfo(this.value_);
return(G&2)!=0;
};
ObjectMirror.prototype.hasIndexedInterceptor=function(){
var G=%GetInterceptorInfo(this.value_);
return(G&1)!=0;
};
ObjectMirror.prototype.propertyNames=function(){
return %GetOwnPropertyKeys(this.value_,0);
};
ObjectMirror.prototype.properties=function(){
var H=this.propertyNames();
var I=new c(H.length);
for(var J=0;J<H.length;J++){
I[J]=this.property(H[J]);
}
return I;
};
ObjectMirror.prototype.internalProperties=function(){
return ObjectMirror.GetInternalProperties(this.value_);
}
ObjectMirror.prototype.property=function(K){
var L=%DebugGetPropertyDetails(this.value_,K);
if(L){
return new PropertyMirror(this,K,L);
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.lookupProperty=function(r){
var I=this.properties();
for(var J=0;J<I.length;J++){
var M=I[J];
if(M.propertyType()!=A.AccessorConstant){
if(M.value_===r.value_){
return M;
}
}
}
return GetUndefinedMirror();
};
ObjectMirror.prototype.referencedBy=function(N){
var O=%DebugReferencedBy(this.value_,
Mirror.prototype,N||0);
for(var J=0;J<O.length;J++){
O[J]=MakeMirror(O[J]);
}
return O;
};
ObjectMirror.prototype.toText=function(){
var K;
var w=this.constructorFunction();
if(!w.isFunction()){
K=this.className();
}else{
K=w.name();
if(!K){
K=this.className();
}
}
return'#<'+K+'>';
};
ObjectMirror.GetInternalProperties=function(r){
var I=%DebugGetInternalProperties(r);
var O=[];
for(var J=0;J<I.length;J+=2){
O.push(new InternalPropertyMirror(I[J],I[J+1]));
}
return O;
}
function FunctionMirror(r){
%_Call(ObjectMirror,this,r,m.FUNCTION_TYPE);
this.resolved_=true;
}
inherits(FunctionMirror,ObjectMirror);
FunctionMirror.prototype.resolved=function(){
return this.resolved_;
};
FunctionMirror.prototype.name=function(){
return %FunctionGetName(this.value_);
};
FunctionMirror.prototype.debugName=function(){
return %FunctionGetDebugName(this.value_);
}
FunctionMirror.prototype.inferredName=function(){
return %FunctionGetInferredName(this.value_);
};
FunctionMirror.prototype.source=function(){
if(this.resolved()){
return %FunctionToString(this.value_);
}
};
FunctionMirror.prototype.script=function(){
if(this.resolved()){
if(this.script_){
return this.script_;
}
var P=%FunctionGetScript(this.value_);
if(P){
return this.script_=MakeMirror(P);
}
}
};
FunctionMirror.prototype.sourcePosition_=function(){
if(this.resolved()){
return %FunctionGetScriptSourcePosition(this.value_);
}
};
FunctionMirror.prototype.sourceLocation=function(){
if(this.resolved()){
var P=this.script();
if(P){
return P.locationFromPosition(this.sourcePosition_(),true);
}
}
};
FunctionMirror.prototype.constructedBy=function(Q){
if(this.resolved()){
var O=%DebugConstructedBy(this.value_,Q||0);
for(var J=0;J<O.length;J++){
O[J]=MakeMirror(O[J]);
}
return O;
}else{
return[];
}
};
FunctionMirror.prototype.scopeCount=function(){
if(this.resolved()){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetFunctionScopeCount(this.value());
}
return this.scopeCount_;
}else{
return 0;
}
};
FunctionMirror.prototype.scope=function(R){
if(this.resolved()){
return new ScopeMirror((void 0),this,(void 0),R);
}
};
FunctionMirror.prototype.toText=function(){
return this.source();
};
FunctionMirror.prototype.context=function(){
if(this.resolved()){
if(!this._context)
this._context=new ContextMirror(%FunctionGetContextData(this.value_));
return this._context;
}
};
function UnresolvedFunctionMirror(r){
%_Call(ValueMirror,this,m.FUNCTION_TYPE,r);
this.propertyCount_=0;
this.elementCount_=0;
this.resolved_=false;
}
inherits(UnresolvedFunctionMirror,FunctionMirror);
UnresolvedFunctionMirror.prototype.className=function(){
return'Function';
};
UnresolvedFunctionMirror.prototype.constructorFunction=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.prototypeObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.protoObject=function(){
return GetUndefinedMirror();
};
UnresolvedFunctionMirror.prototype.name=function(){
return this.value_;
};
UnresolvedFunctionMirror.prototype.debugName=function(){
return this.value_;
};
UnresolvedFunctionMirror.prototype.inferredName=function(){
return(void 0);
};
UnresolvedFunctionMirror.prototype.propertyNames=function(S,T){
return[];
};
function ArrayMirror(r){
%_Call(ObjectMirror,this,r);
}
inherits(ArrayMirror,ObjectMirror);
ArrayMirror.prototype.length=function(){
return this.value_.length;
};
ArrayMirror.prototype.indexedPropertiesFromRange=function(opt_from_index,
opt_to_index){
var U=opt_from_index||0;
var V=opt_to_index||this.length()-1;
if(U>V)return new c();
var W=new c(V-U+1);
for(var J=U;J<=V;J++){
var L=%DebugGetPropertyDetails(this.value_,(%_ToString(J)));
var r;
if(L){
r=new PropertyMirror(this,J,L);
}else{
r=GetUndefinedMirror();
}
W[J-U]=r;
}
return W;
};
function DateMirror(r){
%_Call(ObjectMirror,this,r);
}
inherits(DateMirror,ObjectMirror);
DateMirror.prototype.toText=function(){
var X=e(this.value_);
return X.substring(1,X.length-1);
};
function RegExpMirror(r){
%_Call(ObjectMirror,this,r,m.REGEXP_TYPE);
}
inherits(RegExpMirror,ObjectMirror);
RegExpMirror.prototype.source=function(){
return this.value_.source;
};
RegExpMirror.prototype.global=function(){
return this.value_.global;
};
RegExpMirror.prototype.ignoreCase=function(){
return this.value_.ignoreCase;
};
RegExpMirror.prototype.multiline=function(){
return this.value_.multiline;
};
RegExpMirror.prototype.sticky=function(){
return this.value_.sticky;
};
RegExpMirror.prototype.unicode=function(){
return this.value_.unicode;
};
RegExpMirror.prototype.toText=function(){
return"/"+this.source()+"/";
};
function ErrorMirror(r){
%_Call(ObjectMirror,this,r,m.ERROR_TYPE);
}
inherits(ErrorMirror,ObjectMirror);
ErrorMirror.prototype.message=function(){
return this.value_.message;
};
ErrorMirror.prototype.toText=function(){
var Y;
try{
Y=%ErrorToString(this.value_);
}catch(e){
Y='#<Error>';
}
return Y;
};
function PromiseMirror(r){
%_Call(ObjectMirror,this,r,m.PROMISE_TYPE);
}
inherits(PromiseMirror,ObjectMirror);
function PromiseGetStatus_(r){
var Z=%DebugGetProperty(r,h);
if(Z==0)return"pending";
if(Z==1)return"resolved";
return"rejected";
}
function PromiseGetValue_(r){
return %DebugGetProperty(r,i);
}
PromiseMirror.prototype.status=function(){
return PromiseGetStatus_(this.value_);
};
PromiseMirror.prototype.promiseValue=function(){
return MakeMirror(PromiseGetValue_(this.value_));
};
function MapMirror(r){
%_Call(ObjectMirror,this,r,m.MAP_TYPE);
}
inherits(MapMirror,ObjectMirror);
MapMirror.prototype.entries=function(aa){
var O=[];
if((%_ClassOf(this.value_)==='WeakMap')){
var ab=%GetWeakMapEntries(this.value_,aa||0);
for(var J=0;J<ab.length;J+=2){
O.push({
key:ab[J],
value:ab[J+1]
});
}
return O;
}
var ac=%_Call(f,this.value_);
var ad;
while((!aa||O.length<aa)&&
!(ad=ac.next()).done){
O.push({
key:ad.value[0],
value:ad.value[1]
});
}
return O;
};
function SetMirror(r){
%_Call(ObjectMirror,this,r,m.SET_TYPE);
}
inherits(SetMirror,ObjectMirror);
function IteratorGetValues_(ac,ae,aa){
var O=[];
var ad;
while((!aa||O.length<aa)&&
!(ad=%_Call(ae,ac)).done){
O.push(ad.value);
}
return O;
}
SetMirror.prototype.values=function(aa){
if((%_ClassOf(this.value_)==='WeakSet')){
return %GetWeakSetValues(this.value_,aa||0);
}
var ac=%_Call(k,this.value_);
return IteratorGetValues_(ac,j,aa);
};
function IteratorMirror(r){
%_Call(ObjectMirror,this,r,m.ITERATOR_TYPE);
}
inherits(IteratorMirror,ObjectMirror);
IteratorMirror.prototype.preview=function(aa){
if((%_ClassOf(this.value_)==='Map Iterator')){
return IteratorGetValues_(%MapIteratorClone(this.value_),
g,
aa);
}else if((%_ClassOf(this.value_)==='Set Iterator')){
return IteratorGetValues_(%SetIteratorClone(this.value_),
j,
aa);
}
};
function GeneratorMirror(r){
%_Call(ObjectMirror,this,r,m.GENERATOR_TYPE);
}
inherits(GeneratorMirror,ObjectMirror);
function GeneratorGetStatus_(r){
var af=%GeneratorGetContinuation(r);
if(af<-1)return"running";
if(af==-1)return"closed";
return"suspended";
}
GeneratorMirror.prototype.status=function(){
return GeneratorGetStatus_(this.value_);
};
GeneratorMirror.prototype.sourcePosition_=function(){
return %GeneratorGetSourcePosition(this.value_);
};
GeneratorMirror.prototype.sourceLocation=function(){
var ag=this.sourcePosition_();
if(!(ag===(void 0))){
var P=this.func().script();
if(P){
return P.locationFromPosition(ag,true);
}
}
};
GeneratorMirror.prototype.func=function(){
if(!this.func_){
this.func_=MakeMirror(%GeneratorGetFunction(this.value_));
}
return this.func_;
};
GeneratorMirror.prototype.receiver=function(){
if(!this.receiver_){
this.receiver_=MakeMirror(%GeneratorGetReceiver(this.value_));
}
return this.receiver_;
};
GeneratorMirror.prototype.scopeCount=function(){
return %GetGeneratorScopeCount(this.value());
};
GeneratorMirror.prototype.scope=function(R){
return new ScopeMirror((void 0),(void 0),this,R);
};
GeneratorMirror.prototype.allScopes=function(){
var ah=[];
for(let J=0;J<this.scopeCount();J++){
ah.push(this.scope(J));
}
return ah;
};
function PropertyMirror(t,K,L){
%_Call(Mirror,this,m.PROPERTY_TYPE);
this.mirror_=t;
this.name_=K;
this.value_=L[0];
this.details_=L[1];
this.is_interceptor_=L[2];
if(L.length>3){
this.exception_=L[3];
this.getter_=L[4];
this.setter_=L[5];
}
}
inherits(PropertyMirror,Mirror);
PropertyMirror.prototype.isReadOnly=function(){
return(this.attributes()&B.ReadOnly)!=0;
};
PropertyMirror.prototype.isEnum=function(){
return(this.attributes()&B.DontEnum)==0;
};
PropertyMirror.prototype.canDelete=function(){
return(this.attributes()&B.DontDelete)==0;
};
PropertyMirror.prototype.name=function(){
return this.name_;
};
PropertyMirror.prototype.toText=function(){
if((typeof(this.name_)==='symbol'))return %SymbolDescriptiveString(this.name_);
return this.name_;
};
PropertyMirror.prototype.isIndexed=function(){
for(var J=0;J<this.name_.length;J++){
if(this.name_[J]<'0'||'9'<this.name_[J]){
return false;
}
}
return true;
};
PropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
PropertyMirror.prototype.isException=function(){
return this.exception_?true:false;
};
PropertyMirror.prototype.attributes=function(){
return %DebugPropertyAttributesFromDetails(this.details_);
};
PropertyMirror.prototype.propertyType=function(){
return %DebugPropertyTypeFromDetails(this.details_);
};
PropertyMirror.prototype.hasGetter=function(){
return this.getter_?true:false;
};
PropertyMirror.prototype.hasSetter=function(){
return this.setter_?true:false;
};
PropertyMirror.prototype.getter=function(){
if(this.hasGetter()){
return MakeMirror(this.getter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.setter=function(){
if(this.hasSetter()){
return MakeMirror(this.setter_);
}else{
return GetUndefinedMirror();
}
};
PropertyMirror.prototype.isNative=function(){
return this.is_interceptor_||
((this.propertyType()==A.AccessorConstant)&&
!this.hasGetter()&&!this.hasSetter());
};
function InternalPropertyMirror(K,r){
%_Call(Mirror,this,m.INTERNAL_PROPERTY_TYPE);
this.name_=K;
this.value_=r;
}
inherits(InternalPropertyMirror,Mirror);
InternalPropertyMirror.prototype.name=function(){
return this.name_;
};
InternalPropertyMirror.prototype.value=function(){
return MakeMirror(this.value_,false);
};
var ai=0;
var aj=1;
var ak=2;
var al=3;
var am=4;
var an=5;
var ao=6;
var ap=7;
var aq=8;
var ar=9;
var as=10;
var at=0;
var au=1;
var av=2;
var aw=1<<0;
var ax=1<<1;
var ay=7<<2;
function FrameDetails(az,R){
this.break_id_=az;
this.details_=%GetFrameDetails(az,R);
}
FrameDetails.prototype.frameId=function(){
%CheckExecutionState(this.break_id_);
return this.details_[ai];
};
FrameDetails.prototype.receiver=function(){
%CheckExecutionState(this.break_id_);
return this.details_[aj];
};
FrameDetails.prototype.func=function(){
%CheckExecutionState(this.break_id_);
return this.details_[ak];
};
FrameDetails.prototype.script=function(){
%CheckExecutionState(this.break_id_);
return this.details_[al];
};
FrameDetails.prototype.isConstructCall=function(){
%CheckExecutionState(this.break_id_);
return this.details_[ap];
};
FrameDetails.prototype.isAtReturn=function(){
%CheckExecutionState(this.break_id_);
return this.details_[aq];
};
FrameDetails.prototype.isDebuggerFrame=function(){
%CheckExecutionState(this.break_id_);
var aA=aw;
return(this.details_[ar]&aA)==aA;
};
FrameDetails.prototype.isOptimizedFrame=function(){
%CheckExecutionState(this.break_id_);
var aA=ax;
return(this.details_[ar]&aA)==aA;
};
FrameDetails.prototype.isInlinedFrame=function(){
return this.inlinedFrameIndex()>0;
};
FrameDetails.prototype.inlinedFrameIndex=function(){
%CheckExecutionState(this.break_id_);
var aA=ay;
return(this.details_[ar]&aA)>>2;
};
FrameDetails.prototype.argumentCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[am];
};
FrameDetails.prototype.argumentName=function(R){
%CheckExecutionState(this.break_id_);
if(R>=0&&R<this.argumentCount()){
return this.details_[as+
R*av+
at];
}
};
FrameDetails.prototype.argumentValue=function(R){
%CheckExecutionState(this.break_id_);
if(R>=0&&R<this.argumentCount()){
return this.details_[as+
R*av+
au];
}
};
FrameDetails.prototype.localCount=function(){
%CheckExecutionState(this.break_id_);
return this.details_[an];
};
FrameDetails.prototype.sourcePosition=function(){
%CheckExecutionState(this.break_id_);
return this.details_[ao];
};
FrameDetails.prototype.localName=function(R){
%CheckExecutionState(this.break_id_);
if(R>=0&&R<this.localCount()){
var aB=as+
this.argumentCount()*av;
return this.details_[aB+
R*av+
at];
}
};
FrameDetails.prototype.localValue=function(R){
%CheckExecutionState(this.break_id_);
if(R>=0&&R<this.localCount()){
var aB=as+
this.argumentCount()*av;
return this.details_[aB+
R*av+
au];
}
};
FrameDetails.prototype.returnValue=function(){
%CheckExecutionState(this.break_id_);
var aC=
as+
(this.argumentCount()+this.localCount())*av;
if(this.details_[aq]){
return this.details_[aC];
}
};
FrameDetails.prototype.scopeCount=function(){
if((this.scopeCount_===(void 0))){
this.scopeCount_=%GetScopeCount(this.break_id_,this.frameId());
}
return this.scopeCount_;
};
function FrameMirror(az,R){
%_Call(Mirror,this,m.FRAME_TYPE);
this.break_id_=az;
this.index_=R;
this.details_=new FrameDetails(az,R);
}
inherits(FrameMirror,Mirror);
FrameMirror.prototype.details=function(){
return this.details_;
};
FrameMirror.prototype.index=function(){
return this.index_;
};
FrameMirror.prototype.func=function(){
if(this.func_){
return this.func_;
}
var aA=this.details_.func();
if((%IsFunction(aA))){
return this.func_=MakeMirror(aA);
}else{
return new UnresolvedFunctionMirror(aA);
}
};
FrameMirror.prototype.receiver=function(){
return MakeMirror(this.details_.receiver());
};
FrameMirror.prototype.isConstructCall=function(){
return this.details_.isConstructCall();
};
FrameMirror.prototype.isAtReturn=function(){
return this.details_.isAtReturn();
};
FrameMirror.prototype.isDebuggerFrame=function(){
return this.details_.isDebuggerFrame();
};
FrameMirror.prototype.isOptimizedFrame=function(){
return this.details_.isOptimizedFrame();
};
FrameMirror.prototype.isInlinedFrame=function(){
return this.details_.isInlinedFrame();
};
FrameMirror.prototype.inlinedFrameIndex=function(){
return this.details_.inlinedFrameIndex();
};
FrameMirror.prototype.argumentCount=function(){
return this.details_.argumentCount();
};
FrameMirror.prototype.argumentName=function(R){
return this.details_.argumentName(R);
};
FrameMirror.prototype.argumentValue=function(R){
return MakeMirror(this.details_.argumentValue(R));
};
FrameMirror.prototype.localCount=function(){
return this.details_.localCount();
};
FrameMirror.prototype.localName=function(R){
return this.details_.localName(R);
};
FrameMirror.prototype.localValue=function(R){
return MakeMirror(this.details_.localValue(R));
};
FrameMirror.prototype.returnValue=function(){
return MakeMirror(this.details_.returnValue());
};
FrameMirror.prototype.sourcePosition=function(){
return this.details_.sourcePosition();
};
FrameMirror.prototype.sourceLocation=function(){
var aD=this.func();
if(aD.resolved()){
var P=aD.script();
if(P){
return P.locationFromPosition(this.sourcePosition(),true);
}
}
};
FrameMirror.prototype.sourceLine=function(){
var aE=this.sourceLocation();
if(aE){
return aE.line;
}
};
FrameMirror.prototype.sourceColumn=function(){
var aE=this.sourceLocation();
if(aE){
return aE.column;
}
};
FrameMirror.prototype.sourceLineText=function(){
var aE=this.sourceLocation();
if(aE){
return aE.sourceText;
}
};
FrameMirror.prototype.scopeCount=function(){
return this.details_.scopeCount();
};
FrameMirror.prototype.scope=function(R){
return new ScopeMirror(this,(void 0),(void 0),R);
};
FrameMirror.prototype.allScopes=function(aF){
var aG=%GetAllScopesDetails(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
!!aF);
var O=[];
for(var J=0;J<aG.length;++J){
O.push(new ScopeMirror(this,(void 0),(void 0),J,
aG[J]));
}
return O;
};
FrameMirror.prototype.evaluate=function(source,disable_break,
opt_context_object){
return MakeMirror(%DebugEvaluate(this.break_id_,
this.details_.frameId(),
this.details_.inlinedFrameIndex(),
source,
(!!(disable_break)),
opt_context_object));
};
FrameMirror.prototype.invocationText=function(){
var O='';
var aD=this.func();
var aH=this.receiver();
if(this.isConstructCall()){
O+='new ';
O+=aD.name()?aD.name():'[anonymous]';
}else if(this.isDebuggerFrame()){
O+='[debugger]';
}else{
var aI=
!aH.className||(aH.className()!='global');
if(aI){
O+=aH.toText();
}
var M=GetUndefinedMirror();
if(aH.isObject()){
for(var aJ=aH;
!aJ.isNull()&&M.isUndefined();
aJ=aJ.protoObject()){
M=aJ.lookupProperty(aD);
}
}
if(!M.isUndefined()){
if(!M.isIndexed()){
if(aI){
O+='.';
}
O+=M.toText();
}else{
O+='[';
O+=M.toText();
O+=']';
}
if(aD.name()&&aD.name()!=M.name()){
O+='(aka '+aD.name()+')';
}
}else{
if(aI){
O+='.';
}
O+=aD.name()?aD.name():'[anonymous]';
}
}
if(!this.isDebuggerFrame()){
O+='(';
for(var J=0;J<this.argumentCount();J++){
if(J!=0)O+=', ';
if(this.argumentName(J)){
O+=this.argumentName(J);
O+='=';
}
O+=this.argumentValue(J).toText();
}
O+=')';
}
if(this.isAtReturn()){
O+=' returning ';
O+=this.returnValue().toText();
}
return O;
};
FrameMirror.prototype.sourceAndPositionText=function(){
var O='';
var aD=this.func();
if(aD.resolved()){
var P=aD.script();
if(P){
if(P.name()){
O+=P.name();
}else{
O+='[unnamed]';
}
if(!this.isDebuggerFrame()){
var aE=this.sourceLocation();
O+=' line ';
O+=!(aE===(void 0))?(aE.line+1):'?';
O+=' column ';
O+=!(aE===(void 0))?(aE.column+1):'?';
if(!(this.sourcePosition()===(void 0))){
O+=' (position '+(this.sourcePosition()+1)+')';
}
}
}else{
O+='[no source]';
}
}else{
O+='[unresolved]';
}
return O;
};
FrameMirror.prototype.localsText=function(){
var O='';
var aK=this.localCount();
if(aK>0){
for(var J=0;J<aK;++J){
O+='      var ';
O+=this.localName(J);
O+=' = ';
O+=this.localValue(J).toText();
if(J<aK-1)O+='\n';
}
}
return O;
};
FrameMirror.prototype.restart=function(){
var O=%LiveEditRestartFrame(this.break_id_,this.index_);
if((O===(void 0))){
O="Failed to find requested frame";
}
return O;
};
FrameMirror.prototype.toText=function(aL){
var O='';
O+='#'+(this.index()<=9?'0':'')+this.index();
O+=' ';
O+=this.invocationText();
O+=' ';
O+=this.sourceAndPositionText();
if(aL){
O+='\n';
O+=this.localsText();
}
return O;
};
var aM=0;
var aN=1;
var aO=2;
var aP=3;
var aQ=4;
var aR=5;
function ScopeDetails(aS,aT,aU,R,aV){
if(aS){
this.break_id_=aS.break_id_;
this.details_=aV||
%GetScopeDetails(aS.break_id_,
aS.details_.frameId(),
aS.details_.inlinedFrameIndex(),
R);
this.frame_id_=aS.details_.frameId();
this.inlined_frame_id_=aS.details_.inlinedFrameIndex();
}else if(aT){
this.details_=aV||%GetFunctionScopeDetails(aT.value(),R);
this.fun_value_=aT.value();
this.break_id_=(void 0);
}else{
this.details_=
aV||%GetGeneratorScopeDetails(aU.value(),R);
this.gen_value_=aU.value();
this.break_id_=(void 0);
}
this.index_=R;
}
ScopeDetails.prototype.type=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aM];
};
ScopeDetails.prototype.object=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aN];
};
ScopeDetails.prototype.name=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aO];
};
ScopeDetails.prototype.startPosition=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aP];
}
ScopeDetails.prototype.endPosition=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aQ];
}
ScopeDetails.prototype.func=function(){
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
}
return this.details_[aR];
}
ScopeDetails.prototype.setVariableValueImpl=function(K,aW){
var aX;
if(!(this.break_id_===(void 0))){
%CheckExecutionState(this.break_id_);
aX=%SetScopeVariableValue(this.break_id_,this.frame_id_,
this.inlined_frame_id_,this.index_,K,aW);
}else if(!(this.fun_value_===(void 0))){
aX=%SetScopeVariableValue(this.fun_value_,null,null,this.index_,
K,aW);
}else{
aX=%SetScopeVariableValue(this.gen_value_,null,null,this.index_,
K,aW);
}
if(!aX)throw %make_error(2,"Failed to set variable value");
};
function ScopeMirror(aS,aT,aU,R,aV){
%_Call(Mirror,this,m.SCOPE_TYPE);
if(aS){
this.frame_index_=aS.index_;
}else{
this.frame_index_=(void 0);
}
this.scope_index_=R;
this.details_=new ScopeDetails(aS,aT,aU,R,aV);
}
inherits(ScopeMirror,Mirror);
ScopeMirror.prototype.details=function(){
return this.details_;
};
ScopeMirror.prototype.frameIndex=function(){
return this.frame_index_;
};
ScopeMirror.prototype.scopeIndex=function(){
return this.scope_index_;
};
ScopeMirror.prototype.scopeType=function(){
return this.details_.type();
};
ScopeMirror.prototype.scopeObject=function(){
var E=this.scopeType()==C.Local||
this.scopeType()==C.Closure||
this.scopeType()==C.Script;
return MakeMirror(this.details_.object(),E);
};
ScopeMirror.prototype.setVariableValue=function(K,aW){
this.details_.setVariableValueImpl(K,aW);
};
function ScriptMirror(P){
%_Call(Mirror,this,m.SCRIPT_TYPE);
this.script_=P;
this.context_=new ContextMirror(P.context_data);
this.allocateHandle_();
}
inherits(ScriptMirror,Mirror);
ScriptMirror.prototype.value=function(){
return this.script_;
};
ScriptMirror.prototype.name=function(){
return this.script_.name||this.script_.nameOrSourceURL();
};
ScriptMirror.prototype.id=function(){
return this.script_.id;
};
ScriptMirror.prototype.source=function(){
return this.script_.source;
};
ScriptMirror.prototype.setSource=function(aY){
if(!(typeof(aY)==='string'))throw %make_error(2,"Source is not a string");
%DebugSetScriptSource(this.script_,aY);
};
ScriptMirror.prototype.lineOffset=function(){
return this.script_.line_offset;
};
ScriptMirror.prototype.columnOffset=function(){
return this.script_.column_offset;
};
ScriptMirror.prototype.data=function(){
return this.script_.data;
};
ScriptMirror.prototype.scriptType=function(){
return this.script_.type;
};
ScriptMirror.prototype.compilationType=function(){
return this.script_.compilation_type;
};
ScriptMirror.prototype.lineCount=function(){
return %ScriptLineCount(this.script_);
};
ScriptMirror.prototype.locationFromPosition=function(
position,include_resource_offset){
return this.script_.locationFromPosition(position,include_resource_offset);
};
ScriptMirror.prototype.context=function(){
return this.context_;
};
ScriptMirror.prototype.evalFromScript=function(){
return MakeMirror(this.script_.eval_from_script);
};
ScriptMirror.prototype.evalFromFunctionName=function(){
return MakeMirror(this.script_.eval_from_function_name);
};
ScriptMirror.prototype.evalFromLocation=function(){
var aZ=this.evalFromScript();
if(!aZ.isUndefined()){
var ba=this.script_.eval_from_script_position;
return aZ.locationFromPosition(ba,true);
}
};
ScriptMirror.prototype.toText=function(){
var O='';
O+=this.name();
O+=' (lines: ';
if(this.lineOffset()>0){
O+=this.lineOffset();
O+='-';
O+=this.lineOffset()+this.lineCount()-1;
}else{
O+=this.lineCount();
}
O+=')';
return O;
};
function ContextMirror(bb){
%_Call(Mirror,this,m.CONTEXT_TYPE);
this.data_=bb;
this.allocateHandle_();
}
inherits(ContextMirror,Mirror);
ContextMirror.prototype.data=function(){
return this.data_;
};
function MakeMirrorSerializer(L,bc){
return new JSONProtocolSerializer(L,bc);
}
function JSONProtocolSerializer(L,bc){
this.details_=L;
this.options_=bc;
this.mirrors_=[];
}
JSONProtocolSerializer.prototype.serializeReference=function(t){
return this.serialize_(t,true,true);
};
JSONProtocolSerializer.prototype.serializeValue=function(t){
var bd=this.serialize_(t,false,true);
return bd;
};
JSONProtocolSerializer.prototype.serializeReferencedObjects=function(){
var be=[];
var bf=this.mirrors_.length;
for(var J=0;J<bf;J++){
be.push(this.serialize_(this.mirrors_[J],false,false));
}
return be;
};
JSONProtocolSerializer.prototype.includeSource_=function(){
return this.options_&&this.options_.includeSource;
};
JSONProtocolSerializer.prototype.inlineRefs_=function(){
return this.options_&&this.options_.inlineRefs;
};
JSONProtocolSerializer.prototype.maxStringLength_=function(){
if((this.options_===(void 0))||
(this.options_.maxStringLength===(void 0))){
return z;
}
return this.options_.maxStringLength;
};
JSONProtocolSerializer.prototype.add_=function(t){
for(var J=0;J<this.mirrors_.length;J++){
if(this.mirrors_[J]===t){
return;
}
}
this.mirrors_.push(t);
};
JSONProtocolSerializer.prototype.serializeReferenceWithDisplayData_=
function(t){
var bg={};
bg.ref=t.handle();
bg.type=t.type();
switch(t.type()){
case m.UNDEFINED_TYPE:
case m.NULL_TYPE:
case m.BOOLEAN_TYPE:
case m.NUMBER_TYPE:
bg.value=t.value();
break;
case m.STRING_TYPE:
bg.value=t.getTruncatedValue(this.maxStringLength_());
break;
case m.SYMBOL_TYPE:
bg.description=t.description();
break;
case m.FUNCTION_TYPE:
bg.name=t.name();
bg.inferredName=t.inferredName();
if(t.script()){
bg.scriptId=t.script().id();
}
break;
case m.ERROR_TYPE:
case m.REGEXP_TYPE:
bg.value=t.toText();
break;
case m.OBJECT_TYPE:
bg.className=t.className();
break;
}
return bg;
};
JSONProtocolSerializer.prototype.serialize_=function(t,reference,
L){
if(reference&&
(t.isValue()||t.isScript()||t.isContext())){
if(this.inlineRefs_()&&t.isValue()){
return this.serializeReferenceWithDisplayData_(t);
}else{
this.add_(t);
return{'ref':t.handle()};
}
}
var be={};
if(t.isValue()||t.isScript()||t.isContext()){
be.handle=t.handle();
}
be.type=t.type();
switch(t.type()){
case m.UNDEFINED_TYPE:
case m.NULL_TYPE:
break;
case m.BOOLEAN_TYPE:
be.value=t.value();
break;
case m.NUMBER_TYPE:
be.value=NumberToJSON_(t.value());
break;
case m.STRING_TYPE:
if(this.maxStringLength_()!=-1&&
t.length()>this.maxStringLength_()){
var bh=t.getTruncatedValue(this.maxStringLength_());
be.value=bh;
be.fromIndex=0;
be.toIndex=this.maxStringLength_();
}else{
be.value=t.value();
}
be.length=t.length();
break;
case m.SYMBOL_TYPE:
be.description=t.description();
break;
case m.OBJECT_TYPE:
case m.FUNCTION_TYPE:
case m.ERROR_TYPE:
case m.REGEXP_TYPE:
case m.PROMISE_TYPE:
case m.GENERATOR_TYPE:
this.serializeObject_(t,be,L);
break;
case m.PROPERTY_TYPE:
case m.INTERNAL_PROPERTY_TYPE:
throw %make_error(2,
'PropertyMirror cannot be serialized independently');
break;
case m.FRAME_TYPE:
this.serializeFrame_(t,be);
break;
case m.SCOPE_TYPE:
this.serializeScope_(t,be);
break;
case m.SCRIPT_TYPE:
if(t.name()){
be.name=t.name();
}
be.id=t.id();
be.lineOffset=t.lineOffset();
be.columnOffset=t.columnOffset();
be.lineCount=t.lineCount();
if(t.data()){
be.data=t.data();
}
if(this.includeSource_()){
be.source=t.source();
}else{
var bi=t.source().substring(0,80);
be.sourceStart=bi;
}
be.sourceLength=t.source().length;
be.scriptType=t.scriptType();
be.compilationType=t.compilationType();
if(t.compilationType()==1&&
t.evalFromScript()){
be.evalFromScript=
this.serializeReference(t.evalFromScript());
var bj=t.evalFromLocation();
if(bj){
be.evalFromLocation={line:bj.line,
column:bj.column};
}
if(t.evalFromFunctionName()){
be.evalFromFunctionName=t.evalFromFunctionName();
}
}
if(t.context()){
be.context=this.serializeReference(t.context());
}
break;
case m.CONTEXT_TYPE:
be.data=t.data();
break;
}
be.text=t.toText();
return be;
};
JSONProtocolSerializer.prototype.serializeObject_=function(t,be,
L){
be.className=t.className();
be.constructorFunction=
this.serializeReference(t.constructorFunction());
be.protoObject=this.serializeReference(t.protoObject());
be.prototypeObject=this.serializeReference(t.prototypeObject());
if(t.hasNamedInterceptor()){
be.namedInterceptor=true;
}
if(t.hasIndexedInterceptor()){
be.indexedInterceptor=true;
}
if(t.isFunction()){
be.name=t.name();
if(!(t.inferredName()===(void 0))){
be.inferredName=t.inferredName();
}
be.resolved=t.resolved();
if(t.resolved()){
be.source=t.source();
}
if(t.script()){
be.script=this.serializeReference(t.script());
be.scriptId=t.script().id();
serializeLocationFields(t.sourceLocation(),be);
}
be.scopes=[];
for(var J=0;J<t.scopeCount();J++){
var bk=t.scope(J);
be.scopes.push({
type:bk.scopeType(),
index:J
});
}
}
if(t.isGenerator()){
be.status=t.status();
be.func=this.serializeReference(t.func())
be.receiver=this.serializeReference(t.receiver())
serializeLocationFields(t.sourceLocation(),be);
}
if(t.isDate()){
be.value=t.value();
}
if(t.isPromise()){
be.status=t.status();
be.promiseValue=this.serializeReference(t.promiseValue());
}
var I=t.propertyNames();
for(var J=0;J<I.length;J++){
var bl=t.property(I[J]);
I[J]=this.serializeProperty_(bl);
if(L){
this.add_(bl.value());
}
}
be.properties=I;
var bm=t.internalProperties();
if(bm.length>0){
var bn=[];
for(var J=0;J<bm.length;J++){
bn.push(this.serializeInternalProperty_(bm[J]));
}
be.internalProperties=bn;
}
};
function serializeLocationFields(aE,be){
if(!aE){
return;
}
be.position=aE.position;
var bo=aE.line;
if(!(bo===(void 0))){
be.line=bo;
}
var bp=aE.column;
if(!(bp===(void 0))){
be.column=bp;
}
}
JSONProtocolSerializer.prototype.serializeProperty_=function(bl){
var O={};
O.name=bl.name();
var bq=bl.value();
if(this.inlineRefs_()&&bq.isValue()){
O.value=this.serializeReferenceWithDisplayData_(bq);
}else{
if(bl.attributes()!=B.None){
O.attributes=bl.attributes();
}
O.propertyType=bl.propertyType();
O.ref=bq.handle();
}
return O;
};
JSONProtocolSerializer.prototype.serializeInternalProperty_=
function(bl){
var O={};
O.name=bl.name();
var bq=bl.value();
if(this.inlineRefs_()&&bq.isValue()){
O.value=this.serializeReferenceWithDisplayData_(bq);
}else{
O.ref=bq.handle();
}
return O;
};
JSONProtocolSerializer.prototype.serializeFrame_=function(t,be){
be.index=t.index();
be.receiver=this.serializeReference(t.receiver());
var aD=t.func();
be.func=this.serializeReference(aD);
var P=aD.script();
if(P){
be.script=this.serializeReference(P);
}
be.constructCall=t.isConstructCall();
be.atReturn=t.isAtReturn();
if(t.isAtReturn()){
be.returnValue=this.serializeReference(t.returnValue());
}
be.debuggerFrame=t.isDebuggerFrame();
var G=new c(t.argumentCount());
for(var J=0;J<t.argumentCount();J++){
var br={};
var bs=t.argumentName(J);
if(bs){
br.name=bs;
}
br.value=this.serializeReference(t.argumentValue(J));
G[J]=br;
}
be.arguments=G;
var G=new c(t.localCount());
for(var J=0;J<t.localCount();J++){
var bt={};
bt.name=t.localName(J);
bt.value=this.serializeReference(t.localValue(J));
G[J]=bt;
}
be.locals=G;
serializeLocationFields(t.sourceLocation(),be);
var bu=t.sourceLineText();
if(!(bu===(void 0))){
be.sourceLineText=bu;
}
be.scopes=[];
for(var J=0;J<t.scopeCount();J++){
var bk=t.scope(J);
be.scopes.push({
type:bk.scopeType(),
index:J
});
}
};
JSONProtocolSerializer.prototype.serializeScope_=function(t,be){
be.index=t.scopeIndex();
be.frameIndex=t.frameIndex();
be.type=t.scopeType();
be.object=this.inlineRefs_()?
this.serializeValue(t.scopeObject()):
this.serializeReference(t.scopeObject());
};
function NumberToJSON_(r){
if(d(r)){
return'NaN';
}
if(!(%_IsSmi(%IS_VAR(r))||((r==r)&&(r!=1/0)&&(r!=-1/0)))){
if(r>0){
return'Infinity';
}else{
return'-Infinity';
}
}
return r;
}
b.InstallFunctions(a,2,[
"MakeMirror",MakeMirror,
"MakeMirrorSerializer",MakeMirrorSerializer,
"LookupMirror",LookupMirror,
"ToggleMirrorCache",ToggleMirrorCache,
"MirrorCacheIsEmpty",MirrorCacheIsEmpty,
]);
b.InstallConstants(a,[
"ScopeType",C,
"PropertyType",A,
"PropertyAttribute",B,
"Mirror",Mirror,
"ValueMirror",ValueMirror,
"UndefinedMirror",UndefinedMirror,
"NullMirror",NullMirror,
"BooleanMirror",BooleanMirror,
"NumberMirror",NumberMirror,
"StringMirror",StringMirror,
"SymbolMirror",SymbolMirror,
"ObjectMirror",ObjectMirror,
"FunctionMirror",FunctionMirror,
"UnresolvedFunctionMirror",UnresolvedFunctionMirror,
"ArrayMirror",ArrayMirror,
"DateMirror",DateMirror,
"RegExpMirror",RegExpMirror,
"ErrorMirror",ErrorMirror,
"PromiseMirror",PromiseMirror,
"MapMirror",MapMirror,
"SetMirror",SetMirror,
"IteratorMirror",IteratorMirror,
"GeneratorMirror",GeneratorMirror,
"PropertyMirror",PropertyMirror,
"InternalPropertyMirror",InternalPropertyMirror,
"FrameMirror",FrameMirror,
"ScriptMirror",ScriptMirror,
"ScopeMirror",ScopeMirror,
"FrameDetails",FrameDetails,
]);
b.InstallFunctions(b,2,[
"ClearMirrorCache",ClearMirrorCache
]);
b.Export(function(bv){
bv.MirrorType=m;
});
})

debugf
(function(a,b){
"use strict";
var c=a.FrameMirror;
var d=a.Array;
var e=a.RegExp;
var f=a.isNaN;
var g=a.JSON.parse;
var h=a.JSON.stringify;
var i=a.LookupMirror;
var j=a.MakeMirror;
var k=a.MakeMirrorSerializer;
var l=a.Math.min;
var m=a.Mirror;
var n;
var o=a.parseInt;
var p=a.ValueMirror;
b.Import(function(q){
n=q.MirrorType;
});
var r=10;
var s={};
var t=/^(?:\s*(?:\/\*.*?\*\/)*)*/;
s.DebugEvent={Break:1,
Exception:2,
NewFunction:3,
BeforeCompile:4,
AfterCompile:5,
CompileError:6,
AsyncTaskEvent:7};
s.ExceptionBreak={Caught:0,
Uncaught:1};
s.StepAction={StepOut:0,
StepNext:1,
StepIn:2,
StepFrame:3};
s.ScriptType={Native:0,
Extension:1,
Normal:2,
Wasm:3};
s.ScriptCompilationType={Host:0,
Eval:1,
JSON:2};
s.ScriptBreakPointType={ScriptId:0,
ScriptName:1,
ScriptRegExp:2};
s.BreakPositionAlignment={
Statement:0,
BreakPosition:1
};
function ScriptTypeFlag(u){
return(1<<u);
}
var v=0;
var w=1;
var x=[];
var y=[];
var z={
breakPointsActive:{
value:true,
getValue:function(){return this.value;},
setValue:function(A){
this.value=!!A;
%SetBreakPointsActive(this.value);
}
},
breakOnCaughtException:{
getValue:function(){return s.isBreakOnException();},
setValue:function(A){
if(A){
s.setBreakOnException();
}else{
s.clearBreakOnException();
}
}
},
breakOnUncaughtException:{
getValue:function(){return s.isBreakOnUncaughtException();},
setValue:function(A){
if(A){
s.setBreakOnUncaughtException();
}else{
s.clearBreakOnUncaughtException();
}
}
},
};
function MakeBreakPoint(B,C){
var D=new BreakPoint(B,C);
x.push(D);
return D;
}
function BreakPoint(B,C){
this.source_position_=B;
if(C){
this.script_break_point_=C;
}else{
this.number_=w++;
}
this.active_=true;
this.condition_=null;
}
BreakPoint.prototype.number=function(){
return this.number_;
};
BreakPoint.prototype.func=function(){
return this.func_;
};
BreakPoint.prototype.source_position=function(){
return this.source_position_;
};
BreakPoint.prototype.active=function(){
if(this.script_break_point()){
return this.script_break_point().active();
}
return this.active_;
};
BreakPoint.prototype.condition=function(){
if(this.script_break_point()&&this.script_break_point().condition()){
return this.script_break_point().condition();
}
return this.condition_;
};
BreakPoint.prototype.script_break_point=function(){
return this.script_break_point_;
};
BreakPoint.prototype.enable=function(){
this.active_=true;
};
BreakPoint.prototype.disable=function(){
this.active_=false;
};
BreakPoint.prototype.setCondition=function(E){
this.condition_=E;
};
BreakPoint.prototype.isTriggered=function(F){
if(!this.active())return false;
if(this.condition()){
try{
var G=F.frame(0).evaluate(this.condition());
if(!(G instanceof p)||!G.value_){
return false;
}
}catch(e){
return false;
}
}
return true;
};
function IsBreakPointTriggered(H,D){
return D.isTriggered(MakeExecutionState(H));
}
function ScriptBreakPoint(u,script_id_or_name,opt_line,opt_column,
opt_groupId,opt_position_alignment){
this.type_=u;
if(u==s.ScriptBreakPointType.ScriptId){
this.script_id_=script_id_or_name;
}else if(u==s.ScriptBreakPointType.ScriptName){
this.script_name_=script_id_or_name;
}else if(u==s.ScriptBreakPointType.ScriptRegExp){
this.script_regexp_object_=new e(script_id_or_name);
}else{
throw %make_error(2,"Unexpected breakpoint type "+u);
}
this.line_=opt_line||0;
this.column_=opt_column;
this.groupId_=opt_groupId;
this.position_alignment_=(opt_position_alignment===(void 0))
?s.BreakPositionAlignment.Statement:opt_position_alignment;
this.active_=true;
this.condition_=null;
this.break_points_=[];
}
ScriptBreakPoint.prototype.cloneForOtherScript=function(I){
var J=new ScriptBreakPoint(s.ScriptBreakPointType.ScriptId,
I.id,this.line_,this.column_,this.groupId_,
this.position_alignment_);
J.number_=w++;
y.push(J);
J.active_=this.active_;
J.condition_=this.condition_;
return J;
};
ScriptBreakPoint.prototype.number=function(){
return this.number_;
};
ScriptBreakPoint.prototype.groupId=function(){
return this.groupId_;
};
ScriptBreakPoint.prototype.type=function(){
return this.type_;
};
ScriptBreakPoint.prototype.script_id=function(){
return this.script_id_;
};
ScriptBreakPoint.prototype.script_name=function(){
return this.script_name_;
};
ScriptBreakPoint.prototype.script_regexp_object=function(){
return this.script_regexp_object_;
};
ScriptBreakPoint.prototype.line=function(){
return this.line_;
};
ScriptBreakPoint.prototype.column=function(){
return this.column_;
};
ScriptBreakPoint.prototype.actual_locations=function(){
var K=[];
for(var L=0;L<this.break_points_.length;L++){
K.push(this.break_points_[L].actual_location);
}
return K;
};
ScriptBreakPoint.prototype.update_positions=function(M,N){
this.line_=M;
this.column_=N;
};
ScriptBreakPoint.prototype.active=function(){
return this.active_;
};
ScriptBreakPoint.prototype.condition=function(){
return this.condition_;
};
ScriptBreakPoint.prototype.enable=function(){
this.active_=true;
};
ScriptBreakPoint.prototype.disable=function(){
this.active_=false;
};
ScriptBreakPoint.prototype.setCondition=function(E){
this.condition_=E;
};
ScriptBreakPoint.prototype.matchesScript=function(O){
if(this.type_==s.ScriptBreakPointType.ScriptId){
return this.script_id_==O.id;
}else{
if(!(O.line_offset<=this.line_&&
this.line_<O.line_offset+%ScriptLineCount(O))){
return false;
}
if(this.type_==s.ScriptBreakPointType.ScriptName){
return this.script_name_==O.nameOrSourceURL();
}else if(this.type_==s.ScriptBreakPointType.ScriptRegExp){
return this.script_regexp_object_.test(O.nameOrSourceURL());
}else{
throw %make_error(2,"Unexpected breakpoint type "+this.type_);
}
}
};
ScriptBreakPoint.prototype.set=function(O){
var N=this.column();
var M=this.line();
if((N===(void 0))){
var P=%ScriptSourceLine(O,M||O.line_offset);
if(!O.sourceColumnStart_){
O.sourceColumnStart_=new d(%ScriptLineCount(O));
}
if((O.sourceColumnStart_[M]===(void 0))){
O.sourceColumnStart_[M]=
P.match(t)[0].length;
}
N=O.sourceColumnStart_[M];
}
var Q=s.findScriptSourcePosition(O,this.line(),N);
if((Q===null))return;
var D=MakeBreakPoint(Q,this);
var R=%SetScriptBreakPoint(O,Q,
this.position_alignment_,
D);
if((R===(void 0))){
R=Q;
}
var S=O.locationFromPosition(R,true);
D.actual_location={line:S.line,
column:S.column,
script_id:O.id};
this.break_points_.push(D);
return D;
};
ScriptBreakPoint.prototype.clear=function(){
var T=[];
for(var L=0;L<x.length;L++){
if(x[L].script_break_point()&&
x[L].script_break_point()===this){
%ClearBreakPoint(x[L]);
}else{
T.push(x[L]);
}
}
x=T;
this.break_points_=[];
};
function UpdateScriptBreakPoints(O){
for(var L=0;L<y.length;L++){
var D=y[L];
if((D.type()==s.ScriptBreakPointType.ScriptName||
D.type()==s.ScriptBreakPointType.ScriptRegExp)&&
D.matchesScript(O)){
D.set(O);
}
}
}
function GetScriptBreakPoints(O){
var U=[];
for(var L=0;L<y.length;L++){
if(y[L].matchesScript(O)){
U.push(y[L]);
}
}
return U;
}
s.setListener=function(V,W){
if(!(%IsFunction(V))&&!(V===(void 0))&&!(V===null)){
throw %make_type_error(33);
}
%SetDebugEventListener(V,W);
};
s.findScript=function(X){
if((%IsFunction(X))){
return %FunctionGetScript(X);
}else if((%_IsRegExp(X))){
var Y=this.scripts();
var Z=null;
var aa=0;
for(var L in Y){
var O=Y[L];
if(X.test(O.name)){
Z=O;
aa++;
}
}
if(aa==1){
return Z;
}else{
return(void 0);
}
}else{
return %GetScript(X);
}
};
s.scriptSource=function(X){
return this.findScript(X).source;
};
s.source=function(ab){
if(!(%IsFunction(ab)))throw %make_type_error(33);
return %FunctionGetSourceCode(ab);
};
s.sourcePosition=function(ab){
if(!(%IsFunction(ab)))throw %make_type_error(33);
return %FunctionGetScriptSourcePosition(ab);
};
s.findFunctionSourceLocation=function(ac,ad,ae){
var O=%FunctionGetScript(ac);
var af=%FunctionGetScriptSourcePosition(ac);
return %ScriptLocationFromLine(O,ad,ae,af);
};
s.findScriptSourcePosition=function(O,ad,ae){
var ag=%ScriptLocationFromLine(O,ad,ae,0);
return ag?ag.position:null;
};
s.findBreakPoint=function(ah,ai){
var D;
for(var L=0;L<x.length;L++){
if(x[L].number()==ah){
D=x[L];
if(ai){
x.splice(L,1);
}
break;
}
}
if(D){
return D;
}else{
return this.findScriptBreakPoint(ah,ai);
}
};
s.findBreakPointActualLocations=function(ah){
for(var L=0;L<y.length;L++){
if(y[L].number()==ah){
return y[L].actual_locations();
}
}
for(var L=0;L<x.length;L++){
if(x[L].number()==ah){
return[x[L].actual_location];
}
}
return[];
};
s.setBreakPoint=function(ac,ad,ae,aj){
if(!(%IsFunction(ac)))throw %make_type_error(33);
if(%FunctionIsAPIFunction(ac)){
throw %make_error(2,'Cannot set break point in native code.');
}
var B=
this.findFunctionSourceLocation(ac,ad,ae).position;
var O=%FunctionGetScript(ac);
if(O.type==s.ScriptType.Native){
throw %make_error(2,'Cannot set break point in native code.');
}
if(O&&O.id){
var ag=O.locationFromPosition(B,false);
return this.setScriptBreakPointById(O.id,
ag.line,ag.column,
aj);
}else{
var D=MakeBreakPoint(B);
var R=
%SetFunctionBreakPoint(ac,B,D);
var S=O.locationFromPosition(R,true);
D.actual_location={line:S.line,
column:S.column,
script_id:O.id};
D.setCondition(aj);
return D.number();
}
};
s.setBreakPointByScriptIdAndPosition=function(script_id,Q,
E,enabled,
opt_position_alignment)
{
var D=MakeBreakPoint(Q);
D.setCondition(E);
if(!enabled){
D.disable();
}
var O=scriptById(script_id);
if(O){
var ak=(opt_position_alignment===(void 0))
?s.BreakPositionAlignment.Statement:opt_position_alignment;
D.actual_position=%SetScriptBreakPoint(O,Q,
ak,D);
}
return D;
};
s.enableBreakPoint=function(ah){
var D=this.findBreakPoint(ah,false);
if(D){
D.enable();
}
};
s.disableBreakPoint=function(ah){
var D=this.findBreakPoint(ah,false);
if(D){
D.disable();
}
};
s.changeBreakPointCondition=function(ah,E){
var D=this.findBreakPoint(ah,false);
D.setCondition(E);
};
s.clearBreakPoint=function(ah){
var D=this.findBreakPoint(ah,true);
if(D){
return %ClearBreakPoint(D);
}else{
D=this.findScriptBreakPoint(ah,true);
if(!D)throw %make_error(2,'Invalid breakpoint');
}
};
s.clearAllBreakPoints=function(){
for(var L=0;L<x.length;L++){
var D=x[L];
%ClearBreakPoint(D);
}
x=[];
};
s.disableAllBreakPoints=function(){
for(var L=1;L<w;L++){
s.disableBreakPoint(L);
}
%ChangeBreakOnException(s.ExceptionBreak.Caught,false);
%ChangeBreakOnException(s.ExceptionBreak.Uncaught,false);
};
s.findScriptBreakPoint=function(ah,ai){
var al;
for(var L=0;L<y.length;L++){
if(y[L].number()==ah){
al=y[L];
if(ai){
al.clear();
y.splice(L,1);
}
break;
}
}
return al;
};
s.setScriptBreakPoint=function(u,script_id_or_name,
ad,ae,aj,
opt_groupId,opt_position_alignment){
var al=
new ScriptBreakPoint(u,script_id_or_name,ad,ae,
opt_groupId,opt_position_alignment);
al.number_=w++;
al.setCondition(aj);
y.push(al);
var Y=this.scripts();
for(var L=0;L<Y.length;L++){
if(al.matchesScript(Y[L])){
al.set(Y[L]);
}
}
return al.number();
};
s.setScriptBreakPointById=function(script_id,
ad,ae,
aj,opt_groupId,
opt_position_alignment){
return this.setScriptBreakPoint(s.ScriptBreakPointType.ScriptId,
script_id,ad,ae,
aj,opt_groupId,
opt_position_alignment);
};
s.setScriptBreakPointByName=function(script_name,
ad,ae,
aj,opt_groupId){
return this.setScriptBreakPoint(s.ScriptBreakPointType.ScriptName,
script_name,ad,ae,
aj,opt_groupId);
};
s.setScriptBreakPointByRegExp=function(script_regexp,
ad,ae,
aj,opt_groupId){
return this.setScriptBreakPoint(s.ScriptBreakPointType.ScriptRegExp,
script_regexp,ad,ae,
aj,opt_groupId);
};
s.enableScriptBreakPoint=function(ah){
var al=this.findScriptBreakPoint(ah,false);
al.enable();
};
s.disableScriptBreakPoint=function(ah){
var al=this.findScriptBreakPoint(ah,false);
al.disable();
};
s.changeScriptBreakPointCondition=function(
ah,E){
var al=this.findScriptBreakPoint(ah,false);
al.setCondition(E);
};
s.scriptBreakPoints=function(){
return y;
};
s.clearStepping=function(){
%ClearStepping();
};
s.setBreakOnException=function(){
return %ChangeBreakOnException(s.ExceptionBreak.Caught,true);
};
s.clearBreakOnException=function(){
return %ChangeBreakOnException(s.ExceptionBreak.Caught,false);
};
s.isBreakOnException=function(){
return!!%IsBreakOnException(s.ExceptionBreak.Caught);
};
s.setBreakOnUncaughtException=function(){
return %ChangeBreakOnException(s.ExceptionBreak.Uncaught,true);
};
s.clearBreakOnUncaughtException=function(){
return %ChangeBreakOnException(s.ExceptionBreak.Uncaught,false);
};
s.isBreakOnUncaughtException=function(){
return!!%IsBreakOnException(s.ExceptionBreak.Uncaught);
};
s.showBreakPoints=function(ab,am,an){
if(!(%IsFunction(ab)))throw %make_error(33);
var ao=am?this.scriptSource(ab):this.source(ab);
var ap=am?0:this.sourcePosition(ab);
var ak=(an===(void 0))
?s.BreakPositionAlignment.Statement:an;
var K=%GetBreakLocations(ab,ak);
if(!K)return ao;
K.sort(function(aq,ar){return aq-ar;});
var U="";
var as=0;
var at;
for(var L=0;L<K.length;L++){
at=K[L]-ap;
U+=ao.slice(as,at);
U+="[B"+L+"]";
as=at;
}
at=ao.length;
U+=ao.substring(as,at);
return U;
};
s.scripts=function(){
return %DebugGetLoadedScripts();
};
function scriptById(au){
var Y=s.scripts();
for(var O of Y){
if(O.id==au)return O;
}
return(void 0);
};
s.debuggerFlags=function(){
return z;
};
s.getWasmFunctionOffsetTable=function(au){
var O=scriptById(au);
return O?%GetWasmFunctionOffsetTable(O):(void 0);
}
s.disassembleWasmFunction=function(au){
var O=scriptById(au);
return O?%DisassembleWasmFunction(O):(void 0);
}
s.MakeMirror=j;
function MakeExecutionState(H){
return new ExecutionState(H);
}
function ExecutionState(H){
this.break_id=H;
this.selected_frame=0;
}
ExecutionState.prototype.prepareStep=function(av){
if(av===s.StepAction.StepIn||
av===s.StepAction.StepOut||
av===s.StepAction.StepNext||
av===s.StepAction.StepFrame){
return %PrepareStep(this.break_id,av);
}
throw %make_type_error(33);
};
ExecutionState.prototype.evaluateGlobal=function(ao,disable_break,
opt_additional_context){
return j(%DebugEvaluateGlobal(this.break_id,ao,
(!!(disable_break)),
opt_additional_context));
};
ExecutionState.prototype.frameCount=function(){
return %GetFrameCount(this.break_id);
};
ExecutionState.prototype.frame=function(aw){
if(aw==null)aw=this.selected_frame;
if(aw<0||aw>=this.frameCount()){
throw %make_type_error(32);
}
return new c(this.break_id,aw);
};
ExecutionState.prototype.setSelectedFrame=function(ax){
var L=(%_ToNumber(ax));
if(L<0||L>=this.frameCount()){
throw %make_type_error(32);
}
this.selected_frame=L;
};
ExecutionState.prototype.selectedFrame=function(){
return this.selected_frame;
};
ExecutionState.prototype.debugCommandProcessor=function(ay){
return new DebugCommandProcessor(this,ay);
};
function MakeBreakEvent(H,az){
return new BreakEvent(H,az);
}
function BreakEvent(H,az){
this.frame_=new c(H,0);
this.break_points_hit_=az;
}
BreakEvent.prototype.eventType=function(){
return s.DebugEvent.Break;
};
BreakEvent.prototype.func=function(){
return this.frame_.func();
};
BreakEvent.prototype.sourceLine=function(){
return this.frame_.sourceLine();
};
BreakEvent.prototype.sourceColumn=function(){
return this.frame_.sourceColumn();
};
BreakEvent.prototype.sourceLineText=function(){
return this.frame_.sourceLineText();
};
BreakEvent.prototype.breakPointsHit=function(){
return this.break_points_hit_;
};
BreakEvent.prototype.toJSONProtocol=function(){
var aA={seq:v++,
type:"event",
event:"break",
body:{invocationText:this.frame_.invocationText()}
};
var O=this.func().script();
if(O){
aA.body.sourceLine=this.sourceLine(),
aA.body.sourceColumn=this.sourceColumn(),
aA.body.sourceLineText=this.sourceLineText(),
aA.body.script=MakeScriptObject_(O,false);
}
if(this.breakPointsHit()){
aA.body.breakpoints=[];
for(var L=0;L<this.breakPointsHit().length;L++){
var aB=this.breakPointsHit()[L];
var al=aB.script_break_point();
var aC;
if(al){
aC=al.number();
}else{
aC=aB.number();
}
aA.body.breakpoints.push(aC);
}
}
return h(ObjectToProtocolObject_(aA));
};
function MakeExceptionEvent(H,aD,aE,aF){
return new ExceptionEvent(H,aD,aE,aF);
}
function ExceptionEvent(H,aD,aE,aF){
this.exec_state_=new ExecutionState(H);
this.exception_=aD;
this.uncaught_=aE;
this.promise_=aF;
}
ExceptionEvent.prototype.eventType=function(){
return s.DebugEvent.Exception;
};
ExceptionEvent.prototype.exception=function(){
return this.exception_;
};
ExceptionEvent.prototype.uncaught=function(){
return this.uncaught_;
};
ExceptionEvent.prototype.promise=function(){
return this.promise_;
};
ExceptionEvent.prototype.func=function(){
return this.exec_state_.frame(0).func();
};
ExceptionEvent.prototype.sourceLine=function(){
return this.exec_state_.frame(0).sourceLine();
};
ExceptionEvent.prototype.sourceColumn=function(){
return this.exec_state_.frame(0).sourceColumn();
};
ExceptionEvent.prototype.sourceLineText=function(){
return this.exec_state_.frame(0).sourceLineText();
};
ExceptionEvent.prototype.toJSONProtocol=function(){
var aA=new ProtocolMessage();
aA.event="exception";
aA.body={uncaught:this.uncaught_,
exception:j(this.exception_)
};
if(this.exec_state_.frameCount()>0){
aA.body.sourceLine=this.sourceLine();
aA.body.sourceColumn=this.sourceColumn();
aA.body.sourceLineText=this.sourceLineText();
var O=this.func().script();
if(O){
aA.body.script=MakeScriptObject_(O,false);
}
}else{
aA.body.sourceLine=-1;
}
return aA.toJSONProtocol();
};
function MakeCompileEvent(O,u){
return new CompileEvent(O,u);
}
function CompileEvent(O,u){
this.script_=j(O);
this.type_=u;
}
CompileEvent.prototype.eventType=function(){
return this.type_;
};
CompileEvent.prototype.script=function(){
return this.script_;
};
CompileEvent.prototype.toJSONProtocol=function(){
var aA=new ProtocolMessage();
aA.running=true;
switch(this.type_){
case s.DebugEvent.BeforeCompile:
aA.event="beforeCompile";
break;
case s.DebugEvent.AfterCompile:
aA.event="afterCompile";
break;
case s.DebugEvent.CompileError:
aA.event="compileError";
break;
}
aA.body={};
aA.body.script=this.script_;
return aA.toJSONProtocol();
};
function MakeScriptObject_(O,aG){
var aA={id:O.id(),
name:O.name(),
lineOffset:O.lineOffset(),
columnOffset:O.columnOffset(),
lineCount:O.lineCount(),
};
if(!(O.data()===(void 0))){
aA.data=O.data();
}
if(aG){
aA.source=O.source();
}
return aA;
}
function MakeAsyncTaskEvent(aH){
return new AsyncTaskEvent(aH);
}
function AsyncTaskEvent(aH){
this.type_=aH.type;
this.name_=aH.name;
this.id_=aH.id;
}
AsyncTaskEvent.prototype.type=function(){
return this.type_;
}
AsyncTaskEvent.prototype.name=function(){
return this.name_;
}
AsyncTaskEvent.prototype.id=function(){
return this.id_;
}
function DebugCommandProcessor(F,ay){
this.exec_state_=F;
this.running_=ay||false;
}
DebugCommandProcessor.prototype.processDebugRequest=function(aI){
return this.processDebugJSONRequest(aI);
};
function ProtocolMessage(aI){
this.seq=v++;
if(aI){
this.type='response';
this.request_seq=aI.seq;
this.command=aI.command;
}else{
this.type='event';
}
this.success=true;
this.running=(void 0);
}
ProtocolMessage.prototype.setOption=function(aJ,A){
if(!this.options_){
this.options_={};
}
this.options_[aJ]=A;
};
ProtocolMessage.prototype.failed=function(aK,aL){
this.success=false;
this.message=aK;
if((typeof(aL)==='object')){
this.error_details=aL;
}
};
ProtocolMessage.prototype.toJSONProtocol=function(){
var aM={};
aM.seq=this.seq;
if(this.request_seq){
aM.request_seq=this.request_seq;
}
aM.type=this.type;
if(this.event){
aM.event=this.event;
}
if(this.command){
aM.command=this.command;
}
if(this.success){
aM.success=this.success;
}else{
aM.success=false;
}
if(this.body){
var aN;
var aO=k(true,this.options_);
if(this.body instanceof m){
aN=aO.serializeValue(this.body);
}else if(this.body instanceof d){
aN=[];
for(var L=0;L<this.body.length;L++){
if(this.body[L]instanceof m){
aN.push(aO.serializeValue(this.body[L]));
}else{
aN.push(ObjectToProtocolObject_(this.body[L],aO));
}
}
}else{
aN=ObjectToProtocolObject_(this.body,aO);
}
aM.body=aN;
aM.refs=aO.serializeReferencedObjects();
}
if(this.message){
aM.message=this.message;
}
if(this.error_details){
aM.error_details=this.error_details;
}
aM.running=this.running;
return h(aM);
};
DebugCommandProcessor.prototype.createResponse=function(aI){
return new ProtocolMessage(aI);
};
DebugCommandProcessor.prototype.processDebugJSONRequest=function(
json_request){
var aI;
var aP;
try{
try{
aI=g(json_request);
aP=this.createResponse(aI);
if(!aI.type){
throw %make_error(2,'Type not specified');
}
if(aI.type!='request'){
throw %make_error(2,
"Illegal type '"+aI.type+"' in request");
}
if(!aI.command){
throw %make_error(2,'Command not specified');
}
if(aI.arguments){
var aQ=aI.arguments;
if(aQ.inlineRefs||aQ.compactFormat){
aP.setOption('inlineRefs',true);
}
if(!(aQ.maxStringLength===(void 0))){
aP.setOption('maxStringLength',aQ.maxStringLength);
}
}
var aR=aI.command.toLowerCase();
var aS=DebugCommandProcessor.prototype.dispatch_[aR];
if((%IsFunction(aS))){
%_Call(aS,this,aI,aP);
}else{
throw %make_error(2,
'Unknown command "'+aI.command+'" in request');
}
}catch(e){
if(!aP){
aP=this.createResponse();
}
aP.success=false;
aP.message=(%_ToString(e));
}
try{
if(!(aP.running===(void 0))){
this.running_=aP.running;
}
aP.running=this.running_;
return aP.toJSONProtocol();
}catch(e){
return'{"seq":'+aP.seq+','+
'"request_seq":'+aI.seq+','+
'"type":"response",'+
'"success":false,'+
'"message":"Internal error: '+(%_ToString(e))+'"}';
}
}catch(e){
return'{"seq":0,"type":"response","success":false,"message":"Internal error"}';
}
};
DebugCommandProcessor.prototype.continueRequest_=function(aI,aP){
if(aI.arguments){
var av=s.StepAction.StepIn;
var aT=aI.arguments.stepaction;
if(aT){
if(aT=='in'){
av=s.StepAction.StepIn;
}else if(aT=='next'){
av=s.StepAction.StepNext;
}else if(aT=='out'){
av=s.StepAction.StepOut;
}else{
throw %make_error(2,
'Invalid stepaction argument "'+aT+'".');
}
}
this.exec_state_.prepareStep(av);
}
aP.running=true;
};
DebugCommandProcessor.prototype.breakRequest_=function(aI,aP){
};
DebugCommandProcessor.prototype.setBreakPointRequest_=
function(aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var u=aI.arguments.type;
var aU=aI.arguments.target;
var M=aI.arguments.line;
var N=aI.arguments.column;
var aV=(aI.arguments.enabled===(void 0))?
true:aI.arguments.enabled;
var E=aI.arguments.condition;
var aW=aI.arguments.groupId;
if(!u||(aU===(void 0))){
aP.failed('Missing argument "type" or "target"');
return;
}
var ah;
if(u=='function'){
if(!(typeof(aU)==='string')){
aP.failed('Argument "target" is not a string value');
return;
}
var ab;
try{
ab=this.exec_state_.evaluateGlobal(aU).value();
}catch(e){
aP.failed('Error: "'+(%_ToString(e))+
'" evaluating "'+aU+'"');
return;
}
if(!(%IsFunction(ab))){
aP.failed('"'+aU+'" does not evaluate to a function');
return;
}
ah=s.setBreakPoint(ab,M,N,E);
}else if(u=='handle'){
var aX=o(aU,10);
var G=i(aX);
if(!G){
return aP.failed('Object #'+aX+'# not found');
}
if(!G.isFunction()){
return aP.failed('Object #'+aX+'# is not a function');
}
ah=s.setBreakPoint(G.value(),
M,N,E);
}else if(u=='script'){
ah=
s.setScriptBreakPointByName(aU,M,N,E,
aW);
}else if(u=='scriptId'){
ah=
s.setScriptBreakPointById(aU,M,N,E,aW);
}else if(u=='scriptRegExp'){
ah=
s.setScriptBreakPointByRegExp(aU,M,N,E,
aW);
}else{
aP.failed('Illegal type "'+u+'"');
return;
}
var D=s.findBreakPoint(ah);
if(!aV){
s.disableBreakPoint(ah);
}
aP.body={type:u,
breakpoint:ah};
if(D instanceof ScriptBreakPoint){
if(D.type()==s.ScriptBreakPointType.ScriptId){
aP.body.type='scriptId';
aP.body.script_id=D.script_id();
}else if(D.type()==s.ScriptBreakPointType.ScriptName){
aP.body.type='scriptName';
aP.body.script_name=D.script_name();
}else if(D.type()==s.ScriptBreakPointType.ScriptRegExp){
aP.body.type='scriptRegExp';
aP.body.script_regexp=D.script_regexp_object().source;
}else{
throw %make_error(2,
"Unexpected breakpoint type: "+D.type());
}
aP.body.line=D.line();
aP.body.column=D.column();
aP.body.actual_locations=D.actual_locations();
}else{
aP.body.type='function';
aP.body.actual_locations=[D.actual_location];
}
};
DebugCommandProcessor.prototype.changeBreakPointRequest_=function(
aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var D=(%_ToNumber(aI.arguments.breakpoint));
var aV=aI.arguments.enabled;
var E=aI.arguments.condition;
if(!D){
aP.failed('Missing argument "breakpoint"');
return;
}
if(!(aV===(void 0))){
if(aV){
s.enableBreakPoint(D);
}else{
s.disableBreakPoint(D);
}
}
if(!(E===(void 0))){
s.changeBreakPointCondition(D,E);
}
};
DebugCommandProcessor.prototype.clearBreakPointGroupRequest_=function(
aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var aY=aI.arguments.groupId;
if(!aY){
aP.failed('Missing argument "groupId"');
return;
}
var aZ=[];
var ba=[];
for(var L=0;L<y.length;L++){
var bb=y[L];
if(bb.groupId()==aY){
aZ.push(bb.number());
bb.clear();
}else{
ba.push(bb);
}
}
y=ba;
aP.body={breakpoints:aZ};
};
DebugCommandProcessor.prototype.clearBreakPointRequest_=function(
aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var D=(%_ToNumber(aI.arguments.breakpoint));
if(!D){
aP.failed('Missing argument "breakpoint"');
return;
}
s.clearBreakPoint(D);
aP.body={breakpoint:D};
};
DebugCommandProcessor.prototype.listBreakpointsRequest_=function(
aI,aP){
var bc=[];
for(var L=0;L<y.length;L++){
var D=y[L];
var bd={
number:D.number(),
line:D.line(),
column:D.column(),
groupId:D.groupId(),
active:D.active(),
condition:D.condition(),
actual_locations:D.actual_locations()
};
if(D.type()==s.ScriptBreakPointType.ScriptId){
bd.type='scriptId';
bd.script_id=D.script_id();
}else if(D.type()==s.ScriptBreakPointType.ScriptName){
bd.type='scriptName';
bd.script_name=D.script_name();
}else if(D.type()==s.ScriptBreakPointType.ScriptRegExp){
bd.type='scriptRegExp';
bd.script_regexp=D.script_regexp_object().source;
}else{
throw %make_error(2,
"Unexpected breakpoint type: "+D.type());
}
bc.push(bd);
}
aP.body={
breakpoints:bc,
breakOnExceptions:s.isBreakOnException(),
breakOnUncaughtExceptions:s.isBreakOnUncaughtException()
};
};
DebugCommandProcessor.prototype.disconnectRequest_=
function(aI,aP){
s.disableAllBreakPoints();
this.continueRequest_(aI,aP);
};
DebugCommandProcessor.prototype.setExceptionBreakRequest_=
function(aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var u=aI.arguments.type;
if(!u){
aP.failed('Missing argument "type"');
return;
}
var aV;
if(u=='all'){
aV=!s.isBreakOnException();
}else if(u=='uncaught'){
aV=!s.isBreakOnUncaughtException();
}
if(!(aI.arguments.enabled===(void 0))){
aV=aI.arguments.enabled;
if((aV!=true)&&(aV!=false)){
aP.failed('Illegal value for "enabled":"'+aV+'"');
}
}
if(u=='all'){
%ChangeBreakOnException(s.ExceptionBreak.Caught,aV);
}else if(u=='uncaught'){
%ChangeBreakOnException(s.ExceptionBreak.Uncaught,aV);
}else{
aP.failed('Unknown "type":"'+u+'"');
}
aP.body={'type':u,'enabled':aV};
};
DebugCommandProcessor.prototype.backtraceRequest_=function(
aI,aP){
var be=this.exec_state_.frameCount();
if(be==0){
aP.body={
totalFrames:be
};
return;
}
var bf=0;
var bg=r;
if(aI.arguments){
if(aI.arguments.fromFrame){
bf=aI.arguments.fromFrame;
}
if(aI.arguments.toFrame){
bg=aI.arguments.toFrame;
}
if(aI.arguments.bottom){
var bh=be-bf;
bf=be-bg;
bg=bh;
}
if(bf<0||bg<0){
return aP.failed('Invalid frame number');
}
}
bg=l(be,bg);
if(bg<=bf){
var bi='Invalid frame range';
return aP.failed(bi);
}
var bj=[];
for(var L=bf;L<bg;L++){
bj.push(this.exec_state_.frame(L));
}
aP.body={
fromFrame:bf,
toFrame:bg,
totalFrames:be,
frames:bj
};
};
DebugCommandProcessor.prototype.frameRequest_=function(aI,aP){
if(this.exec_state_.frameCount()==0){
return aP.failed('No frames');
}
if(aI.arguments){
var ax=aI.arguments.number;
if(ax<0||this.exec_state_.frameCount()<=ax){
return aP.failed('Invalid frame number');
}
this.exec_state_.setSelectedFrame(aI.arguments.number);
}
aP.body=this.exec_state_.frame();
};
DebugCommandProcessor.prototype.resolveFrameFromScopeDescription_=
function(bk){
if(bk&&!(bk.frameNumber===(void 0))){
var bl=bk.frameNumber;
if(bl<0||this.exec_state_.frameCount()<=bl){
throw %make_type_error(32);
}
return this.exec_state_.frame(bl);
}else{
return this.exec_state_.frame();
}
};
DebugCommandProcessor.prototype.resolveScopeHolder_=
function(bk){
if(bk&&"functionHandle"in bk){
if(!(typeof(bk.functionHandle)==='number')){
throw %make_error(2,'Function handle must be a number');
}
var bm=i(bk.functionHandle);
if(!bm){
throw %make_error(2,'Failed to find function object by handle');
}
if(!bm.isFunction()){
throw %make_error(2,
'Value of non-function type is found by handle');
}
return bm;
}else{
if(this.exec_state_.frameCount()==0){
throw %make_error(2,'No scopes');
}
var bn=this.resolveFrameFromScopeDescription_(bk);
return bn;
}
}
DebugCommandProcessor.prototype.scopesRequest_=function(aI,aP){
var bo=this.resolveScopeHolder_(aI.arguments);
var bp=bo.scopeCount();
var bq=[];
for(var L=0;L<bp;L++){
bq.push(bo.scope(L));
}
aP.body={
fromScope:0,
toScope:bp,
totalScopes:bp,
scopes:bq
};
};
DebugCommandProcessor.prototype.scopeRequest_=function(aI,aP){
var bo=this.resolveScopeHolder_(aI.arguments);
var br=0;
if(aI.arguments&&!(aI.arguments.number===(void 0))){
br=(%_ToNumber(aI.arguments.number));
if(br<0||bo.scopeCount()<=br){
return aP.failed('Invalid scope number');
}
}
aP.body=bo.scope(br);
};
DebugCommandProcessor.resolveValue_=function(bs){
if("handle"in bs){
var bt=i(bs.handle);
if(!bt){
throw %make_error(2,"Failed to resolve value by handle, ' #"+
bs.handle+"# not found");
}
return bt.value();
}else if("stringDescription"in bs){
if(bs.type==n.BOOLEAN_TYPE){
return(!!(bs.stringDescription));
}else if(bs.type==n.NUMBER_TYPE){
return(%_ToNumber(bs.stringDescription));
}if(bs.type==n.STRING_TYPE){
return(%_ToString(bs.stringDescription));
}else{
throw %make_error(2,"Unknown type");
}
}else if("value"in bs){
return bs.value;
}else if(bs.type==n.UNDEFINED_TYPE){
return(void 0);
}else if(bs.type==n.NULL_TYPE){
return null;
}else{
throw %make_error(2,"Failed to parse value description");
}
};
DebugCommandProcessor.prototype.setVariableValueRequest_=
function(aI,aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
if((aI.arguments.name===(void 0))){
aP.failed('Missing variable name');
}
var bu=aI.arguments.name;
var bk=aI.arguments.scope;
var bo=this.resolveScopeHolder_(bk);
if((bk.number===(void 0))){
aP.failed('Missing scope number');
}
var br=(%_ToNumber(bk.number));
var bv=bo.scope(br);
var bw=
DebugCommandProcessor.resolveValue_(aI.arguments.newValue);
bv.setVariableValue(bu,bw);
var bx=j(bw);
aP.body={
newValue:bx
};
};
DebugCommandProcessor.prototype.evaluateRequest_=function(aI,aP){
if(!aI.arguments){
return aP.failed('Missing arguments');
}
var by=aI.arguments.expression;
var bn=aI.arguments.frame;
var a=aI.arguments.global;
var bz=aI.arguments.disable_break;
var bA=aI.arguments.additional_context;
try{
by=(%_ToString(by));
}catch(e){
return aP.failed('Failed to convert expression argument to string');
}
if(!(bn===(void 0))&&a){
return aP.failed('Arguments "frame" and "global" are exclusive');
}
var bB;
if(bA){
bB={};
for(var L=0;L<bA.length;L++){
var bC=bA[L];
if(!(typeof(bC.name)==='string')){
return aP.failed("Context element #"+L+
" doesn't contain name:string property");
}
var bD=DebugCommandProcessor.resolveValue_(bC);
bB[bC.name]=bD;
}
}
if(a){
aP.body=this.exec_state_.evaluateGlobal(
by,(!!(bz)),bB);
return;
}
if((bz===(void 0))){
bz=true;
}
if(this.exec_state_.frameCount()==0){
return aP.failed('No frames');
}
if(!(bn===(void 0))){
var bE=(%_ToNumber(bn));
if(bE<0||bE>=this.exec_state_.frameCount()){
return aP.failed('Invalid frame "'+bn+'"');
}
aP.body=this.exec_state_.frame(bE).evaluate(
by,(!!(bz)),bB);
return;
}else{
aP.body=this.exec_state_.frame().evaluate(
by,(!!(bz)),bB);
return;
}
};
DebugCommandProcessor.prototype.lookupRequest_=function(aI,aP){
if(!aI.arguments){
return aP.failed('Missing arguments');
}
var bF=aI.arguments.handles;
if((bF===(void 0))){
return aP.failed('Argument "handles" missing');
}
if(!(aI.arguments.includeSource===(void 0))){
var bG=(!!(aI.arguments.includeSource));
aP.setOption('includeSource',bG);
}
var bH={};
for(var L=0;L<bF.length;L++){
var aX=bF[L];
var G=i(aX);
if(!G){
return aP.failed('Object #'+aX+'# not found');
}
bH[aX]=G;
}
aP.body=bH;
};
DebugCommandProcessor.prototype.referencesRequest_=
function(aI,aP){
if(!aI.arguments){
return aP.failed('Missing arguments');
}
var u=aI.arguments.type;
var aX=aI.arguments.handle;
if((u===(void 0))){
return aP.failed('Argument "type" missing');
}
if((aX===(void 0))){
return aP.failed('Argument "handle" missing');
}
if(u!='referencedBy'&&u!='constructedBy'){
return aP.failed('Invalid type "'+u+'"');
}
var G=i(aX);
if(G){
if(u=='referencedBy'){
aP.body=G.referencedBy();
}else{
aP.body=G.constructedBy();
}
}else{
return aP.failed('Object #'+aX+'# not found');
}
};
DebugCommandProcessor.prototype.sourceRequest_=function(aI,aP){
if(this.exec_state_.frameCount()==0){
return aP.failed('No source');
}
var bI;
var bJ;
var bn=this.exec_state_.frame();
if(aI.arguments){
bI=aI.arguments.fromLine;
bJ=aI.arguments.toLine;
if(!(aI.arguments.frame===(void 0))){
var bE=(%_ToNumber(aI.arguments.frame));
if(bE<0||bE>=this.exec_state_.frameCount()){
return aP.failed('Invalid frame "'+bn+'"');
}
bn=this.exec_state_.frame(bE);
}
}
var O=bn.func().script();
if(!O){
return aP.failed('No source');
}
var bK=O.value();
var bL=bK.line_offset;
var bM=%ScriptLineCount(bK);
bI=(bI===(void 0))?0:bI-bL;
bJ=(bJ===(void 0))?bM:bJ-bL;
if(bI<0)bI=0;
if(bJ>bM)bJ=bM;
if(bI>=bM||bJ<0||bI>bJ){
return aP.failed('Invalid line interval');
}
aP.body={};
aP.body.fromLine=bI+bL;
aP.body.toLine=bJ+bL;
aP.body.fromPosition=%ScriptLineStartPosition(bK,bI);
aP.body.toPosition=
(bJ==0)?0:%ScriptLineEndPosition(bK,bJ-1);
aP.body.totalLines=%ScriptLineCount(bK);
aP.body.source=%_SubString(bK.source,
aP.body.fromPosition,
aP.body.toPosition);
};
DebugCommandProcessor.prototype.scriptsRequest_=function(aI,aP){
var bN=ScriptTypeFlag(s.ScriptType.Normal);
var bG=false;
var bO=null;
if(aI.arguments){
if(!(aI.arguments.types===(void 0))){
bN=(%_ToNumber(aI.arguments.types));
if(f(bN)||bN<0){
return aP.failed('Invalid types "'+
aI.arguments.types+'"');
}
}
if(!(aI.arguments.includeSource===(void 0))){
bG=(!!(aI.arguments.includeSource));
aP.setOption('includeSource',bG);
}
if((%_IsArray(aI.arguments.ids))){
bO={};
var bP=aI.arguments.ids;
for(var L=0;L<bP.length;L++){
bO[bP[L]]=true;
}
}
var bQ=null;
var bR=null;
if(!(aI.arguments.filter===(void 0))){
var bS=(%_ToNumber(aI.arguments.filter));
if(!f(bS)){
bR=bS;
}
bQ=aI.arguments.filter;
}
}
var Y=s.scripts();
aP.body=[];
for(var L=0;L<Y.length;L++){
if(bO&&!bO[Y[L].id]){
continue;
}
if(bQ||bR){
var O=Y[L];
var bT=false;
if(bR&&!bT){
if(O.id&&O.id===bR){
bT=true;
}
}
if(bQ&&!bT){
if(O.name&&O.name.indexOf(bQ)>=0){
bT=true;
}
}
if(!bT)continue;
}
if(bN&ScriptTypeFlag(Y[L].type)){
aP.body.push(j(Y[L]));
}
}
};
DebugCommandProcessor.prototype.suspendRequest_=function(aI,aP){
aP.running=false;
};
DebugCommandProcessor.prototype.versionRequest_=function(aI,aP){
aP.body={
V8Version:%GetV8Version()
};
};
DebugCommandProcessor.prototype.changeLiveRequest_=function(
aI,aP){
if(!aI.arguments){
return aP.failed('Missing arguments');
}
var bU=aI.arguments.script_id;
var bV=!!aI.arguments.preview_only;
var bW=scriptById(bU);
if(!bW){
aP.failed('Script not found');
return;
}
var bX=new d();
if(!(typeof(aI.arguments.new_source)==='string')){
throw"new_source argument expected";
}
var bY=aI.arguments.new_source;
var bZ;
try{
bZ=s.LiveEdit.SetScriptSource(bW,
bY,bV,bX);
}catch(e){
if(e instanceof s.LiveEdit.Failure&&"details"in e){
aP.failed(e.message,e.details);
return;
}
throw e;
}
aP.body={change_log:bX,result:bZ};
if(!bV&&!this.running_&&bZ.stack_modified){
aP.body.stepin_recommended=true;
}
};
DebugCommandProcessor.prototype.restartFrameRequest_=function(
aI,aP){
if(!aI.arguments){
return aP.failed('Missing arguments');
}
var bn=aI.arguments.frame;
if(this.exec_state_.frameCount()==0){
return aP.failed('No frames');
}
var ca;
if(!(bn===(void 0))){
var bE=(%_ToNumber(bn));
if(bE<0||bE>=this.exec_state_.frameCount()){
return aP.failed('Invalid frame "'+bn+'"');
}
ca=this.exec_state_.frame(bE);
}else{
ca=this.exec_state_.frame();
}
var bZ=ca.restart();
aP.body={result:bZ};
};
DebugCommandProcessor.prototype.debuggerFlagsRequest_=function(aI,
aP){
if(!aI.arguments){
aP.failed('Missing arguments');
return;
}
var cb=aI.arguments.flags;
aP.body={flags:[]};
if(!(cb===(void 0))){
for(var L=0;L<cb.length;L++){
var aJ=cb[L].name;
var cc=z[aJ];
if(!cc){
continue;
}
if('value'in cb[L]){
cc.setValue(cb[L].value);
}
aP.body.flags.push({name:aJ,value:cc.getValue()});
}
}else{
for(var aJ in z){
var A=z[aJ].getValue();
aP.body.flags.push({name:aJ,value:A});
}
}
};
DebugCommandProcessor.prototype.v8FlagsRequest_=function(aI,aP){
var cb=aI.arguments.flags;
if(!cb)cb='';
%SetFlags(cb);
};
DebugCommandProcessor.prototype.gcRequest_=function(aI,aP){
var u=aI.arguments.type;
if(!u)u='all';
var cd=%GetHeapUsage();
%CollectGarbage(u);
var ce=%GetHeapUsage();
aP.body={"before":cd,"after":ce};
};
DebugCommandProcessor.prototype.dispatch_=(function(){
var cf=DebugCommandProcessor.prototype;
return{
"continue":cf.continueRequest_,
"break":cf.breakRequest_,
"setbreakpoint":cf.setBreakPointRequest_,
"changebreakpoint":cf.changeBreakPointRequest_,
"clearbreakpoint":cf.clearBreakPointRequest_,
"clearbreakpointgroup":cf.clearBreakPointGroupRequest_,
"disconnect":cf.disconnectRequest_,
"setexceptionbreak":cf.setExceptionBreakRequest_,
"listbreakpoints":cf.listBreakpointsRequest_,
"backtrace":cf.backtraceRequest_,
"frame":cf.frameRequest_,
"scopes":cf.scopesRequest_,
"scope":cf.scopeRequest_,
"setvariablevalue":cf.setVariableValueRequest_,
"evaluate":cf.evaluateRequest_,
"lookup":cf.lookupRequest_,
"references":cf.referencesRequest_,
"source":cf.sourceRequest_,
"scripts":cf.scriptsRequest_,
"suspend":cf.suspendRequest_,
"version":cf.versionRequest_,
"changelive":cf.changeLiveRequest_,
"restartframe":cf.restartFrameRequest_,
"flags":cf.debuggerFlagsRequest_,
"v8flag":cf.v8FlagsRequest_,
"gc":cf.gcRequest_,
};
})();
DebugCommandProcessor.prototype.isRunning=function(){
return this.running_;
};
DebugCommandProcessor.prototype.systemBreak=function(cg,aQ){
return %SystemBreak();
};
function ObjectToProtocolObject_(ch,ci){
var cj={};
for(var aR in ch){
if(typeof aR=='string'){
var ck=ValueToProtocolValue_(ch[aR],
ci);
if(!(ck===(void 0))){
cj[aR]=ck;
}
}
}
return cj;
}
function ArrayToProtocolArray_(bc,ci){
var aM=[];
for(var L=0;L<bc.length;L++){
aM.push(ValueToProtocolValue_(bc[L],ci));
}
return aM;
}
function ValueToProtocolValue_(A,ci){
var aM;
switch(typeof A){
case'object':
if(A instanceof m){
aM=ci.serializeValue(A);
}else if((%_IsArray(A))){
aM=ArrayToProtocolArray_(A,ci);
}else{
aM=ObjectToProtocolObject_(A,ci);
}
break;
case'boolean':
case'string':
case'number':
aM=A;
break;
default:
aM=null;
}
return aM;
}
b.InstallConstants(a,[
"Debug",s,
"DebugCommandProcessor",DebugCommandProcessor,
"BreakEvent",BreakEvent,
"CompileEvent",CompileEvent,
"BreakPoint",BreakPoint,
]);
b.InstallFunctions(b,2,[
"MakeExecutionState",MakeExecutionState,
"MakeExceptionEvent",MakeExceptionEvent,
"MakeBreakEvent",MakeBreakEvent,
"MakeCompileEvent",MakeCompileEvent,
"MakeAsyncTaskEvent",MakeAsyncTaskEvent,
"IsBreakPointTriggered",IsBreakPointTriggered,
"UpdateScriptBreakPoints",UpdateScriptBreakPoints,
]);
b.Export(function(cl){
cl.GetScriptBreakPoints=GetScriptBreakPoints;
});
})

 liveediti˜
(function(a,b){
"use strict";
var c=a.Debug.findScriptSourcePosition;
var d;
var e=a.Array;
var f=a.Math.floor;
var g=a.SyntaxError;
b.Import(function(h){
d=h.GetScriptBreakPoints;
});
var i;
function ApplyPatchMultiChunk(script,diff_array,new_source,preview_only,
change_log){
var j=script.source;
var k=GatherCompileInfo(j,script);
var l=BuildCodeInfoTree(k);
var m=new PosTranslator(diff_array);
MarkChangedFunctions(l,m.GetChunks());
FindLiveSharedInfos(l,script);
var n;
try{
n=GatherCompileInfo(new_source,script);
}catch(e){
var o=
new Failure("Failed to compile new version of script: "+e);
if(e instanceof g){
var p={
type:"liveedit_compile_error",
syntaxErrorMessage:e.message
};
CopyErrorPositionToDetails(e,p);
o.details=p;
}
throw o;
}
var q=BuildCodeInfoTree(n);
FindCorrespondingFunctions(l,q);
var r=new e();
var s=new e();
var t=new e();
var u=new e();
function HarvestTodo(v){
function CollectDamaged(w){
s.push(w);
for(var x=0;x<w.children.length;x++){
CollectDamaged(w.children[x]);
}
}
function CollectNew(y){
for(var x=0;x<y.length;x++){
t.push(y[x]);
CollectNew(y[x].children);
}
}
if(v.status==i.DAMAGED){
CollectDamaged(v);
return;
}
if(v.status==i.UNCHANGED){
u.push(v);
}else if(v.status==i.SOURCE_CHANGED){
u.push(v);
}else if(v.status==i.CHANGED){
r.push(v);
CollectNew(v.unmatched_new_nodes);
}
for(var x=0;x<v.children.length;x++){
HarvestTodo(v.children[x]);
}
}
var z={
change_tree:DescribeChangeTree(l),
textual_diff:{
old_len:j.length,
new_len:new_source.length,
chunks:diff_array
},
updated:false
};
if(preview_only){
return z;
}
HarvestTodo(l);
var A=new e();
var B=new e();
for(var x=0;x<r.length;x++){
var C=r[x].live_shared_function_infos;
var D=
r[x].corresponding_node.info.shared_function_info;
if(C){
for(var E=0;E<C.length;E++){
A.push(C[E]);
B.push(D);
}
}
}
var F=
CheckStackActivations(A,
B,
change_log);
z.stack_modified=F!=0;
var G=TemporaryRemoveBreakPoints(script,change_log);
var H;
if(s.length==0){
%LiveEditReplaceScript(script,new_source,null);
H=(void 0);
}else{
var I=CreateNameForOldScript(script);
H=%LiveEditReplaceScript(script,new_source,
I);
var J=new e();
change_log.push({linked_to_old_script:J});
for(var x=0;x<s.length;x++){
LinkToOldScript(s[x],H,
J);
}
z.created_script_name=I;
}
for(var x=0;x<t.length;x++){
%LiveEditFunctionSetScript(
t[x].info.shared_function_info,script);
}
for(var x=0;x<r.length;x++){
PatchFunctionCode(r[x],change_log);
}
var K=new e();
change_log.push({position_patched:K});
for(var x=0;x<u.length;x++){
PatchPositions(u[x],diff_array,
K);
if(u[x].live_shared_function_infos){
u[x].live_shared_function_infos.
forEach(function(L){
%LiveEditFunctionSourceUpdated(L.raw_array);
});
}
}
G(m,H);
z.updated=true;
return z;
}
function GatherCompileInfo(M,N){
var O=%LiveEditGatherCompileInfo(N,M);
var P=new e();
var Q=new e();
for(var x=0;x<O.length;x++){
var L=new FunctionCompileInfo(O[x]);
%LiveEditFunctionSetScript(L.shared_function_info,(void 0));
P.push(L);
Q.push(x);
}
for(var x=0;x<P.length;x++){
var R=x;
for(var E=x+1;E<P.length;E++){
if(P[R].start_position>P[E].start_position){
R=E;
}
}
if(R!=x){
var S=P[R];
var T=Q[R];
P[R]=P[x];
Q[R]=Q[x];
P[x]=S;
Q[x]=T;
}
}
var U=0;
function ResetIndexes(V,W){
var X=-1;
while(U<P.length&&
P[U].outer_index==W){
var Y=U;
P[Y].outer_index=V;
if(X!=-1){
P[X].next_sibling_index=Y;
}
X=Y;
U++;
ResetIndexes(Y,Q[Y]);
}
if(X!=-1){
P[X].next_sibling_index=-1;
}
}
ResetIndexes(-1,-1);
Assert(U==P.length);
return P;
}
function PatchFunctionCode(v,Z){
var D=v.corresponding_node.info;
if(v.live_shared_function_infos){
v.live_shared_function_infos.forEach(function(aa){
%LiveEditReplaceFunctionCode(D.raw_array,
aa.raw_array);
for(var x=0;x<v.children.length;x++){
if(v.children[x].corresponding_node){
var ab=
v.children[x].corresponding_node.info.
shared_function_info;
if(v.children[x].live_shared_function_infos){
v.children[x].live_shared_function_infos.
forEach(function(ac){
%LiveEditReplaceRefToNestedFunction(
aa.info,
ab,
ac.info);
});
}
}
}
});
Z.push({function_patched:D.function_name});
}else{
Z.push({function_patched:D.function_name,
function_info_not_found:true});
}
}
function LinkToOldScript(ad,H,ae){
if(ad.live_shared_function_infos){
ad.live_shared_function_infos.
forEach(function(L){
%LiveEditFunctionSetScript(L.info,H);
});
ae.push({name:ad.info.function_name});
}else{
ae.push(
{name:ad.info.function_name,not_found:true});
}
}
function TemporaryRemoveBreakPoints(af,Z){
var ag=d(af);
var ah=[];
Z.push({break_points_update:ah});
var ai=[];
for(var x=0;x<ag.length;x++){
var aj=ag[x];
aj.clear();
var ak=c(af,
aj.line(),aj.column());
var al={
position:ak,
line:aj.line(),
column:aj.column()
};
ai.push(al);
}
return function(m,am){
for(var x=0;x<ag.length;x++){
var aj=ag[x];
if(am){
var an=aj.cloneForOtherScript(am);
an.set(am);
ah.push({
type:"copied_to_old",
id:aj.number(),
new_id:an.number(),
positions:ai[x]
});
}
var ao=m.Translate(
ai[x].position,
PosTranslator.ShiftWithTopInsideChunkHandler);
var ap=
af.locationFromPosition(ao,false);
aj.update_positions(ap.line,ap.column);
var aq={
position:ao,
line:ap.line,
column:ap.column
};
aj.set(af);
ah.push({type:"position_changed",
id:aj.number(),
old_positions:ai[x],
new_positions:aq
});
}
};
}
function Assert(ar,as){
if(!ar){
if(as){
throw"Assert "+as;
}else{
throw"Assert";
}
}
}
function DiffChunk(at,au,av,aw){
this.pos1=at;
this.pos2=au;
this.len1=av;
this.len2=aw;
}
function PosTranslator(ax){
var ay=new e();
var az=0;
for(var x=0;x<ax.length;x+=3){
var aA=ax[x];
var aB=aA+az;
var aC=ax[x+1];
var aD=ax[x+2];
ay.push(new DiffChunk(aA,aB,aC-aA,
aD-aB));
az=aD-aC;
}
this.chunks=ay;
}
PosTranslator.prototype.GetChunks=function(){
return this.chunks;
};
PosTranslator.prototype.Translate=function(aE,aF){
var aG=this.chunks;
if(aG.length==0||aE<aG[0].pos1){
return aE;
}
var aH=0;
var aI=aG.length-1;
while(aH<aI){
var aJ=f((aH+aI)/2);
if(aE<aG[aJ+1].pos1){
aI=aJ;
}else{
aH=aJ+1;
}
}
var aK=aG[aH];
if(aE>=aK.pos1+aK.len1){
return aE+aK.pos2+aK.len2-aK.pos1-aK.len1;
}
if(!aF){
aF=PosTranslator.DefaultInsideChunkHandler;
}
return aF(aE,aK);
};
PosTranslator.DefaultInsideChunkHandler=function(aE,aL){
Assert(false,"Cannot translate position in changed area");
};
PosTranslator.ShiftWithTopInsideChunkHandler=
function(aE,aL){
return aE-aL.pos1+aL.pos2;
};
var i={
UNCHANGED:"unchanged",
SOURCE_CHANGED:"source changed",
CHANGED:"changed",
DAMAGED:"damaged"
};
function CodeInfoTreeNode(aM,aN,aO){
this.info=aM;
this.children=aN;
this.array_index=aO;
this.parent=(void 0);
this.status=i.UNCHANGED;
this.status_explanation=(void 0);
this.new_start_pos=(void 0);
this.new_end_pos=(void 0);
this.corresponding_node=(void 0);
this.unmatched_new_nodes=(void 0);
this.textual_corresponding_node=(void 0);
this.textually_unmatched_new_nodes=(void 0);
this.live_shared_function_infos=(void 0);
}
function BuildCodeInfoTree(aP){
var aQ=0;
function BuildNode(){
var aR=aQ;
aQ++;
var aS=new e();
while(aQ<aP.length&&
aP[aQ].outer_index==aR){
aS.push(BuildNode());
}
var w=new CodeInfoTreeNode(aP[aR],aS,
aR);
for(var x=0;x<aS.length;x++){
aS[x].parent=w;
}
return w;
}
var aT=BuildNode();
Assert(aQ==aP.length);
return aT;
}
function MarkChangedFunctions(aU,ay){
var aV=new function(){
var aW=0;
var aX=0;
this.current=function(){return ay[aW];};
this.next=function(){
var aK=ay[aW];
aX=aK.pos2+aK.len2-(aK.pos1+aK.len1);
aW++;
};
this.done=function(){return aW>=ay.length;};
this.TranslatePos=function(aE){return aE+aX;};
};
function ProcessInternals(aY){
aY.new_start_pos=aV.TranslatePos(
aY.info.start_position);
var aZ=0;
var ba=false;
var bb=false;
while(!aV.done()&&
aV.current().pos1<aY.info.end_position){
if(aZ<aY.children.length){
var bc=aY.children[aZ];
if(bc.info.end_position<=aV.current().pos1){
ProcessUnchangedChild(bc);
aZ++;
continue;
}else if(bc.info.start_position>=
aV.current().pos1+aV.current().len1){
ba=true;
aV.next();
continue;
}else if(bc.info.start_position<=aV.current().pos1&&
bc.info.end_position>=aV.current().pos1+
aV.current().len1){
ProcessInternals(bc);
bb=bb||
(bc.status!=i.UNCHANGED);
ba=ba||
(bc.status==i.DAMAGED);
aZ++;
continue;
}else{
ba=true;
bc.status=i.DAMAGED;
bc.status_explanation=
"Text diff overlaps with function boundary";
aZ++;
continue;
}
}else{
if(aV.current().pos1+aV.current().len1<=
aY.info.end_position){
aY.status=i.CHANGED;
aV.next();
continue;
}else{
aY.status=i.DAMAGED;
aY.status_explanation=
"Text diff overlaps with function boundary";
return;
}
}
Assert("Unreachable",false);
}
while(aZ<aY.children.length){
var bc=aY.children[aZ];
ProcessUnchangedChild(bc);
aZ++;
}
if(ba){
aY.status=i.CHANGED;
}else if(bb){
aY.status=i.SOURCE_CHANGED;
}
aY.new_end_pos=
aV.TranslatePos(aY.info.end_position);
}
function ProcessUnchangedChild(w){
w.new_start_pos=aV.TranslatePos(w.info.start_position);
w.new_end_pos=aV.TranslatePos(w.info.end_position);
}
ProcessInternals(aU);
}
function FindCorrespondingFunctions(bd,be){
function ProcessNode(v,bf){
var bg=
IsFunctionContextLocalsChanged(v.info,bf.info);
if(bg){
v.status=i.CHANGED;
}
var bh=v.children;
var bi=bf.children;
var bj=[];
var bk=[];
var bl=0;
var bm=0;
while(bl<bh.length){
if(bh[bl].status==i.DAMAGED){
bl++;
}else if(bm<bi.length){
if(bi[bm].info.start_position<
bh[bl].new_start_pos){
bj.push(bi[bm]);
bk.push(bi[bm]);
bm++;
}else if(bi[bm].info.start_position==
bh[bl].new_start_pos){
if(bi[bm].info.end_position==
bh[bl].new_end_pos){
bh[bl].corresponding_node=
bi[bm];
bh[bl].textual_corresponding_node=
bi[bm];
if(bg){
bh[bl].status=i.DAMAGED;
bh[bl].status_explanation=
"Enclosing function is now incompatible. "+
bg;
bh[bl].corresponding_node=(void 0);
}else if(bh[bl].status!=
i.UNCHANGED){
ProcessNode(bh[bl],
bi[bm]);
if(bh[bl].status==i.DAMAGED){
bj.push(
bh[bl].corresponding_node);
bh[bl].corresponding_node=(void 0);
v.status=i.CHANGED;
}
}
}else{
bh[bl].status=i.DAMAGED;
bh[bl].status_explanation=
"No corresponding function in new script found";
v.status=i.CHANGED;
bj.push(bi[bm]);
bk.push(bi[bm]);
}
bm++;
bl++;
}else{
bh[bl].status=i.DAMAGED;
bh[bl].status_explanation=
"No corresponding function in new script found";
v.status=i.CHANGED;
bl++;
}
}else{
bh[bl].status=i.DAMAGED;
bh[bl].status_explanation=
"No corresponding function in new script found";
v.status=i.CHANGED;
bl++;
}
}
while(bm<bi.length){
bj.push(bi[bm]);
bk.push(bi[bm]);
bm++;
}
if(v.status==i.CHANGED){
if(v.info.param_num!=bf.info.param_num){
v.status=i.DAMAGED;
v.status_explanation="Changed parameter number: "+
v.info.param_num+" and "+bf.info.param_num;
}
}
v.unmatched_new_nodes=bj;
v.textually_unmatched_new_nodes=
bk;
}
ProcessNode(bd,be);
bd.corresponding_node=be;
bd.textual_corresponding_node=be;
Assert(bd.status!=i.DAMAGED,
"Script became damaged");
}
function FindLiveSharedInfos(bd,N){
var bn=%LiveEditFindSharedFunctionInfosForScript(N);
var bo=new e();
for(var x=0;x<bn.length;x++){
bo.push(new SharedInfoWrapper(bn[x]));
}
function FindFunctionInfos(P){
var bp=[];
for(var x=0;x<bo.length;x++){
var bq=bo[x];
if(bq.start_position==P.start_position&&
bq.end_position==P.end_position){
bp.push(bq);
}
}
if(bp.length>0){
return bp;
}
}
function TraverseTree(w){
w.live_shared_function_infos=FindFunctionInfos(w.info);
for(var x=0;x<w.children.length;x++){
TraverseTree(w.children[x]);
}
}
TraverseTree(bd);
}
function FunctionCompileInfo(br){
this.function_name=br[0];
this.start_position=br[1];
this.end_position=br[2];
this.param_num=br[3];
this.scope_info=br[4];
this.outer_index=br[5];
this.shared_function_info=br[6];
this.next_sibling_index=null;
this.raw_array=br;
}
function SharedInfoWrapper(br){
this.function_name=br[0];
this.start_position=br[1];
this.end_position=br[2];
this.info=br[3];
this.raw_array=br;
}
function PatchPositions(ad,ax,ae){
if(ad.live_shared_function_infos){
ad.live_shared_function_infos.forEach(function(L){
%LiveEditPatchFunctionPositions(L.raw_array,
ax);
});
ae.push({name:ad.info.function_name});
}else{
ae.push(
{name:ad.info.function_name,info_not_found:true});
}
}
function CreateNameForOldScript(N){
return N.name+" (old)";
}
function IsFunctionContextLocalsChanged(bs,bt){
var bu=bs.scope_info;
var bv=bt.scope_info;
var bw;
var bx;
if(bu){
bw=bu.toString();
}else{
bw="";
}
if(bv){
bx=bv.toString();
}else{
bx="";
}
if(bw!=bx){
return"Variable map changed: ["+bw+
"] => ["+bx+"]";
}
return;
}
var by;
function CheckStackActivations(old_shared_wrapper_list,
new_shared_list,
Z){
var bz=new e();
for(var x=0;x<old_shared_wrapper_list.length;x++){
bz[x]=old_shared_wrapper_list[x].info;
}
var bA=%LiveEditCheckAndDropActivations(
bz,new_shared_list,true);
if(bA[old_shared_wrapper_list.length]){
throw new Failure(bA[old_shared_wrapper_list.length]);
}
var bB=new e();
var bC=new e();
for(var x=0;x<bz.length;x++){
var bD=old_shared_wrapper_list[x];
if(bA[x]==by.REPLACED_ON_ACTIVE_STACK){
bC.push({name:bD.function_name});
}else if(bA[x]!=by.AVAILABLE_FOR_PATCH){
var bE={
name:bD.function_name,
start_pos:bD.start_position,
end_pos:bD.end_position,
replace_problem:
by.SymbolName(bA[x])
};
bB.push(bE);
}
}
if(bC.length>0){
Z.push({dropped_from_stack:bC});
}
if(bB.length>0){
Z.push({functions_on_stack:bB});
throw new Failure("Blocked by functions on stack");
}
return bC.length;
}
var by={
AVAILABLE_FOR_PATCH:1,
BLOCKED_ON_ACTIVE_STACK:2,
BLOCKED_ON_OTHER_STACK:3,
BLOCKED_UNDER_NATIVE_CODE:4,
REPLACED_ON_ACTIVE_STACK:5,
BLOCKED_UNDER_GENERATOR:6,
BLOCKED_ACTIVE_GENERATOR:7,
BLOCKED_NO_NEW_TARGET_ON_RESTART:8
};
by.SymbolName=function(bF){
var bG=by;
for(var bH in bG){
if(bG[bH]==bF){
return bH;
}
}
};
function Failure(as){
this.message=as;
}
Failure.prototype.toString=function(){
return"LiveEdit Failure: "+this.message;
};
function CopyErrorPositionToDetails(bI,p){
function createPositionStruct(N,bJ){
if(bJ==-1)return;
var bK=N.locationFromPosition(bJ,true);
if(bK==null)return;
return{
line:bK.line+1,
column:bK.column+1,
position:bJ
};
}
if(!("scriptObject"in bI)||!("startPosition"in bI)){
return;
}
var N=bI.scriptObject;
var bL={
start:createPositionStruct(N,bI.startPosition),
end:createPositionStruct(N,bI.endPosition)
};
p.position=bL;
}
function SetScriptSource(N,bM,bN,Z){
var j=N.source;
var bO=CompareStrings(j,bM);
return ApplyPatchMultiChunk(N,bO,bM,bN,
Z);
}
function CompareStrings(bP,bQ){
return %LiveEditCompareStrings(bP,bQ);
}
function ApplySingleChunkPatch(N,change_pos,change_len,new_str,
Z){
var j=N.source;
var bM=j.substring(0,change_pos)+
new_str+j.substring(change_pos+change_len);
return ApplyPatchMultiChunk(N,
[change_pos,change_pos+change_len,change_pos+new_str.length],
bM,false,Z);
}
function DescribeChangeTree(bd){
function ProcessOldNode(w){
var bR=[];
for(var x=0;x<w.children.length;x++){
var bc=w.children[x];
if(bc.status!=i.UNCHANGED){
bR.push(ProcessOldNode(bc));
}
}
var bS=[];
if(w.textually_unmatched_new_nodes){
for(var x=0;x<w.textually_unmatched_new_nodes.length;x++){
var bc=w.textually_unmatched_new_nodes[x];
bS.push(ProcessNewNode(bc));
}
}
var bT={
name:w.info.function_name,
positions:DescribePositions(w),
status:w.status,
children:bR,
new_children:bS
};
if(w.status_explanation){
bT.status_explanation=w.status_explanation;
}
if(w.textual_corresponding_node){
bT.new_positions=DescribePositions(w.textual_corresponding_node);
}
return bT;
}
function ProcessNewNode(w){
var bR=[];
if(false){
for(var x=0;x<w.children.length;x++){
bR.push(ProcessNewNode(w.children[x]));
}
}
var bT={
name:w.info.function_name,
positions:DescribePositions(w),
children:bR,
};
return bT;
}
function DescribePositions(w){
return{
start_position:w.info.start_position,
end_position:w.info.end_position
};
}
return ProcessOldNode(bd);
}
var bU={};
bU.SetScriptSource=SetScriptSource;
bU.ApplyPatchMultiChunk=ApplyPatchMultiChunk;
bU.Failure=Failure;
bU.TestApi={
PosTranslator:PosTranslator,
CompareStrings:CompareStrings,
ApplySingleChunkPatch:ApplySingleChunkPatch
};
a.Debug.LiveEdit=bU;
})

X prologueUQ
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=(void 0);
var e=(void 0);
var f=%ExportFromRuntime({});
var g=(void 0);
function SetupTypedArray(h){
h.next=g;
g=h;
}
function Export(h){
h(f);
}
function Import(h){
h.next=d;
d=h;
}
function ImportNow(i){
return f[i];
}
function ImportFromExperimental(h){
h.next=e;
e=h;
}
function SetFunctionName(h,i,j){
if((typeof(i)==='symbol')){
i="["+%SymbolDescription(i)+"]";
}
if((j===(void 0))){
%FunctionSetName(h,i);
}else{
%FunctionSetName(h,j+" "+i);
}
}
function InstallConstants(k,l){
%CheckIsBootstrapping();
%OptimizeObjectForAddingMultipleProperties(k,l.length>>1);
var m=2|4|1;
for(var n=0;n<l.length;n+=2){
var i=l[n];
var o=l[n+1];
%AddNamedProperty(k,i,o,m);
}
%ToFastProperties(k);
}
function InstallFunctions(k,m,p){
%CheckIsBootstrapping();
%OptimizeObjectForAddingMultipleProperties(k,p.length>>1);
for(var n=0;n<p.length;n+=2){
var q=p[n];
var h=p[n+1];
SetFunctionName(h,q);
%FunctionRemovePrototype(h);
%AddNamedProperty(k,q,h,m);
%SetNativeFlag(h);
}
%ToFastProperties(k);
}
function InstallGetter(k,i,r,m,j){
%CheckIsBootstrapping();
if((m===(void 0)))m=2;
SetFunctionName(r,i,(j===(void 0))?"get":j);
%FunctionRemovePrototype(r);
%DefineGetterPropertyUnchecked(k,i,r,m);
%SetNativeFlag(r);
}
function InstallGetterSetter(k,i,r,s,m){
%CheckIsBootstrapping();
if((m===(void 0)))m=2;
SetFunctionName(r,i,"get");
SetFunctionName(s,i,"set");
%FunctionRemovePrototype(r);
%FunctionRemovePrototype(s);
%DefineAccessorPropertyUnchecked(k,i,r,s,2);
%SetNativeFlag(r);
%SetNativeFlag(s);
}
function OverrideFunction(k,i,h,t){
%CheckIsBootstrapping();
%object_define_property(k,i,{value:h,
writeable:true,
configurable:true,
enumerable:false});
SetFunctionName(h,i);
if(!t)%FunctionRemovePrototype(h);
%SetNativeFlag(h);
}
function SetUpLockedPrototype(
constructor,fields,methods){
%CheckIsBootstrapping();
var u=constructor.prototype;
var v=(methods.length>>1)+(fields?fields.length:0);
if(v>=4){
%OptimizeObjectForAddingMultipleProperties(u,v);
}
if(fields){
for(var n=0;n<fields.length;n++){
%AddNamedProperty(u,fields[n],
(void 0),2|4);
}
}
for(var n=0;n<methods.length;n+=2){
var q=methods[n];
var h=methods[n+1];
%AddNamedProperty(u,q,h,2|4|1);
%SetNativeFlag(h);
}
%InternalSetPrototype(u,null);
%ToFastProperties(u);
}
function PostNatives(b){
%CheckIsBootstrapping();
for(;!(d===(void 0));d=d.next){
d(f);
}
var w=[
"AddBoundMethod",
"ArrayToString",
"AsyncFunctionNext",
"AsyncFunctionThrow",
"GetIterator",
"GetMethod",
"GlobalPromise",
"IntlParseDate",
"IntlParseNumber",
"IsNaN",
"MapEntries",
"MapIterator",
"MapIteratorNext",
"MaxSimple",
"MinSimple",
"NewPromiseCapability",
"NumberIsInteger",
"PerformPromiseThen",
"PromiseCastResolved",
"PromiseThen",
"RegExpSubclassExecJS",
"RegExpSubclassMatch",
"RegExpSubclassReplace",
"RegExpSubclassSearch",
"RegExpSubclassSplit",
"RegExpSubclassTest",
"SetIterator",
"SetIteratorNext",
"SetValues",
"ToLocaleLowerCaseI18N",
"ToLocaleUpperCaseI18N",
"ToLowerCaseI18N",
"ToPositiveInteger",
"ToUpperCaseI18N",
"is_concat_spreadable_symbol",
"iterator_symbol",
"promise_result_symbol",
"promise_state_symbol",
"object_freeze",
"object_is_frozen",
"object_is_sealed",
"reflect_apply",
"reflect_construct",
"regexp_flags_symbol",
"to_string_tag_symbol",
"object_to_string",
"species_symbol",
"match_symbol",
"replace_symbol",
"search_symbol",
"split_symbol",
];
var x={};
%OptimizeObjectForAddingMultipleProperties(
x,w.length);
for(var q of w){
x[q]=f[q];
}
%ToFastProperties(x);
f=x;
b.PostNatives=(void 0);
b.ImportFromExperimental=(void 0);
}
function PostExperimentals(b){
%CheckIsBootstrapping();
%ExportExperimentalFromRuntime(f);
for(;!(d===(void 0));d=d.next){
d(f);
}
for(;!(e===(void 0));
e=e.next){
e(f);
}
b.Export=(void 0);
b.PostDebug=(void 0);
b.PostExperimentals=(void 0);
g=(void 0);
}
function PostDebug(b){
for(;!(d===(void 0));d=d.next){
d(f);
}
f=(void 0);
b.Export=(void 0);
b.Import=(void 0);
b.ImportNow=(void 0);
b.PostDebug=(void 0);
b.PostExperimentals=(void 0);
g=(void 0);
}
function InitializeBuiltinTypedArrays(b,y,z){
var A=g;
for(;!(A===(void 0));A=A.next){
A(y,z);
}
}
%OptimizeObjectForAddingMultipleProperties(b,14);
b.Import=Import;
b.ImportNow=ImportNow;
b.Export=Export;
b.ImportFromExperimental=ImportFromExperimental;
b.SetFunctionName=SetFunctionName;
b.InstallConstants=InstallConstants;
b.InstallFunctions=InstallFunctions;
b.InstallGetter=InstallGetter;
b.InstallGetterSetter=InstallGetterSetter;
b.OverrideFunction=OverrideFunction;
b.SetUpLockedPrototype=SetUpLockedPrototype;
b.PostNatives=PostNatives;
b.PostExperimentals=PostExperimentals;
b.PostDebug=PostDebug;
%ToFastProperties(b);
%OptimizeObjectForAddingMultipleProperties(c,5);
c.logStackTrace=function logStackTrace(){
%DebugTrace();
};
c.log=function log(){
let message='';
for(const arg of arguments){
message+=arg;
}
%GlobalPrint(message);
};
c.createPrivateSymbol=function createPrivateSymbol(i){
return %CreatePrivateSymbol(i);
};
c.simpleBind=function simpleBind(B,C){
return function(...args){
return %reflect_apply(B,C,args);
};
};
c.uncurryThis=function uncurryThis(B){
return function(C,...args){
return %reflect_apply(B,C,args);
};
};
%ToFastProperties(c);
})

runtime5
(function(a,b){
%CheckIsBootstrapping();
var c=a.Array;
var d=a.Boolean;
var e=a.String;
var f;
b.Import(function(g){
f=g.species_symbol;
});
function ToPositiveInteger(h,i){
var j=(%_ToInteger(h))+0;
if(j<0)throw %make_range_error(i);
return j;
}
function ToIndex(h,i){
var j=(%_ToInteger(h))+0;
if(j<0||j>9007199254740991)throw %make_range_error(i);
return j;
}
function MaxSimple(k,l){
return k>l?k:l;
}
function MinSimple(k,l){
return k>l?l:k;
}
%SetForceInlineFlag(MaxSimple);
%SetForceInlineFlag(MinSimple);
function SpeciesConstructor(m,n){
var o=m.constructor;
if((o===(void 0))){
return n;
}
if(!(%_IsJSReceiver(o))){
throw %make_type_error(28);
}
var p=o[f];
if((p==null)){
return n;
}
if(%IsConstructor(p)){
return p;
}
throw %make_type_error(235);
}
%FunctionSetPrototype(c,new c(0));
b.Export(function(q){
q.MaxSimple=MaxSimple;
q.MinSimple=MinSimple;
q.ToPositiveInteger=ToPositiveInteger;
q.ToIndex=ToIndex;
q.SpeciesConstructor=SpeciesConstructor;
});
})

$v8nativesy@
(function(a,b){
%CheckIsBootstrapping();
var c=a.Number;
var d=a.Object;
var e=b.ImportNow("iterator_symbol");
var f=%GetRootNaN();
var g=b.ImportNow("object_to_string");
function GlobalIsNaN(h){
h=(%_ToNumber(h));
return(!%_IsSmi(%IS_VAR(h))&&!(h==h));
}
function GlobalIsFinite(h){
h=(%_ToNumber(h));
return(%_IsSmi(%IS_VAR(h))||((h==h)&&(h!=1/0)&&(h!=-1/0)));
}
function GlobalParseInt(i,j){
if((j===(void 0))||j===10||j===0){
if(%_IsSmi(i))return i;
if((typeof(i)==='number')&&
((0.01<i&&i<1e9)||
(-1e9<i&&i<-0.01))){
return i|0;
}
i=(%_ToString(i));
j=j|0;
}else{
i=(%_ToString(i));
j=((j)|0);
if(!(j==0||(2<=j&&j<=36))){
return f;
}
}
if(%_HasCachedArrayIndex(i)&&
(j==0||j==10)){
return %_GetCachedArrayIndex(i);
}
return %StringParseInt(i,j);
}
function GlobalParseFloat(i){
i=(%_ToString(i));
if(%_HasCachedArrayIndex(i))return %_GetCachedArrayIndex(i);
return %StringParseFloat(i);
}
var k=2|4|1;
b.InstallConstants(a,[
"Infinity",(1/0),
"NaN",f,
"undefined",(void 0),
]);
b.InstallFunctions(a,2,[
"isNaN",GlobalIsNaN,
"isFinite",GlobalIsFinite,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat,
]);
function ObjectToLocaleString(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Object.prototype.toLocaleString");
return this.toString();
}
function ObjectValueOf(){
return(%_ToObject(this));
}
function ObjectIsPrototypeOf(l){
if(!(%_IsJSReceiver(l)))return false;
var m=(%_ToObject(this));
return %HasInPrototypeChain(l,m);
}
function GetMethod(n,o){
var p=n[o];
if((p==null))return(void 0);
if((typeof(p)==='function'))return p;
throw %make_type_error(15,typeof p);
}
function ObjectSetPrototypeOf(n,q){
if((%IS_VAR(n)===null)||(n===(void 0)))throw %make_type_error(17,"Object.setPrototypeOf");
if(q!==null&&!(%_IsJSReceiver(q))){
throw %make_type_error(87,q);
}
if((%_IsJSReceiver(n))){
%SetPrototype(n,q);
}
return n;
}
function ObjectGetProto(){
return %object_get_prototype_of(this);
}
function ObjectSetProto(q){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Object.prototype.__proto__");
if(((%_IsJSReceiver(q))||(q===null))&&(%_IsJSReceiver(this))){
%SetPrototype(this,q);
}
}
function ObjectConstructor(r){
if(d!=new.target&&!(new.target===(void 0))){
return this;
}
if((r===null)||(r===(void 0)))return{};
return(%_ToObject(r));
}
%SetNativeFlag(d);
%SetCode(d,ObjectConstructor);
%AddNamedProperty(d.prototype,"constructor",d,
2);
b.InstallFunctions(d.prototype,2,[
"toString",g,
"toLocaleString",ObjectToLocaleString,
"valueOf",ObjectValueOf,
"isPrototypeOf",ObjectIsPrototypeOf,
]);
b.InstallGetterSetter(
d.prototype,"__proto__",ObjectGetProto,ObjectSetProto);
b.InstallFunctions(d,2,[
"setPrototypeOf",ObjectSetPrototypeOf,
]);
function NumberIsFinite(h){
return(typeof(h)==='number')&&(%_IsSmi(%IS_VAR(h))||((h==h)&&(h!=1/0)&&(h!=-1/0)));
}
function NumberIsInteger(h){
return NumberIsFinite(h)&&(%_ToInteger(h))==h;
}
function NumberIsNaN(h){
return(typeof(h)==='number')&&(!%_IsSmi(%IS_VAR(h))&&!(h==h));
}
function NumberIsSafeInteger(h){
if(NumberIsFinite(h)){
var s=(%_ToInteger(h));
if(s==h){
return-9007199254740991<=s&&s<=9007199254740991;
}
}
return false;
}
b.InstallConstants(c,[
"MAX_VALUE",1.7976931348623157e+308,
"MIN_VALUE",5e-324,
"NaN",f,
"NEGATIVE_INFINITY",-(1/0),
"POSITIVE_INFINITY",(1/0),
"MAX_SAFE_INTEGER",9007199254740991,
"MIN_SAFE_INTEGER",-9007199254740991,
"EPSILON",2.220446049250313e-16,
]);
b.InstallFunctions(c,2,[
"isFinite",NumberIsFinite,
"isInteger",NumberIsInteger,
"isNaN",NumberIsNaN,
"isSafeInteger",NumberIsSafeInteger,
"parseInt",GlobalParseInt,
"parseFloat",GlobalParseFloat
]);
%SetForceInlineFlag(NumberIsNaN);
function GetIterator(n,t){
if((t===(void 0))){
t=n[e];
}
if(!(typeof(t)==='function')){
throw %make_type_error(70,n);
}
var u=%_Call(t,n);
if(!(%_IsJSReceiver(u))){
throw %make_type_error(64,u);
}
return u;
}
b.Export(function(v){
v.GetIterator=GetIterator;
v.GetMethod=GetMethod;
v.IsNaN=GlobalIsNaN;
v.NumberIsNaN=NumberIsNaN;
v.NumberIsInteger=NumberIsInteger;
v.ObjectHasOwnProperty=d.prototype.hasOwnProperty;
});
%InstallToContext([
"object_value_of",ObjectValueOf,
]);
})

symbolô
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Symbol;
var d=b.ImportNow("has_instance_symbol");
var e=
b.ImportNow("is_concat_spreadable_symbol");
var f=b.ImportNow("iterator_symbol");
var g=b.ImportNow("match_symbol");
var h=b.ImportNow("replace_symbol");
var i=b.ImportNow("search_symbol");
var j=b.ImportNow("species_symbol");
var k=b.ImportNow("split_symbol");
var l=b.ImportNow("to_primitive_symbol");
var m=b.ImportNow("to_string_tag_symbol");
var n=b.ImportNow("unscopables_symbol");
function SymbolFor(o){
o=(%_ToString(o));
var p=%SymbolRegistry();
if((p.for[o]===(void 0))){
var q=%CreateSymbol(o);
p.for[o]=q;
p.keyFor[q]=o;
}
return p.for[o];
}
function SymbolKeyFor(q){
if(!(typeof(q)==='symbol'))throw %make_type_error(137,q);
return %SymbolRegistry().keyFor[q];
}
b.InstallConstants(c,[
"hasInstance",d,
"isConcatSpreadable",e,
"iterator",f,
"match",g,
"replace",h,
"search",i,
"species",j,
"split",k,
"toPrimitive",l,
"toStringTag",m,
"unscopables",n,
]);
b.InstallFunctions(c,2,[
"for",SymbolFor,
"keyFor",SymbolKeyFor
]);
})

arrayæ`
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d;
var e;
var f=a.Array;
var g=b.InternalArray;
var h=b.InternalPackedArray;
var i;
var j;
var k;
var l=b.ImportNow("object_to_string");
var m=b.ImportNow("iterator_symbol");
var n=b.ImportNow("species_symbol");
var o=b.ImportNow("unscopables_symbol");
b.Import(function(p){
d=p.GetIterator;
e=p.GetMethod;
i=p.MaxSimple;
j=p.MinSimple;
k=p.ObjectHasOwnProperty;
});
function ArraySpeciesCreate(q,r){
r=((r)+0);
var s=%ArraySpeciesConstructor(q);
return new s(r);
}
function KeySortCompare(t,u){
return t-u;
}
function GetSortedArrayKeys(q,v){
if((typeof(v)==='number')){
var w=v;
var x=new g();
for(var y=0;y<w;++y){
var z=q[y];
if(!(z===(void 0))||y in q){
x.push(y);
}
}
return x;
}
return InnerArraySort(v,v.length,KeySortCompare);
}
function SparseJoinWithSeparatorJS(q,x,r,A,B){
var C=x.length;
var D=new g(C*2);
for(var y=0;y<C;y++){
var E=x[y];
D[y*2]=E;
D[y*2+1]=ConvertToString(A,q[E]);
}
return %SparseJoinWithSeparator(D,r,B);
}
function SparseJoin(q,x,A){
var C=x.length;
var D=new g(C);
for(var y=0;y<C;y++){
D[y]=ConvertToString(A,q[x[y]]);
}
return %StringBuilderConcat(D,C,'');
}
function UseSparseVariant(q,r,F,G){
if(!F||r<1000||%HasComplexElements(q)){
return false;
}
if(!%_IsSmi(r)){
return true;
}
var H=r>>2;
var I=%EstimateNumberOfElements(q);
return(I<H)&&
(G>I*4);
}
function Stack(){
this.length=0;
this.values=new g();
}
Stack.prototype.length=null;
Stack.prototype.values=null;
function StackPush(J,K){
J.values[J.length++]=K;
}
function StackPop(J){
J.values[--J.length]=null
}
function StackHas(J,L){
var r=J.length;
var M=J.values;
for(var y=0;y<r;y++){
if(M[y]===L)return true;
}
return false;
}
var N=new Stack();
function DoJoin(q,r,F,B,A){
if(UseSparseVariant(q,r,F,r)){
%NormalizeElements(q);
var x=GetSortedArrayKeys(q,%GetArrayKeys(q,r));
if(B===''){
if(x.length===0)return'';
return SparseJoin(q,x,A);
}else{
return SparseJoinWithSeparatorJS(
q,x,r,A,B);
}
}
if(r===1){
return ConvertToString(A,q[0]);
}
var D=new g(r);
for(var y=0;y<r;y++){
D[y]=ConvertToString(A,q[y]);
}
if(B===''){
return %StringBuilderConcat(D,r,'');
}else{
return %StringBuilderJoin(D,r,B);
}
}
function Join(q,r,B,A){
if(r===0)return'';
var F=(%_IsArray(q));
if(F){
if(StackHas(N,q))return'';
StackPush(N,q);
}
try{
return DoJoin(q,r,F,B,A);
}finally{
if(F)StackPop(N);
}
}
function ConvertToString(A,O){
if((O==null))return'';
return(%_ToString(A?O.toLocaleString():O));
}
function SparseSlice(q,P,Q,R,S){
var v=%GetArrayKeys(q,P+Q);
if((typeof(v)==='number')){
var w=v;
for(var y=P;y<w;++y){
var T=q[y];
if(!(T===(void 0))||y in q){
%CreateDataProperty(S,y-P,T);
}
}
}else{
var r=v.length;
for(var U=0;U<r;++U){
var E=v[U];
if(E>=P){
var T=q[E];
if(!(T===(void 0))||E in q){
%CreateDataProperty(S,E-P,T);
}
}
}
}
}
function SparseMove(q,P,Q,R,V){
if(V===Q)return;
var W=new g(
j(R-Q+V,0xffffffff));
var X;
var v=%GetArrayKeys(q,R);
if((typeof(v)==='number')){
var w=v;
for(var y=0;y<P&&y<w;++y){
var T=q[y];
if(!(T===(void 0))||y in q){
W[y]=T;
}
}
for(var y=P+Q;y<w;++y){
var T=q[y];
if(!(T===(void 0))||y in q){
W[y-Q+V]=T;
}
}
}else{
var r=v.length;
for(var U=0;U<r;++U){
var E=v[U];
if(E<P){
var T=q[E];
if(!(T===(void 0))||E in q){
W[E]=T;
}
}else if(E>=P+Q){
var T=q[E];
if(!(T===(void 0))||E in q){
var Y=E-Q+V;
W[Y]=T;
if(Y>0xfffffffe){
X=X||new g();
X.push(Y);
}
}
}
}
}
%MoveArrayContents(W,q);
if(!(X===(void 0))){
var r=X.length;
for(var y=0;y<r;++y){
var E=X[y];
q[E]=W[E];
}
}
}
function SimpleSlice(q,P,Q,R,S){
for(var y=0;y<Q;y++){
var Z=P+y;
if(Z in q){
var T=q[Z];
%CreateDataProperty(S,y,T);
}
}
}
function SimpleMove(q,P,Q,R,V){
if(V!==Q){
if(V>Q){
for(var y=R-Q;y>P;y--){
var aa=y+Q-1;
var ab=y+V-1;
if(aa in q){
q[ab]=q[aa];
}else{
delete q[ab];
}
}
}else{
for(var y=P;y<R-Q;y++){
var aa=y+Q;
var ab=y+V;
if(aa in q){
q[ab]=q[aa];
}else{
delete q[ab];
}
}
for(var y=R;y>R-Q+V;y--){
delete q[y-1];
}
}
}
}
function ArrayToString(){
var q;
var ac;
if((%_IsArray(this))){
ac=this.join;
if(ac===ArrayJoin){
return Join(this,this.length,',',false);
}
q=this;
}else{
q=(%_ToObject(this));
ac=q.join;
}
if(!(typeof(ac)==='function')){
return %_Call(l,q);
}
return %_Call(ac,q);
}
function InnerArrayToLocaleString(q,r){
return Join(q,(%_ToLength(r)),',',true);
}
function ArrayToLocaleString(){
var q=(%_ToObject(this));
var ad=q.length;
return InnerArrayToLocaleString(q,ad);
}
function InnerArrayJoin(B,q,r){
if((B===(void 0))){
B=',';
}else{
B=(%_ToString(B));
}
if(r===1){
var z=q[0];
if((z==null))return'';
return(%_ToString(z));
}
return Join(q,r,B,false);
}
function ArrayJoin(B){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.join");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayJoin(B,q,r);
}
function ArrayPop(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.pop");
var q=(%_ToObject(this));
var ae=(%_ToLength(q.length));
if(ae==0){
q.length=ae;
return;
}
ae--;
var K=q[ae];
%DeleteProperty_Strict(q,ae);
q.length=ae;
return K;
}
function ArrayPush(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.push");
var q=(%_ToObject(this));
var ae=(%_ToLength(q.length));
var af=arguments.length;
if(af>9007199254740991-ae)throw %make_type_error(227,af,ae);
for(var y=0;y<af;y++){
q[y+ae]=arguments[y];
}
var ag=ae+af;
q.length=ag;
return ag;
}
function SparseReverse(q,R){
var x=GetSortedArrayKeys(q,%GetArrayKeys(q,R));
var ah=x.length-1;
var ai=0;
while(ai<=ah){
var y=x[ai];
var aj=x[ah];
var ak=R-aj-1;
var al,am;
if(ak<=y){
am=aj;
while(x[--ah]==aj){}
al=ak;
}
if(ak>=y){
al=y;
while(x[++ai]==y){}
am=R-y-1;
}
var an=q[al];
if(!(an===(void 0))||al in q){
var ao=q[am];
if(!(ao===(void 0))||am in q){
q[al]=ao;
q[am]=an;
}else{
q[am]=an;
delete q[al];
}
}else{
var ao=q[am];
if(!(ao===(void 0))||am in q){
q[al]=ao;
delete q[am];
}
}
}
}
function PackedArrayReverse(q,R){
var aj=R-1;
for(var y=0;y<aj;y++,aj--){
var an=q[y];
var ao=q[aj];
q[y]=ao;
q[aj]=an;
}
return q;
}
function GenericArrayReverse(q,R){
var aj=R-1;
for(var y=0;y<aj;y++,aj--){
if(y in q){
var an=q[y];
if(aj in q){
var ao=q[aj];
q[y]=ao;
q[aj]=an;
}else{
q[aj]=an;
delete q[y];
}
}else{
if(aj in q){
var ao=q[aj];
q[y]=ao;
delete q[aj];
}
}
}
return q;
}
function ArrayReverse(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.reverse");
var q=(%_ToObject(this));
var R=(%_ToLength(q.length));
var ap=(%_IsArray(q));
if(UseSparseVariant(q,R,ap,R)){
%NormalizeElements(q);
SparseReverse(q,R);
return q;
}else if(ap&&%_HasFastPackedElements(q)){
return PackedArrayReverse(q,R);
}else{
return GenericArrayReverse(q,R);
}
}
function ArrayShift(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.shift");
var q=(%_ToObject(this));
var R=(%_ToLength(q.length));
if(R===0){
q.length=0;
return;
}
if(%object_is_sealed(q))throw %make_type_error(13);
var aq=q[0];
if(UseSparseVariant(q,R,(%_IsArray(q)),R)){
SparseMove(q,0,1,R,0);
}else{
SimpleMove(q,0,1,R,0);
}
q.length=R-1;
return aq;
}
function ArrayUnshift(ar){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.unshift");
var q=(%_ToObject(this));
var R=(%_ToLength(q.length));
var as=arguments.length;
if(R>0&&UseSparseVariant(q,R,(%_IsArray(q)),R)&&
!%object_is_sealed(q)){
SparseMove(q,0,0,R,as);
}else{
SimpleMove(q,0,0,R,as);
}
for(var y=0;y<as;y++){
q[y]=arguments[y];
}
var ag=R+as;
q.length=ag;
return ag;
}
function ArraySlice(at,au){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.slice");
var q=(%_ToObject(this));
var R=(%_ToLength(q.length));
var P=(%_ToInteger(at));
var av=R;
if(!(au===(void 0)))av=(%_ToInteger(au));
if(P<0){
P+=R;
if(P<0)P=0;
}else{
if(P>R)P=R;
}
if(av<0){
av+=R;
if(av<0)av=0;
}else{
if(av>R)av=R;
}
var aw=ArraySpeciesCreate(q,i(av-P,0));
if(av<P)return aw;
if(UseSparseVariant(q,R,(%_IsArray(q)),av-P)){
%NormalizeElements(q);
if((%_IsArray(aw)))%NormalizeElements(aw);
SparseSlice(q,P,av-P,R,aw);
}else{
SimpleSlice(q,P,av-P,R,aw);
}
aw.length=av-P;
return aw;
}
function ComputeSpliceStartIndex(P,R){
if(P<0){
P+=R;
return P<0?0:P;
}
return P>R?R:P;
}
function ComputeSpliceDeleteCount(ax,as,R,P){
var Q=0;
if(as==1)
return R-P;
Q=(%_ToInteger(ax));
if(Q<0)
return 0;
if(Q>R-P)
return R-P;
return Q;
}
function ArraySplice(at,ax){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.splice");
var as=arguments.length;
var q=(%_ToObject(this));
var R=(%_ToLength(q.length));
var P=ComputeSpliceStartIndex((%_ToInteger(at)),R);
var Q=ComputeSpliceDeleteCount(ax,as,R,
P);
var S=ArraySpeciesCreate(q,Q);
S.length=Q;
var ay=as>2?as-2:0;
if(Q!=ay&&%object_is_sealed(q)){
throw %make_type_error(13);
}else if(Q>0&&%object_is_frozen(q)){
throw %make_type_error(12);
}
var az=Q;
if(ay!=Q){
az+=R-P-Q;
}
if(UseSparseVariant(q,R,(%_IsArray(q)),az)){
%NormalizeElements(q);
if((%_IsArray(S)))%NormalizeElements(S);
SparseSlice(q,P,Q,R,S);
SparseMove(q,P,Q,R,ay);
}else{
SimpleSlice(q,P,Q,R,S);
SimpleMove(q,P,Q,R,ay);
}
var y=P;
var aA=2;
var aB=arguments.length;
while(aA<aB){
q[y++]=arguments[aA++];
}
q.length=R-Q+ay;
return S;
}
function InnerArraySort(q,r,aC){
if(!(typeof(aC)==='function')){
aC=function(O,aD){
if(O===aD)return 0;
if(%_IsSmi(O)&&%_IsSmi(aD)){
return %SmiLexicographicCompare(O,aD);
}
O=(%_ToString(O));
aD=(%_ToString(aD));
if(O==aD)return 0;
else return O<aD?-1:1;
};
}
var aE=function InsertionSort(t,p,aF){
for(var y=p+1;y<aF;y++){
var aG=t[y];
for(var aj=y-1;aj>=p;aj--){
var aH=t[aj];
var aI=aC(aH,aG);
if(aI>0){
t[aj+1]=aH;
}else{
break;
}
}
t[aj+1]=aG;
}
};
var aJ=function(t,p,aF){
var aK=new g();
var aL=200+((aF-p)&15);
var aj=0;
p+=1;
aF-=1;
for(var y=p;y<aF;y+=aL){
aK[aj]=[y,t[y]];
aj++;
}
aK.sort(function(t,u){
return aC(t[1],u[1]);
});
var aM=aK[aK.length>>1][0];
return aM;
}
var aN=function QuickSort(t,p,aF){
var aM=0;
while(true){
if(aF-p<=10){
aE(t,p,aF);
return;
}
if(aF-p>1000){
aM=aJ(t,p,aF);
}else{
aM=p+((aF-p)>>1);
}
var aO=t[p];
var aP=t[aF-1];
var aQ=t[aM];
var aR=aC(aO,aP);
if(aR>0){
var aH=aO;
aO=aP;
aP=aH;
}
var aS=aC(aO,aQ);
if(aS>=0){
var aH=aO;
aO=aQ;
aQ=aP;
aP=aH;
}else{
var aT=aC(aP,aQ);
if(aT>0){
var aH=aP;
aP=aQ;
aQ=aH;
}
}
t[p]=aO;
t[aF-1]=aQ;
var aU=aP;
var aV=p+1;
var aW=aF-1;
t[aM]=t[aV];
t[aV]=aU;
partition:for(var y=aV+1;y<aW;y++){
var aG=t[y];
var aI=aC(aG,aU);
if(aI<0){
t[y]=t[aV];
t[aV]=aG;
aV++;
}else if(aI>0){
do{
aW--;
if(aW==y)break partition;
var aX=t[aW];
aI=aC(aX,aU);
}while(aI>0);
t[y]=t[aW];
t[aW]=aG;
if(aI<0){
aG=t[y];
t[y]=t[aV];
t[aV]=aG;
aV++;
}
}
}
if(aF-aW<aV-p){
aN(t,aW,aF);
aF=aV;
}else{
aN(t,p,aV);
p=aW;
}
}
};
var aY=function CopyFromPrototype(aZ,r){
var ba=0;
for(var bb=%object_get_prototype_of(aZ);bb;
bb=%object_get_prototype_of(bb)){
var v=(%_IsJSProxy(bb))?r:%GetArrayKeys(bb,r);
if((typeof(v)==='number')){
var bc=v;
for(var y=0;y<bc;y++){
if(!(%_Call(k,aZ,y))&&(%_Call(k,bb,y))){
aZ[y]=bb[y];
if(y>=ba){ba=y+1;}
}
}
}else{
for(var y=0;y<v.length;y++){
var Z=v[y];
if(!(%_Call(k,aZ,Z))&&(%_Call(k,bb,Z))){
aZ[Z]=bb[Z];
if(Z>=ba){ba=Z+1;}
}
}
}
}
return ba;
};
var bd=function(aZ,p,aF){
for(var bb=%object_get_prototype_of(aZ);bb;
bb=%object_get_prototype_of(bb)){
var v=(%_IsJSProxy(bb))?aF:%GetArrayKeys(bb,aF);
if((typeof(v)==='number')){
var bc=v;
for(var y=p;y<bc;y++){
if((%_Call(k,bb,y))){
aZ[y]=(void 0);
}
}
}else{
for(var y=0;y<v.length;y++){
var Z=v[y];
if(p<=Z&&(%_Call(k,bb,Z))){
aZ[Z]=(void 0);
}
}
}
}
};
var be=function SafeRemoveArrayHoles(aZ){
var bf=0;
var bg=r-1;
var bh=0;
while(bf<bg){
while(bf<bg&&
!(aZ[bf]===(void 0))){
bf++;
}
if(!(%_Call(k,aZ,bf))){
bh++;
}
while(bf<bg&&
(aZ[bg]===(void 0))){
if(!(%_Call(k,aZ,bg))){
bh++;
}
bg--;
}
if(bf<bg){
aZ[bf]=aZ[bg];
aZ[bg]=(void 0);
}
}
if(!(aZ[bf]===(void 0)))bf++;
var y;
for(y=bf;y<r-bh;y++){
aZ[y]=(void 0);
}
for(y=r-bh;y<r;y++){
if(y in %object_get_prototype_of(aZ)){
aZ[y]=(void 0);
}else{
delete aZ[y];
}
}
return bf;
};
if(r<2)return q;
var F=(%_IsArray(q));
var bi;
if(!F){
bi=aY(q,r);
}
var bj=%RemoveArrayHoles(q,r);
if(bj==-1){
bj=be(q);
}
aN(q,0,bj);
if(!F&&(bj+1<bi)){
bd(q,bj,bi);
}
return q;
}
function ArraySort(aC){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.sort");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArraySort(q,r,aC);
}
function InnerArrayFilter(bk,bl,q,r,aw){
var bm=0;
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
if(%_Call(bk,bl,aG,y,q)){
%CreateDataProperty(aw,bm,aG);
bm++;
}
}
}
return aw;
}
function ArrayFilter(bk,bl){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.filter");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
if(!(typeof(bk)==='function'))throw %make_type_error(15,bk);
var aw=ArraySpeciesCreate(q,0);
return InnerArrayFilter(bk,bl,q,r,aw);
}
function InnerArrayForEach(bk,bl,q,r){
if(!(typeof(bk)==='function'))throw %make_type_error(15,bk);
if((bl===(void 0))){
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
bk(aG,y,q);
}
}
}else{
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
%_Call(bk,bl,aG,y,q);
}
}
}
}
function ArrayForEach(bk,bl){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.forEach");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
InnerArrayForEach(bk,bl,q,r);
}
function InnerArraySome(bk,bl,q,r){
if(!(typeof(bk)==='function'))throw %make_type_error(15,bk);
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
if(%_Call(bk,bl,aG,y,q))return true;
}
}
return false;
}
function ArraySome(bk,bl){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.some");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArraySome(bk,bl,q,r);
}
function InnerArrayEvery(bk,bl,q,r){
if(!(typeof(bk)==='function'))throw %make_type_error(15,bk);
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
if(!%_Call(bk,bl,aG,y,q))return false;
}
}
return true;
}
function ArrayEvery(bk,bl){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.every");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayEvery(bk,bl,q,r);
}
function ArrayMap(bk,bl){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.map");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
if(!(typeof(bk)==='function'))throw %make_type_error(15,bk);
var aw=ArraySpeciesCreate(q,r);
for(var y=0;y<r;y++){
if(y in q){
var aG=q[y];
%CreateDataProperty(aw,y,%_Call(bk,bl,aG,y,q));
}
}
return aw;
}
function InnerArrayLastIndexOf(q,aG,Z,r,bn){
if(r==0)return-1;
if(bn<2){
Z=r-1;
}else{
Z=(((%_ToInteger(Z)))+0);
if(Z<0)Z+=r;
if(Z<0)return-1;
else if(Z>=r)Z=r-1;
}
var bo=0;
var ba=Z;
if(UseSparseVariant(q,r,(%_IsArray(q)),Z)){
%NormalizeElements(q);
var v=%GetArrayKeys(q,Z+1);
if((typeof(v)==='number')){
ba=v;
}else{
if(v.length==0)return-1;
var bp=GetSortedArrayKeys(q,v);
var y=bp.length-1;
while(y>=0){
var E=bp[y];
if(q[E]===aG)return E;
y--;
}
return-1;
}
}
if(!(aG===(void 0))){
for(var y=ba;y>=bo;y--){
if(q[y]===aG)return y;
}
return-1;
}
for(var y=ba;y>=bo;y--){
if((q[y]===(void 0))&&y in q){
return y;
}
}
return-1;
}
function ArrayLastIndexOf(aG,Z){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.lastIndexOf");
var r=(%_ToLength(this.length));
return InnerArrayLastIndexOf(this,aG,Z,r,
arguments.length);
}
function InnerArrayReduce(bq,T,q,r,bn){
if(!(typeof(bq)==='function')){
throw %make_type_error(15,bq);
}
var y=0;
find_initial:if(bn<2){
for(;y<r;y++){
if(y in q){
T=q[y++];
break find_initial;
}
}
throw %make_type_error(121);
}
for(;y<r;y++){
if(y in q){
var aG=q[y];
T=bq(T,aG,y,q);
}
}
return T;
}
function ArrayReduce(bq,T){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.reduce");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayReduce(bq,T,q,r,
arguments.length);
}
function InnerArrayReduceRight(bq,T,q,r,
bn){
if(!(typeof(bq)==='function')){
throw %make_type_error(15,bq);
}
var y=r-1;
find_initial:if(bn<2){
for(;y>=0;y--){
if(y in q){
T=q[y--];
break find_initial;
}
}
throw %make_type_error(121);
}
for(;y>=0;y--){
if(y in q){
var aG=q[y];
T=bq(T,aG,y,q);
}
}
return T;
}
function ArrayReduceRight(bq,T){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.reduceRight");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayReduceRight(bq,T,q,r,
arguments.length);
}
function InnerArrayCopyWithin(br,at,au,q,r){
br=(%_ToInteger(br));
var aF;
if(br<0){
aF=i(r+br,0);
}else{
aF=j(br,r);
}
at=(%_ToInteger(at));
var p;
if(at<0){
p=i(r+at,0);
}else{
p=j(at,r);
}
au=(au===(void 0))?r:(%_ToInteger(au));
var bs;
if(au<0){
bs=i(r+au,0);
}else{
bs=j(au,r);
}
var bt=j(bs-p,r-aF);
var bu=1;
if(p<aF&&aF<(p+bt)){
bu=-1;
p=p+bt-1;
aF=aF+bt-1;
}
while(bt>0){
if(p in q){
q[aF]=q[p];
}else{
delete q[aF];
}
p=p+bu;
aF=aF+bu;
bt--;
}
return q;
}
function ArrayCopyWithin(br,at,au){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.copyWithin");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayCopyWithin(br,at,au,q,r);
}
function InnerArrayFind(bv,bw,q,r){
if(!(typeof(bv)==='function')){
throw %make_type_error(15,bv);
}
for(var y=0;y<r;y++){
var aG=q[y];
if(%_Call(bv,bw,aG,y,q)){
return aG;
}
}
return;
}
function ArrayFind(bv,bw){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.find");
var q=(%_ToObject(this));
var r=(%_ToInteger(q.length));
return InnerArrayFind(bv,bw,q,r);
}
function InnerArrayFindIndex(bv,bw,q,r){
if(!(typeof(bv)==='function')){
throw %make_type_error(15,bv);
}
for(var y=0;y<r;y++){
var aG=q[y];
if(%_Call(bv,bw,aG,y,q)){
return y;
}
}
return-1;
}
function ArrayFindIndex(bv,bw){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.findIndex");
var q=(%_ToObject(this));
var r=(%_ToInteger(q.length));
return InnerArrayFindIndex(bv,bw,q,r);
}
function InnerArrayFill(K,at,au,q,r){
var y=(at===(void 0))?0:(%_ToInteger(at));
var au=(au===(void 0))?r:(%_ToInteger(au));
if(y<0){
y+=r;
if(y<0)y=0;
}else{
if(y>r)y=r;
}
if(au<0){
au+=r;
if(au<0)au=0;
}else{
if(au>r)au=r;
}
if((au-y)>0&&%object_is_frozen(q)){
throw %make_type_error(12);
}
for(;y<au;y++)
q[y]=K;
return q;
}
function ArrayFill(K,at,au){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"Array.prototype.fill");
var q=(%_ToObject(this));
var r=(%_ToLength(q.length));
return InnerArrayFill(K,at,au,q,r);
}
function ArrayFrom(bx,by,bl){
var bz=(%_ToObject(bx));
var bA=!(by===(void 0));
if(bA){
if(!(typeof(by)==='function')){
throw %make_type_error(15,by);
}
}
var bB=e(bz,m);
var U;
var aw;
var bC;
var bD;
if(!(bB===(void 0))){
aw=%IsConstructor(this)?new this():[];
U=0;
for(bD of
{[m](){return d(bz,bB)}}){
if(bA){
bC=%_Call(by,bl,bD,U);
}else{
bC=bD;
}
%CreateDataProperty(aw,U,bC);
U++;
}
aw.length=U;
return aw;
}else{
var R=(%_ToLength(bz.length));
aw=%IsConstructor(this)?new this(R):new f(R);
for(U=0;U<R;++U){
bD=bz[U];
if(bA){
bC=%_Call(by,bl,bD,U);
}else{
bC=bD;
}
%CreateDataProperty(aw,U,bC);
}
aw.length=U;
return aw;
}
}
function ArrayOf(...args){
var r=args.length;
var s=this;
var q=%IsConstructor(s)?new s(r):[];
for(var y=0;y<r;y++){
%CreateDataProperty(q,y,args[y]);
}
q.length=r;
return q;
}
function ArraySpecies(){
return this;
}
%AddNamedProperty(f.prototype,"constructor",f,
2);
var bE={
__proto__:null,
copyWithin:true,
entries:true,
fill:true,
find:true,
findIndex:true,
includes:true,
keys:true,
};
%AddNamedProperty(f.prototype,o,bE,
2|1);
%FunctionSetLength(ArrayFrom,1);
b.InstallFunctions(f,2,[
"from",ArrayFrom,
"of",ArrayOf
]);
var bF=%SpecialArrayFunctions();
var bG=function(bH,bI,R){
var bk=bI;
if(bF.hasOwnProperty(bH)){
bk=bF[bH];
}
if(!(R===(void 0))){
%FunctionSetLength(bk,R);
}
return bk;
};
b.InstallFunctions(f.prototype,2,[
"toString",bG("toString",ArrayToString),
"toLocaleString",bG("toLocaleString",ArrayToLocaleString),
"join",bG("join",ArrayJoin),
"pop",bG("pop",ArrayPop),
"push",bG("push",ArrayPush,1),
"reverse",bG("reverse",ArrayReverse),
"shift",bG("shift",ArrayShift),
"unshift",bG("unshift",ArrayUnshift,1),
"slice",bG("slice",ArraySlice,2),
"splice",bG("splice",ArraySplice,2),
"sort",bG("sort",ArraySort),
"filter",bG("filter",ArrayFilter,1),
"forEach",bG("forEach",ArrayForEach,1),
"some",bG("some",ArraySome,1),
"every",bG("every",ArrayEvery,1),
"map",bG("map",ArrayMap,1),
"indexOf",bG("indexOf",null,1),
"lastIndexOf",bG("lastIndexOf",ArrayLastIndexOf,1),
"reduce",bG("reduce",ArrayReduce,1),
"reduceRight",bG("reduceRight",ArrayReduceRight,1),
"copyWithin",bG("copyWithin",ArrayCopyWithin,2),
"find",bG("find",ArrayFind,1),
"findIndex",bG("findIndex",ArrayFindIndex,1),
"fill",bG("fill",ArrayFill,1),
"includes",bG("includes",null,1)
]);
b.InstallGetter(f,n,ArraySpecies);
%FinishArrayPrototypeSetup(f.prototype);
b.SetUpLockedPrototype(g,f(),[
"indexOf",bG("indexOf",null),
"join",bG("join",ArrayJoin),
"pop",bG("pop",ArrayPop),
"push",bG("push",ArrayPush),
"shift",bG("shift",ArrayShift),
"sort",bG("sort",ArraySort),
"splice",bG("splice",ArraySplice)
]);
b.SetUpLockedPrototype(h,f(),[
"join",bG("join",ArrayJoin),
"pop",bG("pop",ArrayPop),
"push",bG("push",ArrayPush),
"shift",bG("shift",ArrayShift)
]);
b.SetUpLockedPrototype(c.InternalPackedArray,f(),[
"push",bG("push",ArrayPush),
"pop",bG("pop",ArrayPop),
"shift",bG("shift",ArrayShift),
"unshift",bG("unshift",ArrayUnshift),
"splice",bG("splice",ArraySplice),
"slice",bG("slice",ArraySlice)
]);
b.Export(function(aF){
aF.ArrayFrom=ArrayFrom;
aF.ArrayJoin=ArrayJoin;
aF.ArrayPush=ArrayPush;
aF.ArrayToString=ArrayToString;
aF.InnerArrayCopyWithin=InnerArrayCopyWithin;
aF.InnerArrayEvery=InnerArrayEvery;
aF.InnerArrayFill=InnerArrayFill;
aF.InnerArrayFilter=InnerArrayFilter;
aF.InnerArrayFind=InnerArrayFind;
aF.InnerArrayFindIndex=InnerArrayFindIndex;
aF.InnerArrayForEach=InnerArrayForEach;
aF.InnerArrayJoin=InnerArrayJoin;
aF.InnerArrayLastIndexOf=InnerArrayLastIndexOf;
aF.InnerArrayReduce=InnerArrayReduce;
aF.InnerArrayReduceRight=InnerArrayReduceRight;
aF.InnerArraySome=InnerArraySome;
aF.InnerArraySort=InnerArraySort;
aF.InnerArrayToLocaleString=InnerArrayToLocaleString;
aF.PackedArrayReverse=PackedArrayReverse;
});
%InstallToContext([
"array_pop",ArrayPop,
"array_push",ArrayPush,
"array_shift",ArrayShift,
"array_splice",ArraySplice,
"array_slice",ArraySlice,
"array_unshift",ArrayUnshift,
]);
});

string—√
(function(a,b){
%CheckIsBootstrapping();
var c;
var d=a.RegExp;
var e=a.String;
var f;
var g;
var h;
var i;
var j=b.ImportNow("match_symbol");
var k=b.ImportNow("replace_symbol");
var l=b.ImportNow("search_symbol");
var m=b.ImportNow("split_symbol");
b.Import(function(n){
c=n.ArrayJoin;
f=n.IsRegExp;
g=n.MaxSimple;
h=n.MinSimple;
i=n.RegExpInitialize;
});
function StringConcat(o){
"use strict";
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.concat");
var p=(%_ToString(this));
var q=arguments.length;
for(var r=0;r<q;++r){
p=p+(%_ToString(arguments[r]));
}
return p;
}
function StringIndexOf(s,t){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.indexOf");
var u=(%_ToString(this));
s=(%_ToString(s));
var v=(%_ToInteger(t));
if(v<0)v=0;
if(v>u.length)v=u.length;
return %StringIndexOf(u,s,v);
}
%FunctionSetLength(StringIndexOf,1);
function StringLastIndexOf(w,x){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.lastIndexOf");
var y=(%_ToString(this));
var z=y.length;
var w=(%_ToString(w));
var A=w.length;
var v=z-A;
var t=(%_ToNumber(x));
if(!(!%_IsSmi(%IS_VAR(t))&&!(t==t))){
t=(%_ToInteger(t));
if(t<0){
t=0;
}
if(t+A<z){
v=t;
}
}
if(v<0){
return-1;
}
return %StringLastIndexOf(y,w,v);
}
%FunctionSetLength(StringLastIndexOf,1);
function StringLocaleCompareJS(o){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.localeCompare");
return %StringLocaleCompare((%_ToString(this)),(%_ToString(o)));
}
function StringMatchJS(s){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.match");
if(!(s==null)){
var B=s[j];
if(!(B===(void 0))){
return %_Call(B,s,this);
}
}
var u=(%_ToString(this));
var C=%_NewObject(d,d);
i(C,s);
return C[j](u);
}
function StringNormalize(D){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.normalize");
var p=(%_ToString(this));
var E=(D===(void 0))?'NFC':(%_ToString(D));
var F=['NFC','NFD','NFKC','NFKD'];
var G=%ArrayIndexOf(F,E,0);
if(G===-1){
throw %make_range_error(175,
%_Call(c,F,', '));
}
return p;
}
%FunctionSetLength(StringNormalize,0);
var H=[2,"","",-1,-1];
function StringReplace(I,J){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.replace");
if(!(I==null)){
var K=I[k];
if(!(K===(void 0))){
return %_Call(K,I,this,J);
}
}
var u=(%_ToString(this));
I=(%_ToString(I));
if(I.length==1&&
u.length>0xFF&&
(typeof(J)==='string')&&
%StringIndexOf(J,'$',0)<0){
return %StringReplaceOneCharWithString(u,I,J);
}
var L=%StringIndexOf(u,I,0);
if(L<0)return u;
var M=L+I.length;
var N=%_SubString(u,0,L);
if((typeof(J)==='function')){
N+=J(I,L,u);
}else{
H[3]=L;
H[4]=M;
N=ExpandReplacement((%_ToString(J)),
u,
H,
N);
}
return N+%_SubString(u,M,u.length);
}
function ExpandReplacement(O,u,P,N){
var Q=O.length;
var R=%StringIndexOf(O,'$',0);
if(R<0){
if(Q>0)N+=O;
return N;
}
if(R>0)N+=%_SubString(O,0,R);
while(true){
var S='$';
var t=R+1;
if(t<Q){
var T=%_StringCharCodeAt(O,t);
if(T==36){
++t;
N+='$';
}else if(T==38){
++t;
N+=
%_SubString(u,P[3],P[4]);
}else if(T==96){
++t;
N+=%_SubString(u,0,P[3]);
}else if(T==39){
++t;
N+=%_SubString(u,P[4],u.length);
}else if(T>=48&&T<=57){
var U=(T-48)<<1;
var V=1;
var W=((P)[0]);
if(t+1<O.length){
var R=%_StringCharCodeAt(O,t+1);
if(R>=48&&R<=57){
var X=U*10+((R-48)<<1);
if(X<W){
U=X;
V=2;
}
}
}
if(U!=0&&U<W){
var L=P[(3+(U))];
if(L>=0){
N+=
%_SubString(u,L,P[(3+(U+1))]);
}
t+=V;
}else{
N+='$';
}
}else{
N+='$';
}
}else{
N+='$';
}
R=%StringIndexOf(O,'$',t);
if(R<0){
if(t<Q){
N+=%_SubString(O,t,Q);
}
return N;
}
if(R>t){
N+=%_SubString(O,t,R);
}
}
return N;
}
function StringSearch(s){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.search");
if(!(s==null)){
var Y=s[l];
if(!(Y===(void 0))){
return %_Call(Y,s,this);
}
}
var u=(%_ToString(this));
var C=%_NewObject(d,d);
i(C,s);
return %_Call(C[l],C,u);
}
function StringSlice(L,M){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.slice");
var p=(%_ToString(this));
var Z=p.length;
var aa=(%_ToInteger(L));
var ab=Z;
if(!(M===(void 0))){
ab=(%_ToInteger(M));
}
if(aa<0){
aa+=Z;
if(aa<0){
aa=0;
}
}else{
if(aa>Z){
return'';
}
}
if(ab<0){
ab+=Z;
if(ab<0){
return'';
}
}else{
if(ab>Z){
ab=Z;
}
}
if(ab<=aa){
return'';
}
return %_SubString(p,aa,ab);
}
function StringSplitJS(ac,ad){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.split");
if(!(ac==null)){
var ae=ac[m];
if(!(ae===(void 0))){
return %_Call(ae,ac,this,ad);
}
}
var u=(%_ToString(this));
ad=((ad===(void 0)))?4294967295:((ad)>>>0);
var Q=u.length;
var af=(%_ToString(ac));
if(ad===0)return[];
if((ac===(void 0)))return[u];
var ag=af.length;
if(ag===0)return %StringToArray(u,ad);
return %StringSplit(u,af,ad);
}
function StringSubstring(L,M){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.subString");
var p=(%_ToString(this));
var Z=p.length;
var aa=(%_ToInteger(L));
if(aa<0){
aa=0;
}else if(aa>Z){
aa=Z;
}
var ab=Z;
if(!(M===(void 0))){
ab=(%_ToInteger(M));
if(ab>Z){
ab=Z;
}else{
if(ab<0)ab=0;
if(aa>ab){
var ah=ab;
ab=aa;
aa=ah;
}
}
}
return %_SubString(p,aa,ab);
}
function StringSubstr(L,Q){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.substr");
var p=(%_ToString(this));
var ai=p.length;
L=(%_ToInteger(L));
Q=(Q===(void 0))?ai:(%_ToInteger(Q));
if(L<0)L=g(ai+L,0);
Q=h(g(Q,0),ai-L);
if(Q<=0)return'';
return %_SubString(p,L,L+Q);
}
function StringToLowerCaseJS(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLowerCase");
return %StringToLowerCase((%_ToString(this)));
}
function StringToLocaleLowerCase(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLocaleLowerCase");
return %StringToLowerCase((%_ToString(this)));
}
function StringToUpperCaseJS(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toUpperCase");
return %StringToUpperCase((%_ToString(this)));
}
function StringToLocaleUpperCase(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLocaleUpperCase");
return %StringToUpperCase((%_ToString(this)));
}
function HtmlEscape(aj){
return %_Call(StringReplace,(%_ToString(aj)),/"/g,"&quot;");
}
function StringAnchor(ak){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.anchor");
return"<a name=\""+HtmlEscape(ak)+"\">"+(%_ToString(this))+
"</a>";
}
function StringBig(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.big");
return"<big>"+(%_ToString(this))+"</big>";
}
function StringBlink(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.blink");
return"<blink>"+(%_ToString(this))+"</blink>";
}
function StringBold(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.bold");
return"<b>"+(%_ToString(this))+"</b>";
}
function StringFixed(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.fixed");
return"<tt>"+(%_ToString(this))+"</tt>";
}
function StringFontcolor(al){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.fontcolor");
return"<font color=\""+HtmlEscape(al)+"\">"+(%_ToString(this))+
"</font>";
}
function StringFontsize(ai){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.fontsize");
return"<font size=\""+HtmlEscape(ai)+"\">"+(%_ToString(this))+
"</font>";
}
function StringItalics(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.italics");
return"<i>"+(%_ToString(this))+"</i>";
}
function StringLink(p){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.link");
return"<a href=\""+HtmlEscape(p)+"\">"+(%_ToString(this))+"</a>";
}
function StringSmall(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.small");
return"<small>"+(%_ToString(this))+"</small>";
}
function StringStrike(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.strike");
return"<strike>"+(%_ToString(this))+"</strike>";
}
function StringSub(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.sub");
return"<sub>"+(%_ToString(this))+"</sub>";
}
function StringSup(){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.sup");
return"<sup>"+(%_ToString(this))+"</sup>";
}
function StringRepeat(am){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.repeat");
var p=(%_ToString(this));
var an=(%_ToInteger(am));
if(an<0||an===(1/0))throw %make_range_error(157);
if(p.length===0)return"";
if(an>%_MaxSmi())throw %make_range_error(157);
var ao="";
while(true){
if(an&1)ao+=p;
an>>=1;
if(an===0)return ao;
p+=p;
}
}
function StringStartsWith(ap,t){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.startsWith");
var p=(%_ToString(this));
if(f(ap)){
throw %make_type_error(39,"String.prototype.startsWith");
}
var aq=(%_ToString(ap));
var x=(%_ToInteger(t));
var Z=p.length;
var L=h(g(x,0),Z);
var ar=aq.length;
if(ar+L>Z){
return false;
}
return %_SubString(p,L,L+ar)===aq;
}
%FunctionSetLength(StringStartsWith,1);
function StringEndsWith(ap,t){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.endsWith");
var p=(%_ToString(this));
if(f(ap)){
throw %make_type_error(39,"String.prototype.endsWith");
}
var aq=(%_ToString(ap));
var Z=p.length;
var x=!(t===(void 0))?(%_ToInteger(t)):Z
var M=h(g(x,0),Z);
var ar=aq.length;
var L=M-ar;
if(L<0){
return false;
}
return %_SubString(p,L,L+ar)===aq;
}
%FunctionSetLength(StringEndsWith,1);
function StringIncludes(ap,t){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.includes");
var O=(%_ToString(this));
if(f(ap)){
throw %make_type_error(39,"String.prototype.includes");
}
ap=(%_ToString(ap));
var x=(%_ToInteger(t));
var as=O.length;
if(x<0)x=0;
if(x>as)x=as;
var at=ap.length;
if(at+x>as){
return false;
}
return %StringIndexOf(O,ap,x)!==-1;
}
%FunctionSetLength(StringIncludes,1);
function StringCodePointAt(x){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.codePointAt");
var O=(%_ToString(this));
var ai=O.length;
x=(%_ToInteger(x));
if(x<0||x>=ai){
return(void 0);
}
var au=%_StringCharCodeAt(O,x);
if(au<0xD800||au>0xDBFF||x+1==ai){
return au;
}
var av=%_StringCharCodeAt(O,x+1);
if(av<0xDC00||av>0xDFFF){
return au;
}
return(au-0xD800)*0x400+av+0x2400;
}
function StringRaw(aw){
"use strict";
var ax=arguments.length;
var ay=(%_ToObject(aw));
var az=(%_ToObject(ay.raw));
var aA=(%_ToLength(az.length));
if(aA<=0)return"";
var N=(%_ToString(az[0]));
for(var r=1;r<aA;++r){
if(r<ax){
N+=(%_ToString(arguments[r]));
}
N+=(%_ToString(az[r]));
}
return N;
}
b.InstallFunctions(e,2,[
"raw",StringRaw
]);
b.InstallFunctions(e.prototype,2,[
"codePointAt",StringCodePointAt,
"concat",StringConcat,
"endsWith",StringEndsWith,
"includes",StringIncludes,
"indexOf",StringIndexOf,
"lastIndexOf",StringLastIndexOf,
"localeCompare",StringLocaleCompareJS,
"match",StringMatchJS,
"normalize",StringNormalize,
"repeat",StringRepeat,
"replace",StringReplace,
"search",StringSearch,
"slice",StringSlice,
"split",StringSplitJS,
"substring",StringSubstring,
"substr",StringSubstr,
"startsWith",StringStartsWith,
"toLowerCase",StringToLowerCaseJS,
"toLocaleLowerCase",StringToLocaleLowerCase,
"toUpperCase",StringToUpperCaseJS,
"toLocaleUpperCase",StringToLocaleUpperCase,
"link",StringLink,
"anchor",StringAnchor,
"fontcolor",StringFontcolor,
"fontsize",StringFontsize,
"big",StringBig,
"blink",StringBlink,
"bold",StringBold,
"fixed",StringFixed,
"italics",StringItalics,
"small",StringSmall,
"strike",StringStrike,
"sub",StringSub,
"sup",StringSup
]);
b.Export(function(aB){
aB.ExpandReplacement=ExpandReplacement;
aB.StringIndexOf=StringIndexOf;
aB.StringLastIndexOf=StringLastIndexOf;
aB.StringMatch=StringMatchJS;
aB.StringReplace=StringReplace;
aB.StringSlice=StringSlice;
aB.StringSplit=StringSplitJS;
aB.StringSubstr=StringSubstr;
aB.StringSubstring=StringSubstring;
});
})

mathï
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Math;
var d=%GetRootNaN();
var e=0;
var f=(void 0);
var g=b.ImportNow("to_string_tag_symbol");
function MathRandom(){
if(e<=2){
f=%GenerateRandomNumbers(f);
if(%_IsTypedArray(f)){
e=%_TypedArrayGetLength(f);
}else{
e=f.length;
}
}
return f[--e];
}
%AddNamedProperty(c,g,"Math",1|2);
b.InstallFunctions(c,2,[
"random",MathRandom,
]);
%SetForceInlineFlag(MathRandom);
b.Export(function(h){
h.MathRandom=MathRandom;
});
})

regexpŒ
(function(a,b){
%CheckIsBootstrapping();
var c;
var d=a.Array;
var e=a.Object;
var f=a.RegExp;
var g;
var h=b.InternalArray;
var i=b.InternalPackedArray;
var j;
var k;
var l=b.ImportNow("match_symbol");
var m=b.ImportNow("replace_symbol");
var n=b.ImportNow("search_symbol");
var o=b.ImportNow("species_symbol");
var p=b.ImportNow("split_symbol");
var q;
b.Import(function(r){
c=r.ExpandReplacement;
j=r.MaxSimple;
k=r.MinSimple;
q=r.SpeciesConstructor;
});
var s={
0:2,
1:"",
2:(void 0),
3:0,
4:0
};
function IsRegExp(t){
if(!(%_IsJSReceiver(t)))return false;
var u=t[l];
if(!(u===(void 0)))return(!!(u));
return(%_IsRegExp(t));
}
function RegExpInitialize(v,w,x){
w=(w===(void 0))?'':(%_ToString(w));
x=(x===(void 0))?'':(%_ToString(x));
%RegExpInitializeAndCompile(v,w,x);
return v;
}
function PatternFlags(w){
return((%_RegExpFlags(w)&1)?'g':'')+
((%_RegExpFlags(w)&2)?'i':'')+
((%_RegExpFlags(w)&4)?'m':'')+
((%_RegExpFlags(w)&16)?'u':'')+
((%_RegExpFlags(w)&8)?'y':'');
}
function RegExpConstructor(w,x){
var y=new.target;
var z=IsRegExp(w);
if((y===(void 0))){
y=f;
if(z&&(x===(void 0))&&
w.constructor===y){
return w;
}
}
if((%_IsRegExp(w))){
if((x===(void 0)))x=PatternFlags(w);
w=(%_RegExpSource(w));
}else if(z){
var A=w;
w=w.source;
if((x===(void 0)))x=A.flags;
}
var v=%_NewObject(f,y);
return RegExpInitialize(v,w,x);
}
function RegExpCompileJS(w,x){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
"RegExp.prototype.compile",this);
}
if((%_IsRegExp(w))){
if(!(x===(void 0)))throw %make_type_error(122);
x=PatternFlags(w);
w=(%_RegExpSource(w));
}
RegExpInitialize(this,w,x);
}
function DoRegExpExec(B,C,D){
return %_RegExpExec(B,C,D,s);
}
function RegExpExecNoTests(B,C,E){
var F=%_RegExpExec(B,C,E,s);
if(F!==null){
if((%_RegExpFlags(B)&8))B.lastIndex=F[4];
var G=((F)[0])>>1;
var E=F[3];
var H=F[4];
var I=%_SubString(C,E,H);
var J=%_RegExpConstructResult(G,E,C);
J[0]=I;
if(G==1)return J;
var K=3+2;
for(var L=1;L<G;L++){
E=F[K++];
if(E!=-1){
H=F[K];
J[L]=%_SubString(C,E,H);
}
K++;
}
return J;
;
}
B.lastIndex=0;
return null;
}
function RegExpSubclassExecJS(C){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
'RegExp.prototype.exec',this);
}
C=(%_ToString(C));
var M=this.lastIndex;
var L=(%_ToLength(M));
var a=(!!((%_RegExpFlags(this)&1)));
var N=(!!((%_RegExpFlags(this)&8)));
var O=a||N;
if(O){
if(L>C.length){
this.lastIndex=0;
return null;
}
}else{
L=0;
}
var P=%_RegExpExec(this,C,L,s);
if((P===null)){
this.lastIndex=0;
return null;
}
if(O){
this.lastIndex=s[4];
}
var G=((P)[0])>>1;
var E=P[3];
var H=P[4];
var I=%_SubString(C,E,H);
var J=%_RegExpConstructResult(G,E,C);
J[0]=I;
if(G==1)return J;
var K=3+2;
for(var L=1;L<G;L++){
E=P[K++];
if(E!=-1){
H=P[K];
J[L]=%_SubString(C,E,H);
}
K++;
}
return J;
;
}
%FunctionRemovePrototype(RegExpSubclassExecJS);
function RegExpExecJS(C){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
'RegExp.prototype.exec',this);
}
C=(%_ToString(C));
var M=this.lastIndex;
var L=(%_ToLength(M));
var O=(%_RegExpFlags(this)&1)||(%_RegExpFlags(this)&8);
if(O){
if(L<0||L>C.length){
this.lastIndex=0;
return null;
}
}else{
L=0;
}
var P=%_RegExpExec(this,C,L,s);
if((P===null)){
this.lastIndex=0;
return null;
}
if(O){
this.lastIndex=s[4];
}
var G=((P)[0])>>1;
var E=P[3];
var H=P[4];
var I=%_SubString(C,E,H);
var J=%_RegExpConstructResult(G,E,C);
J[0]=I;
if(G==1)return J;
var K=3+2;
for(var L=1;L<G;L++){
E=P[K++];
if(E!=-1){
H=P[K];
J[L]=%_SubString(C,E,H);
}
K++;
}
return J;
;
}
function RegExpSubclassExec(B,C,Q){
if((Q===(void 0))){
Q=B.exec;
}
if((typeof(Q)==='function')){
var J=%_Call(Q,B,C);
if(!(%_IsJSReceiver(J))&&!(J===null)){
throw %make_type_error(48);
}
return J;
}
return %_Call(RegExpExecJS,B,C);
}
%SetForceInlineFlag(RegExpSubclassExec);
var R;
var S;
function RegExpTest(C){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
'RegExp.prototype.test',this);
}
C=(%_ToString(C));
var M=this.lastIndex;
var L=(%_ToLength(M));
if((%_RegExpFlags(this)&1)||(%_RegExpFlags(this)&8)){
if(L<0||L>C.length){
this.lastIndex=0;
return false;
}
var P=%_RegExpExec(this,C,L,s);
if((P===null)){
this.lastIndex=0;
return false;
}
this.lastIndex=s[4];
return true;
}else{
var B=this;
var T=(%_RegExpSource(B));
if(T.length>=3&&
%_StringCharCodeAt(T,0)==46&&
%_StringCharCodeAt(T,1)==42&&
%_StringCharCodeAt(T,2)!=63){
B=TrimRegExp(B);
}
var P=%_RegExpExec(B,C,0,s);
if((P===null)){
this.lastIndex=0;
return false;
}
return true;
}
}
function RegExpSubclassTest(C){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(44,
'RegExp.prototype.test',this);
}
C=(%_ToString(C));
var U=RegExpSubclassExec(this,C);
return!(U===null);
}
%FunctionRemovePrototype(RegExpSubclassTest);
function TrimRegExp(B){
if(R!==B){
R=B;
S=
new f(
%_SubString((%_RegExpSource(B)),2,(%_RegExpSource(B)).length),
((%_RegExpFlags(B)&2)?(%_RegExpFlags(B)&4)?"im":"i"
:(%_RegExpFlags(B)&4)?"m":""));
}
return S;
}
function RegExpToString(){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(
44,'RegExp.prototype.toString',this);
}
if(this===g){
%IncrementUseCounter(12);
}
return'/'+(%_ToString(this.source))+'/'+(%_ToString(this.flags));
}
function AtSurrogatePair(V,D){
if(D+1>=V.length)return false;
var I=%_StringCharCodeAt(V,D);
if(I<0xD800||I>0xDBFF)return false;
var W=%_StringCharCodeAt(V,D+1);
return W>=0xDC00||W<=0xDFFF;
}
function RegExpSplit(C,X){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
"RegExp.prototype.@@split",this);
}
var Y=this;
var V=(%_ToString(C));
X=((X===(void 0)))?4294967295:((X)>>>0);
var Z=V.length;
if(X===0)return[];
if(Z===0){
if(DoRegExpExec(Y,V,0,0)!==null)return[];
return[V];
}
var aa=0;
var ab=0;
var ac=0;
var J=new h();
outer_loop:
while(true){
if(ab===Z){
J[J.length]=%_SubString(V,aa,Z);
break;
}
var F=DoRegExpExec(Y,V,ab);
if(F===null||Z===(ac=F[3])){
J[J.length]=%_SubString(V,aa,Z);
break;
}
var ad=F[4];
if(ab===ad&&ad===aa){
if((%_RegExpFlags(this)&16)&&AtSurrogatePair(V,ab)){
ab+=2;
}else{
ab++;
}
continue;
}
J[J.length]=%_SubString(V,aa,ac);
if(J.length===X)break;
var ae=((F)[0])+3;
for(var L=3+2;L<ae;){
var E=F[L++];
var H=F[L++];
if(H!=-1){
J[J.length]=%_SubString(V,E,H);
}else{
J[J.length]=(void 0);
}
if(J.length===X)break outer_loop;
}
ab=aa=ad;
}
var af=[];
%MoveArrayContents(J,af);
return af;
}
function RegExpSubclassSplit(C,X){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(44,
"RegExp.prototype.@@split",this);
}
C=(%_ToString(C));
var ag=q(this,f);
var x=(%_ToString(this.flags));
var Q;
if((%_IsRegExp(this))&&ag===f){
Q=this.exec;
if(Q===RegExpSubclassExecJS){
return %_Call(RegExpSplit,this,C,X);
}
}
var ah=%StringIndexOf(x,'u',0)>=0;
var N=%StringIndexOf(x,'y',0)>=0;
var ai=N?x:x+"y";
var aj=new ag(this,ai);
var ak=new d();
var al=0;
var am=((X===(void 0)))?4294967295:((X)>>>0);
var an=C.length;
var ao=0;
if(am===0)return ak;
var J;
if(an===0){
J=RegExpSubclassExec(aj,C);
if((J===null))%AddElement(ak,0,C);
return ak;
}
var ap=ao;
while(ap<an){
aj.lastIndex=ap;
J=RegExpSubclassExec(aj,C,Q);
Q=(void 0);
if((J===null)){
ap+=AdvanceStringIndex(C,ap,ah);
}else{
var H=k((%_ToLength(aj.lastIndex)),an);
if(H===ao){
ap+=AdvanceStringIndex(C,ap,ah);
}else{
%AddElement(
ak,al,
%_SubString(C,ao,ap));
al++;
if(al===am)return ak;
ao=H;
var aq=j((%_ToLength(J.length)),0);
for(var L=1;L<aq;L++){
%AddElement(ak,al,J[L]);
al++;
if(al===am)return ak;
}
ap=ao;
}
}
}
%AddElement(ak,al,
%_SubString(C,ao,an));
return ak;
}
%FunctionRemovePrototype(RegExpSubclassSplit);
function RegExpSubclassMatch(C){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(44,
"RegExp.prototype.@@match",this);
}
C=(%_ToString(C));
var a=this.global;
if(!a)return RegExpSubclassExec(this,C);
var ah=this.unicode;
this.lastIndex=0;
var ak=new h();
var ar=0;
var J;
while(true){
J=RegExpSubclassExec(this,C);
if((J===null)){
if(ar===0)return null;
break;
}
var as=(%_ToString(J[0]));
ak[ar]=as;
if(as==="")SetAdvancedStringIndex(this,C,ah);
ar++;
}
var at=[];
%MoveArrayContents(ak,at);
return at;
}
%FunctionRemovePrototype(RegExpSubclassMatch);
var au=new h(4);
function StringReplaceGlobalRegExpWithFunction(V,B,av){
var at=au;
if(at){
au=null;
}else{
at=new h(16);
}
var aw=%RegExpExecMultiple(B,
V,
s,
at);
B.lastIndex=0;
if((aw===null)){
au=at;
return V;
}
var ax=aw.length;
if(((s)[0])==2){
var ay=0;
for(var L=0;L<ax;L++){
var az=aw[L];
if(%_IsSmi(az)){
if(az>0){
ay=(az>>11)+(az&0x7ff);
}else{
ay=aw[++L]-az;
}
}else{
var aA=av(az,ay,V);
aw[L]=(%_ToString(aA));
ay+=az.length;
}
}
}else{
for(var L=0;L<ax;L++){
var az=aw[L];
if(!%_IsSmi(az)){
var aA=%reflect_apply(av,(void 0),az);
aw[L]=(%_ToString(aA));
}
}
}
var J=%StringBuilderConcat(aw,ax,V);
at.length=0;
au=at;
return J;
}
function CaptureString(C,aB,D){
var aC=D<<1;
var E=aB[(3+(aC))];
if(E<0)return;
var H=aB[(3+(aC+1))];
return %_SubString(C,E,H);
}
function StringReplaceNonGlobalRegExpWithFunction(V,B,av){
var F=DoRegExpExec(B,V,0);
if((F===null)){
B.lastIndex=0;
return V;
}
var D=F[3];
var J=%_SubString(V,0,D);
var aD=F[4];
var aE=((F)[0])>>1;
var aF;
if(aE==1){
var aG=%_SubString(V,D,aD);
aF=av(aG,D,V);
}else{
var aH=new h(aE+2);
for(var K=0;K<aE;K++){
aH[K]=CaptureString(V,F,K);
}
aH[K]=D;
aH[K+1]=V;
aF=%reflect_apply(av,(void 0),aH);
}
J+=aF;
return J+%_SubString(V,aD,V.length);
}
function RegExpReplace(C,av){
if(!(%_IsRegExp(this))){
throw %make_type_error(44,
"RegExp.prototype.@@replace",this);
}
var V=(%_ToString(C));
var aI=this;
if(!(typeof(av)==='function')){
av=(%_ToString(av));
if(!(%_RegExpFlags(aI)&1)){
var U=DoRegExpExec(aI,V,0);
if(U==null){
aI.lastIndex=0
return V;
}
if(av.length==0){
return %_SubString(V,0,U[3])+
%_SubString(V,U[4],V.length)
}
return c(av,V,s,
%_SubString(V,0,U[3]))+
%_SubString(V,U[4],V.length);
}
aI.lastIndex=0;
return %StringReplaceGlobalRegExpWithString(
V,aI,av,s);
}
if((%_RegExpFlags(aI)&1)){
return StringReplaceGlobalRegExpWithFunction(V,aI,av);
}
return StringReplaceNonGlobalRegExpWithFunction(V,aI,av);
}
function GetSubstitution(aJ,C,aK,aL,aF){
var aM=aJ.length;
var aN=C.length;
var aO=aL.length;
var aP=aK+aM;
var J="";
var aQ,aR,aS,aT,aU,aV,aW;
var aT=%StringIndexOf(aF,'$',0);
if(aT<0){
J+=aF;
return J;
}
if(aT>0)J+=%_SubString(aF,0,aT);
while(true){
aR='$';
aQ=aT+1;
if(aQ<aF.length){
aS=%_StringCharCodeAt(aF,aQ);
if(aS==36){
++aQ;
J+='$';
}else if(aS==38){
++aQ;
J+=aJ;
}else if(aS==96){
++aQ;
J+=%_SubString(C,0,aK);
}else if(aS==39){
++aQ;
J+=%_SubString(C,aP,aN);
}else if(aS>=48&&aS<=57){
aU=(aS-48);
aV=1;
if(aQ+1<aF.length){
aT=%_StringCharCodeAt(aF,aQ+1);
if(aT>=48&&aT<=57){
aW=aU*10+((aT-48));
if(aW<aO){
aU=aW;
aV=2;
}
}
}
if(aU!=0&&aU<aO){
var aX=aL[aU];
if(!(aX===(void 0)))J+=aX;
aQ+=aV;
}else{
J+='$';
}
}else{
J+='$';
}
}else{
J+='$';
}
aT=%StringIndexOf(aF,'$',aQ);
if(aT<0){
if(aQ<aF.length){
J+=%_SubString(aF,aQ,aF.length);
}
return J;
}
if(aT>aQ){
J+=%_SubString(aF,aQ,aT);
}
}
return J;
}
function AdvanceStringIndex(C,D,ah){
var aY=1;
if(ah){
var I=%_StringCharCodeAt(C,D);
if(I>=0xD800&&I<=0xDBFF&&C.length>D+1){
var W=%_StringCharCodeAt(C,D+1);
if(W>=0xDC00&&W<=0xDFFF){
aY=2;
}
}
}
return aY;
}
function SetAdvancedStringIndex(B,C,ah){
var M=B.lastIndex;
B.lastIndex=M+
AdvanceStringIndex(C,M,ah);
}
function RegExpSubclassReplace(C,av){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(44,
"RegExp.prototype.@@replace",this);
}
C=(%_ToString(C));
var Z=C.length;
var aZ=(typeof(av)==='function');
if(!aZ)av=(%_ToString(av));
var a=(!!(this.global));
if(a){
var ah=(!!(this.unicode));
this.lastIndex=0;
}
var Q;
if((%_IsRegExp(this))){
Q=this.exec;
if(Q===RegExpSubclassExecJS){
return %_Call(RegExpReplace,this,C,av);
}
}
var ba=new h();
var J,aF;
while(true){
J=RegExpSubclassExec(this,C,Q);
Q=(void 0);
if((J===null)){
break;
}else{
ba.push(J);
if(!a)break;
var as=(%_ToString(J[0]));
if(as==="")SetAdvancedStringIndex(this,C,ah);
}
}
var bb="";
var bc=0;
for(var L=0;L<ba.length;L++){
J=ba[L];
var aO=j((%_ToLength(J.length)),0);
var aJ=(%_ToString(J[0]));
var bd=aJ.length;
var aK=j(k((%_ToInteger(J.index)),Z),0);
var aL=new h();
for(var ar=0;ar<aO;ar++){
var aX=J[ar];
if(!(aX===(void 0)))aX=(%_ToString(aX));
aL[ar]=aX;
}
if(aZ){
var aH=new h(aO+2);
for(var K=0;K<aO;K++){
aH[K]=aL[K];
}
aH[K]=aK;
aH[K+1]=C;
aF=%reflect_apply(av,(void 0),aH,0,
aH.length);
}else{
aF=GetSubstitution(aJ,C,aK,aL,
av);
}
if(aK>=bc){
bb+=
%_SubString(C,bc,aK)+aF;
bc=aK+bd;
}
}
if(bc>=Z)return bb;
return bb+%_SubString(C,bc,Z);
}
%FunctionRemovePrototype(RegExpSubclassReplace);
function RegExpSubclassSearch(C){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(44,
"RegExp.prototype.@@search",this);
}
C=(%_ToString(C));
var be=this.lastIndex;
this.lastIndex=0;
var J=RegExpSubclassExec(this,C);
this.lastIndex=be;
if((J===null))return-1;
return J.index;
}
%FunctionRemovePrototype(RegExpSubclassSearch);
function RegExpGetLastMatch(){
var bf=((s)[1]);
return %_SubString(bf,
s[3],
s[4]);
}
function RegExpGetLastParen(){
var Z=((s)[0]);
if(Z<=2)return'';
var bf=((s)[1]);
var E=s[(3+(Z-2))];
var H=s[(3+(Z-1))];
if(E!=-1&&H!=-1){
return %_SubString(bf,E,H);
}
return"";
}
function RegExpGetLeftContext(){
var bg;
var V;
bg=s[3];
V=((s)[1]);
return %_SubString(V,0,bg);
}
function RegExpGetRightContext(){
var bg;
var V;
bg=s[4];
V=((s)[1]);
return %_SubString(V,bg,V.length);
}
function RegExpMakeCaptureGetter(ar){
return function foo(){
var D=ar*2;
if(D>=((s)[0]))return'';
var bh=s[(3+(D))];
var bi=s[(3+(D+1))];
if(bh==-1||bi==-1)return'';
return %_SubString(((s)[1]),bh,bi);
};
}
function RegExpGetFlags(){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(
123,"RegExp.prototype.flags",(%_ToString(this)));
}
var J='';
if(this.global)J+='g';
if(this.ignoreCase)J+='i';
if(this.multiline)J+='m';
if(this.unicode)J+='u';
if(this.sticky)J+='y';
return J;
}
function RegExpGetGlobal(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(31);
return(void 0);
}
throw %make_type_error(124,"RegExp.prototype.global");
}
return(!!((%_RegExpFlags(this)&1)));
}
%SetForceInlineFlag(RegExpGetGlobal);
function RegExpGetIgnoreCase(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(31);
return(void 0);
}
throw %make_type_error(124,"RegExp.prototype.ignoreCase");
}
return(!!((%_RegExpFlags(this)&2)));
}
function RegExpGetMultiline(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(31);
return(void 0);
}
throw %make_type_error(124,"RegExp.prototype.multiline");
}
return(!!((%_RegExpFlags(this)&4)));
}
function RegExpGetSource(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(30);
return"(?:)";
}
throw %make_type_error(124,"RegExp.prototype.source");
}
return(%_RegExpSource(this));
}
function RegExpGetSticky(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(11);
return(void 0);
}
throw %make_type_error(124,"RegExp.prototype.sticky");
}
return(!!((%_RegExpFlags(this)&8)));
}
%SetForceInlineFlag(RegExpGetSticky);
function RegExpGetUnicode(){
if(!(%_IsRegExp(this))){
if(this===g){
%IncrementUseCounter(13);
return(void 0);
}
throw %make_type_error(124,"RegExp.prototype.unicode");
}
return(!!((%_RegExpFlags(this)&16)));
}
%SetForceInlineFlag(RegExpGetUnicode);
function RegExpSpecies(){
return this;
}
%FunctionSetInstanceClassName(f,'RegExp');
g=new e();
%FunctionSetPrototype(f,g);
%AddNamedProperty(
f.prototype,'constructor',f,2);
%SetCode(f,RegExpConstructor);
b.InstallGetter(f,o,RegExpSpecies);
b.InstallFunctions(f.prototype,2,[
"exec",RegExpSubclassExecJS,
"test",RegExpSubclassTest,
"toString",RegExpToString,
"compile",RegExpCompileJS,
l,RegExpSubclassMatch,
m,RegExpSubclassReplace,
n,RegExpSubclassSearch,
p,RegExpSubclassSplit,
]);
b.InstallGetter(f.prototype,'flags',RegExpGetFlags);
b.InstallGetter(f.prototype,'global',RegExpGetGlobal);
b.InstallGetter(f.prototype,'ignoreCase',RegExpGetIgnoreCase);
b.InstallGetter(f.prototype,'multiline',RegExpGetMultiline);
b.InstallGetter(f.prototype,'source',RegExpGetSource);
b.InstallGetter(f.prototype,'sticky',RegExpGetSticky);
b.InstallGetter(f.prototype,'unicode',RegExpGetUnicode);
var bj=function(){
var bk=((s)[2]);
return(bk===(void 0))?"":bk;
};
var bl=function(C){
((s)[2])=(%_ToString(C));
};
%OptimizeObjectForAddingMultipleProperties(f,22);
b.InstallGetterSetter(f,'input',bj,bl,
4);
b.InstallGetterSetter(f,'$_',bj,bl,
2|4);
var bm=function(bn){};
b.InstallGetterSetter(f,'lastMatch',RegExpGetLastMatch,
bm,4);
b.InstallGetterSetter(f,'$&',RegExpGetLastMatch,bm,
2|4);
b.InstallGetterSetter(f,'lastParen',RegExpGetLastParen,
bm,4);
b.InstallGetterSetter(f,'$+',RegExpGetLastParen,bm,
2|4);
b.InstallGetterSetter(f,'leftContext',RegExpGetLeftContext,
bm,4);
b.InstallGetterSetter(f,'$`',RegExpGetLeftContext,bm,
2|4);
b.InstallGetterSetter(f,'rightContext',RegExpGetRightContext,
bm,4);
b.InstallGetterSetter(f,"$'",RegExpGetRightContext,bm,
2|4);
for(var L=1;L<10;++L){
b.InstallGetterSetter(f,'$'+L,RegExpMakeCaptureGetter(L),
bm,4);
}
%ToFastProperties(f);
var bo={
0:2,
1:"",
2:(void 0),
3:0,
4:0
};
function InternalRegExpMatch(B,V){
var F=%_RegExpExec(B,V,0,bo);
if(!(F===null)){
var G=((F)[0])>>1;
var E=F[3];
var H=F[4];
var I=%_SubString(V,E,H);
var J=%_RegExpConstructResult(G,E,V);
J[0]=I;
if(G==1)return J;
var K=3+2;
for(var L=1;L<G;L++){
E=F[K++];
if(E!=-1){
H=F[K];
J[L]=%_SubString(V,E,H);
}
K++;
}
return J;
;
}
return null;
}
function InternalRegExpReplace(B,V,aF){
return %StringReplaceGlobalRegExpWithString(
V,B,aF,bo);
}
b.Export(function(bp){
bp.InternalRegExpMatch=InternalRegExpMatch;
bp.InternalRegExpReplace=InternalRegExpReplace;
bp.IsRegExp=IsRegExp;
bp.RegExpExec=DoRegExpExec;
bp.RegExpInitialize=RegExpInitialize;
bp.RegExpLastMatchInfo=s;
bp.RegExpTest=RegExpTest;
});
})

,arraybufferâ
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.ArrayBuffer;
var d;
var e;
var f;
var g=b.ImportNow("species_symbol");
b.Import(function(h){
d=h.MaxSimple;
e=h.MinSimple;
f=h.SpeciesConstructor;
});
function ArrayBufferSlice(i,j){
if(!(%_ClassOf(this)==='ArrayBuffer')){
throw %make_type_error(44,
'ArrayBuffer.prototype.slice',this);
}
var k=(%_ToInteger(i));
if(!(j===(void 0))){
j=(%_ToInteger(j));
}
var l;
var m=%_ArrayBufferGetByteLength(this);
if(k<0){
l=d(m+k,0);
}else{
l=e(k,m);
}
var n=(j===(void 0))?m:j;
var o;
if(n<0){
o=d(m+n,0);
}else{
o=e(n,m);
}
if(o<l){
o=l;
}
var p=o-l;
var q=f(this,c,true);
var r=new q(p);
if(!(%_ClassOf(r)==='ArrayBuffer')){
throw %make_type_error(44,
'ArrayBuffer.prototype.slice',r);
}
if(r===this){
throw %make_type_error(11);
}
if(%_ArrayBufferGetByteLength(r)<p){
throw %make_type_error(10);
}
%ArrayBufferSliceImpl(this,r,l,p);
return r;
}
function ArrayBufferSpecies(){
return this;
}
b.InstallGetter(c,g,ArrayBufferSpecies);
b.InstallFunctions(c.prototype,2,[
"slice",ArrayBufferSlice
]);
})

(typedarray2∫
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=b.ImportNow("ArrayToString");
var d;
var e;
var f;
var g=a.Array;
var h=a.ArrayBuffer;
var i=h.prototype;
var j=a.DataView;
var k=a.Object;
var l;
var m;
var n;
var o;
var p;
var q;
var r;
var s;
var t;
var u;
var v;
var w;
var x;
var y=b.InternalArray;
var z;
var A;
var B;
var C;
var D;
var E;
var F;
var G=b.ImportNow("iterator_symbol");
var H=b.ImportNow("species_symbol");
var I=b.ImportNow("to_string_tag_symbol");
var J=a.Uint8Array;

var K=a.Int8Array;

var L=a.Uint16Array;

var M=a.Int16Array;

var N=a.Uint32Array;

var O=a.Int32Array;

var P=a.Float32Array;

var Q=a.Float64Array;

var R=a.Uint8ClampedArray;


var S=%object_get_prototype_of(J);
b.Import(function(T){
d=T.ArrayValues;
e=T.GetIterator;
f=T.GetMethod;
l=T.InnerArrayCopyWithin;
m=T.InnerArrayEvery;
n=T.InnerArrayFill;
o=T.InnerArrayFilter;
p=T.InnerArrayFind;
q=T.InnerArrayFindIndex;
r=T.InnerArrayForEach;
s=T.InnerArrayJoin;
t=T.InnerArrayReduce;
u=T.InnerArrayReduceRight;
v=T.InnerArraySome;
w=T.InnerArraySort;
x=T.InnerArrayToLocaleString;
z=T.IsNaN;
A=T.MaxSimple;
B=T.MinSimple;
C=T.PackedArrayReverse;
D=T.SpeciesConstructor;
E=T.ToPositiveInteger;
F=T.ToIndex;
});
function TypedArrayDefaultConstructor(U){
switch(%_ClassOf(U)){
case"Uint8Array":
return J;

case"Int8Array":
return K;

case"Uint16Array":
return L;

case"Int16Array":
return M;

case"Uint32Array":
return N;

case"Int32Array":
return O;

case"Float32Array":
return P;

case"Float64Array":
return Q;

case"Uint8ClampedArray":
return R;


}
throw %make_type_error(44,
"TypedArrayDefaultConstructor",this);
}
function TypedArrayCreate(V,W,X,Y){
if((X===(void 0))){
var Z=new V(W);
}else{
var Z=new V(W,X,Y);
}
if(!(%_IsTypedArray(Z)))throw %make_type_error(72);
if((typeof(W)==='number')&&%_TypedArrayGetLength(Z)<W){
throw %make_type_error(249);
}
return Z;
}
function TypedArraySpeciesCreate(aa,W,X,Y,ab){
var ac=TypedArrayDefaultConstructor(aa);
var V=D(aa,ac,
ab);
return TypedArrayCreate(V,W,X,Y);
}
function Uint8ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 1!==0){
throw %make_range_error(168,
"start offset","Uint8Array",1);
}
}
var aj;
if((ag===(void 0))){
if(ah % 1!==0){
throw %make_range_error(168,
"byte length","Uint8Array",1);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Uint8Array",1);
}
}else{
aj=ag*1;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,1,ae,ai,aj,true);
}
function Uint8ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*1;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,1,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,1,null,0,al,true);
}
}
function Uint8ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*1;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,1,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,1,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Uint8ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Uint8ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Uint8ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*1;
Uint8ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Uint8ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Uint8ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Uint8ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Uint8ArrayConstructByArrayLike(this,X,X.length);
}else{
Uint8ArrayConstructByIterable(this,X,aq);
}
}else{
Uint8ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Uint8Array")
}
}
function Uint8ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*1;
return new J(%TypedArrayGetBuffer(this),aF,aE);
}

function Int8ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 1!==0){
throw %make_range_error(168,
"start offset","Int8Array",1);
}
}
var aj;
if((ag===(void 0))){
if(ah % 1!==0){
throw %make_range_error(168,
"byte length","Int8Array",1);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Int8Array",1);
}
}else{
aj=ag*1;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,2,ae,ai,aj,true);
}
function Int8ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*1;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,2,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,2,null,0,al,true);
}
}
function Int8ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*1;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,2,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,2,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Int8ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Int8ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Int8ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*1;
Int8ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Int8ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Int8ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Int8ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Int8ArrayConstructByArrayLike(this,X,X.length);
}else{
Int8ArrayConstructByIterable(this,X,aq);
}
}else{
Int8ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Int8Array")
}
}
function Int8ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*1;
return new K(%TypedArrayGetBuffer(this),aF,aE);
}

function Uint16ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 2!==0){
throw %make_range_error(168,
"start offset","Uint16Array",2);
}
}
var aj;
if((ag===(void 0))){
if(ah % 2!==0){
throw %make_range_error(168,
"byte length","Uint16Array",2);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Uint16Array",2);
}
}else{
aj=ag*2;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,3,ae,ai,aj,true);
}
function Uint16ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*2;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,3,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,3,null,0,al,true);
}
}
function Uint16ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*2;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,3,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,3,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Uint16ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Uint16ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Uint16ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*2;
Uint16ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Uint16ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Uint16ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Uint16ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Uint16ArrayConstructByArrayLike(this,X,X.length);
}else{
Uint16ArrayConstructByIterable(this,X,aq);
}
}else{
Uint16ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Uint16Array")
}
}
function Uint16ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*2;
return new L(%TypedArrayGetBuffer(this),aF,aE);
}

function Int16ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 2!==0){
throw %make_range_error(168,
"start offset","Int16Array",2);
}
}
var aj;
if((ag===(void 0))){
if(ah % 2!==0){
throw %make_range_error(168,
"byte length","Int16Array",2);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Int16Array",2);
}
}else{
aj=ag*2;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,4,ae,ai,aj,true);
}
function Int16ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*2;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,4,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,4,null,0,al,true);
}
}
function Int16ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*2;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,4,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,4,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Int16ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Int16ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Int16ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*2;
Int16ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Int16ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Int16ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Int16ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Int16ArrayConstructByArrayLike(this,X,X.length);
}else{
Int16ArrayConstructByIterable(this,X,aq);
}
}else{
Int16ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Int16Array")
}
}
function Int16ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*2;
return new M(%TypedArrayGetBuffer(this),aF,aE);
}

function Uint32ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 4!==0){
throw %make_range_error(168,
"start offset","Uint32Array",4);
}
}
var aj;
if((ag===(void 0))){
if(ah % 4!==0){
throw %make_range_error(168,
"byte length","Uint32Array",4);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Uint32Array",4);
}
}else{
aj=ag*4;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,5,ae,ai,aj,true);
}
function Uint32ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*4;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,5,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,5,null,0,al,true);
}
}
function Uint32ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*4;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,5,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,5,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Uint32ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Uint32ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Uint32ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*4;
Uint32ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Uint32ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Uint32ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Uint32ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Uint32ArrayConstructByArrayLike(this,X,X.length);
}else{
Uint32ArrayConstructByIterable(this,X,aq);
}
}else{
Uint32ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Uint32Array")
}
}
function Uint32ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*4;
return new N(%TypedArrayGetBuffer(this),aF,aE);
}

function Int32ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 4!==0){
throw %make_range_error(168,
"start offset","Int32Array",4);
}
}
var aj;
if((ag===(void 0))){
if(ah % 4!==0){
throw %make_range_error(168,
"byte length","Int32Array",4);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Int32Array",4);
}
}else{
aj=ag*4;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,6,ae,ai,aj,true);
}
function Int32ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*4;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,6,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,6,null,0,al,true);
}
}
function Int32ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*4;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,6,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,6,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Int32ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Int32ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Int32ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*4;
Int32ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Int32ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Int32ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Int32ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Int32ArrayConstructByArrayLike(this,X,X.length);
}else{
Int32ArrayConstructByIterable(this,X,aq);
}
}else{
Int32ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Int32Array")
}
}
function Int32ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*4;
return new O(%TypedArrayGetBuffer(this),aF,aE);
}

function Float32ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 4!==0){
throw %make_range_error(168,
"start offset","Float32Array",4);
}
}
var aj;
if((ag===(void 0))){
if(ah % 4!==0){
throw %make_range_error(168,
"byte length","Float32Array",4);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Float32Array",4);
}
}else{
aj=ag*4;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,7,ae,ai,aj,true);
}
function Float32ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*4;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,7,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,7,null,0,al,true);
}
}
function Float32ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*4;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,7,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,7,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Float32ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Float32ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Float32ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*4;
Float32ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Float32ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Float32ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Float32ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Float32ArrayConstructByArrayLike(this,X,X.length);
}else{
Float32ArrayConstructByIterable(this,X,aq);
}
}else{
Float32ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Float32Array")
}
}
function Float32ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*4;
return new P(%TypedArrayGetBuffer(this),aF,aE);
}

function Float64ArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 8!==0){
throw %make_range_error(168,
"start offset","Float64Array",8);
}
}
var aj;
if((ag===(void 0))){
if(ah % 8!==0){
throw %make_range_error(168,
"byte length","Float64Array",8);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Float64Array",8);
}
}else{
aj=ag*8;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,8,ae,ai,aj,true);
}
function Float64ArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*8;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,8,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,8,null,0,al,true);
}
}
function Float64ArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*8;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,8,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,8,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Float64ArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Float64ArrayConstructByArrayLike(ad,ar,ar.length);
}
function Float64ArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*8;
Float64ArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Float64ArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Float64ArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Float64ArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Float64ArrayConstructByArrayLike(this,X,X.length);
}else{
Float64ArrayConstructByIterable(this,X,aq);
}
}else{
Float64ArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Float64Array")
}
}
function Float64ArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*8;
return new Q(%TypedArrayGetBuffer(this),aF,aE);
}

function Uint8ClampedArrayConstructByArrayBuffer(ad,ae,af,ag){
if(!(af===(void 0))){
af=F(af,169);
}
if(!(ag===(void 0))){
ag=F(ag,169);
}
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var ah=%_ArrayBufferGetByteLength(ae);
var ai;
if((af===(void 0))){
ai=0;
}else{
ai=af;
if(ai % 1!==0){
throw %make_range_error(168,
"start offset","Uint8ClampedArray",1);
}
}
var aj;
if((ag===(void 0))){
if(ah % 1!==0){
throw %make_range_error(168,
"byte length","Uint8ClampedArray",1);
}
aj=ah-ai;
if(aj<0){
throw %make_range_error(168,
"byte length","Uint8ClampedArray",1);
}
}else{
aj=ag*1;
if(ai+aj>ah){
throw %make_range_error(169);
}
}
%_TypedArrayInitialize(ad,9,ae,ai,aj,true);
}
function Uint8ClampedArrayConstructByLength(ad,ag){
var ak=(ag===(void 0))?
0:F(ag,169);
if(ag>%_MaxSmi()){
throw %make_range_error(169);
}
var al=ak*1;
if(al>%_TypedArrayMaxSizeInHeap()){
var ae=new h(al);
%_TypedArrayInitialize(ad,9,ae,0,al,true);
}else{
%_TypedArrayInitialize(ad,9,null,0,al,true);
}
}
function Uint8ClampedArrayConstructByArrayLike(ad,am,ag){
var ak=E(ag,169);
if(ak>%_MaxSmi()){
throw %make_range_error(169);
}
var an=false;
var al=ak*1;
if(al<=%_TypedArrayMaxSizeInHeap()){
%_TypedArrayInitialize(ad,9,null,0,al,false);
}else{
an=
%TypedArrayInitializeFromArrayLike(ad,9,am,ak);
}
if(!an){
for(var ao=0;ao<ak;ao++){
ad[ao]=am[ao];
}
}
}
function Uint8ClampedArrayConstructByIterable(ad,ap,aq){
var ar=new y();
var as=%_Call(aq,ap);
var at={
__proto__:null
};
at[G]=function(){return as;}
for(var au of at){
ar.push(au);
}
Uint8ClampedArrayConstructByArrayLike(ad,ar,ar.length);
}
function Uint8ClampedArrayConstructByTypedArray(ad,U){
var av=%TypedArrayGetBuffer(U);
var ag=%_TypedArrayGetLength(U);
var al=%_ArrayBufferViewGetByteLength(U);
var aj=ag*1;
Uint8ClampedArrayConstructByArrayLike(ad,U,ag);
var aw=D(av,h);
var ax=aw.prototype;
if((%_IsJSReceiver(ax))&&ax!==i){
%InternalSetPrototype(%TypedArrayGetBuffer(ad),ax);
}
}
function Uint8ClampedArrayConstructor(X,Y,ay){
if(!(new.target===(void 0))){
if((%_ClassOf(X)==='ArrayBuffer')||(%_ClassOf(X)==='SharedArrayBuffer')){
Uint8ClampedArrayConstructByArrayBuffer(this,X,Y,ay);
}else if((%_IsTypedArray(X))){
Uint8ClampedArrayConstructByTypedArray(this,X);
}else if((%_IsJSReceiver(X))){
var aq=X[G];
if((aq===(void 0))||aq===d){
Uint8ClampedArrayConstructByArrayLike(this,X,X.length);
}else{
Uint8ClampedArrayConstructByIterable(this,X,aq);
}
}else{
Uint8ClampedArrayConstructByLength(this,X);
}
}else{
throw %make_type_error(27,"Uint8ClampedArray")
}
}
function Uint8ClampedArraySubArray(az,aA){
var aB=(%_ToInteger(az));
if(!(aA===(void 0))){
var aC=(%_ToInteger(aA));
var aD=%_TypedArrayGetLength(this);
}else{
var aD=%_TypedArrayGetLength(this);
var aC=aD;
}
if(aB<0){
aB=A(0,aD+aB);
}else{
aB=B(aB,aD);
}
if(aC<0){
aC=A(0,aD+aC);
}else{
aC=B(aC,aD);
}
if(aC<aB){
aC=aB;
}
var aE=aC-aB;
var aF=
%_ArrayBufferViewGetByteOffset(this)+aB*1;
return new R(%TypedArrayGetBuffer(this),aF,aE);
}


function TypedArraySubArray(az,aA){
switch(%_ClassOf(this)){
case"Uint8Array":
return %_Call(Uint8ArraySubArray,this,az,aA);

case"Int8Array":
return %_Call(Int8ArraySubArray,this,az,aA);

case"Uint16Array":
return %_Call(Uint16ArraySubArray,this,az,aA);

case"Int16Array":
return %_Call(Int16ArraySubArray,this,az,aA);

case"Uint32Array":
return %_Call(Uint32ArraySubArray,this,az,aA);

case"Int32Array":
return %_Call(Int32ArraySubArray,this,az,aA);

case"Float32Array":
return %_Call(Float32ArraySubArray,this,az,aA);

case"Float64Array":
return %_Call(Float64ArraySubArray,this,az,aA);

case"Uint8ClampedArray":
return %_Call(Uint8ClampedArraySubArray,this,az,aA);


}
throw %make_type_error(44,
"get TypedArray.prototype.subarray",this);
}
%SetForceInlineFlag(TypedArraySubArray);
function TypedArraySetFromArrayLike(aG,aH,aI,ai){
if(ai>0){
for(var ao=0;ao<aI;ao++){
aG[ai+ao]=aH[ao];
}
}
else{
for(var ao=0;ao<aI;ao++){
aG[ao]=aH[ao];
}
}
}
function TypedArraySetFromOverlappingTypedArray(aG,aH,ai){
var aJ=aH.BYTES_PER_ELEMENT;
var aK=aG.BYTES_PER_ELEMENT;
var aI=%_TypedArrayGetLength(aH);
function CopyLeftPart(){
var aL=aG.byteOffset+(ai+1)*aK;
var aM=aH.byteOffset;
for(var aN=0;
aN<aI&&aL<=aM;
aN++){
aG[ai+aN]=aH[aN];
aL+=aK;
aM+=aJ;
}
return aN;
}
var aN=CopyLeftPart();
function CopyRightPart(){
var aL=
aG.byteOffset+(ai+aI-1)*aK;
var aM=
aH.byteOffset+aI*aJ;
for(var aO=aI-1;
aO>=aN&&aL>=aM;
aO--){
aG[ai+aO]=aH[aO];
aL-=aK;
aM-=aJ;
}
return aO;
}
var aO=CopyRightPart();
var aP=new g(aO+1-aN);
for(var ao=aN;ao<=aO;ao++){
aP[ao-aN]=aH[ao];
}
for(ao=aN;ao<=aO;ao++){
aG[ai+ao]=aP[ao-aN];
}
}
function TypedArraySet(ad,ai){
var aQ=(ai===(void 0))?0:(%_ToInteger(ai));
if(aQ<0)throw %make_type_error(181);
if(aQ>%_MaxSmi()){
throw %make_range_error(182);
}
switch(%TypedArraySetFastCases(this,ad,aQ)){
case 0:
return;
case 1:
TypedArraySetFromOverlappingTypedArray(this,ad,aQ);
return;
case 2:
TypedArraySetFromArrayLike(this,
ad,%_TypedArrayGetLength(ad),aQ);
return;
case 3:
var ak=ad.length;
if((ak===(void 0))){
if((typeof(ad)==='number')){
throw %make_type_error(46);
}
return;
}
ak=(%_ToLength(ak));
if(aQ+ak>%_TypedArrayGetLength(this)){
throw %make_range_error(182);
}
TypedArraySetFromArrayLike(this,ad,ak,aQ);
return;
}
}
%FunctionSetLength(TypedArraySet,1);
function TypedArrayGetToStringTag(){
if(!(%_IsTypedArray(this)))return;
var aR=%_ClassOf(this);
if((aR===(void 0)))return;
return aR;
}
function TypedArrayCopyWithin(aG,aS,aA){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return l(aG,aS,aA,this,ag);
}
%FunctionSetLength(TypedArrayCopyWithin,2);
function TypedArrayEvery(aT,aU){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return m(aT,aU,this,ag);
}
%FunctionSetLength(TypedArrayEvery,1);
function TypedArrayForEach(aT,aU){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
r(aT,aU,this,ag);
}
%FunctionSetLength(TypedArrayForEach,1);
function TypedArrayFill(au,aS,aA){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return n(au,aS,aA,this,ag);
}
%FunctionSetLength(TypedArrayFill,1);
function TypedArrayFilter(aT,aV){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
if(!(typeof(aT)==='function'))throw %make_type_error(15,aT);
var aW=new y();
o(aT,aV,this,ag,aW);
var aX=aW.length;
var aY=TypedArraySpeciesCreate(this,aX);
for(var ao=0;ao<aX;ao++){
aY[ao]=aW[ao];
}
return aY;
}
%FunctionSetLength(TypedArrayFilter,1);
function TypedArrayFind(aZ,aV){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return p(aZ,aV,this,ag);
}
%FunctionSetLength(TypedArrayFind,1);
function TypedArrayFindIndex(aZ,aV){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return q(aZ,aV,this,ag);
}
%FunctionSetLength(TypedArrayFindIndex,1);
function TypedArrayReverse(){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return C(this,ag);
}
function TypedArrayComparefn(ba,bb){
if(ba===0&&ba===bb){
ba=1/ba;
bb=1/bb;
}
if(ba<bb){
return-1;
}else if(ba>bb){
return 1;
}else if(z(ba)&&z(bb)){
return z(bb)?0:1;
}else if(z(ba)){
return 1;
}
return 0;
}
function TypedArraySort(bc){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
if((bc===(void 0))){
bc=TypedArrayComparefn;
}
return w(this,ag,bc);
}
function TypedArrayIndexOf(bd,be){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
if(ag===0)return-1;
if(!(typeof(bd)==='number'))return-1;
var bf=(%_ToInteger(be));
var bg;
if(bf===0){
bg=0;
}else if(bf>0){
bg=bf;
}else{
bg=ag+bf;
if(bg<0){
bg=0;
}
}
while(bg<ag){
var bh=this[bg];
if(bd===bh){
return bg;
}
++bg;
}
return-1;
}
%FunctionSetLength(TypedArrayIndexOf,1);
function TypedArrayLastIndexOf(bd,be){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
if(ag===0)return-1;
if(!(typeof(bd)==='number'))return-1;
var bf;
if(arguments.length<2){
bf=ag-1;
}else{
bf=(%_ToInteger(be));
}
var bg;
if(bf>=0){
if(ag<=bf){
bg=ag-1;
}else if(bf===0){
bg=0;
}else{
bg=bf;
}
}else{
bg=ag+bf;
}
while(bg>=0){
var bh=this[bg];
if(bd===bh){
return bg;
}
--bg;
}
return-1;
}
%FunctionSetLength(TypedArrayLastIndexOf,1);
function TypedArrayMap(aT,aV){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
var aW=TypedArraySpeciesCreate(this,ag);
if(!(typeof(aT)==='function'))throw %make_type_error(15,aT);
for(var ao=0;ao<ag;ao++){
var bd=this[ao];
aW[ao]=%_Call(aT,aV,bd,ao,this);
}
return aW;
}
%FunctionSetLength(TypedArrayMap,1);
function TypedArraySome(aT,aU){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return v(aT,aU,this,ag);
}
%FunctionSetLength(TypedArraySome,1);
function TypedArrayToLocaleString(){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return x(this,ag);
}
function TypedArrayJoin(bi){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return s(bi,this,ag);
}
function TypedArrayReduce(bj,bk){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return t(bj,bk,this,ag,
arguments.length);
}
%FunctionSetLength(TypedArrayReduce,1);
function TypedArrayReduceRight(bj,bk){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
return u(bj,bk,this,ag,
arguments.length);
}
%FunctionSetLength(TypedArrayReduceRight,1);
function TypedArraySlice(aS,aA){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var bl=%_TypedArrayGetLength(this);
var bm=(%_ToInteger(aS));
var bg;
if(bm<0){
bg=A(bl+bm,0);
}else{
bg=B(bm,bl);
}
var bn;
if((aA===(void 0))){
bn=bl;
}else{
bn=(%_ToInteger(aA));
}
var bo;
if(bn<0){
bo=A(bl+bn,0);
}else{
bo=B(bn,bl);
}
var bp=A(bo-bg,0);
var bq=TypedArraySpeciesCreate(this,bp);
var bf=0;
while(bg<bo){
var br=this[bg];
bq[bf]=br;
bg++;
bf++;
}
return bq;
}
function TypedArrayIncludes(bs,bt){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
var ag=%_TypedArrayGetLength(this);
if(ag===0)return false;
var bf=(%_ToInteger(bt));
var bg;
if(bf>=0){
bg=bf;
}else{
bg=ag+bf;
if(bg<0){
bg=0;
}
}
while(bg<ag){
var bh=this[bg];
if(%SameValueZero(bs,bh)){
return true;
}
++bg;
}
return false;
}
%FunctionSetLength(TypedArrayIncludes,1);
function TypedArrayOf(){
var ag=arguments.length;
var bq=TypedArrayCreate(this,ag);
for(var ao=0;ao<ag;ao++){
bq[ao]=arguments[ao];
}
return bq;
}
function IterableToArrayLike(bu){
var ap=f(bu,G);
if(!(ap===(void 0))){
var bv=new y();
var ao=0;
for(var au of
{[G](){return e(bu,ap)}}){
bv[ao]=au;
ao++;
}
var bq=[];
%MoveArrayContents(bv,bq);
return bq;
}
return(%_ToObject(bu));
}
function TypedArrayFrom(aH,bw,aV){
if(!%IsConstructor(this))throw %make_type_error(66,this);
var bx;
if(!(bw===(void 0))){
if(!(typeof(bw)==='function'))throw %make_type_error(15,this);
bx=true;
}else{
bx=false;
}
var am=IterableToArrayLike(aH);
var ag=(%_ToLength(am.length));
var by=TypedArrayCreate(this,ag);
var au,bz;
for(var ao=0;ao<ag;ao++){
au=am[ao];
if(bx){
bz=%_Call(bw,aV,au,ao);
}else{
bz=au;
}
by[ao]=bz;
}
return by;
}
%FunctionSetLength(TypedArrayFrom,1);
function TypedArrayConstructor(){
if((new.target===(void 0))){
throw %make_type_error(26,"TypedArray");
}
if(new.target===S){
throw %make_type_error(24,"TypedArray");
}
}
function TypedArraySpecies(){
return this;
}
%SetCode(S,TypedArrayConstructor);
b.InstallFunctions(S,2,[
"from",TypedArrayFrom,
"of",TypedArrayOf
]);
b.InstallGetter(S,H,TypedArraySpecies);
b.InstallGetter(S.prototype,I,
TypedArrayGetToStringTag);
b.InstallFunctions(S.prototype,2,[
"subarray",TypedArraySubArray,
"set",TypedArraySet,
"copyWithin",TypedArrayCopyWithin,
"every",TypedArrayEvery,
"fill",TypedArrayFill,
"filter",TypedArrayFilter,
"find",TypedArrayFind,
"findIndex",TypedArrayFindIndex,
"includes",TypedArrayIncludes,
"indexOf",TypedArrayIndexOf,
"join",TypedArrayJoin,
"lastIndexOf",TypedArrayLastIndexOf,
"forEach",TypedArrayForEach,
"map",TypedArrayMap,
"reduce",TypedArrayReduce,
"reduceRight",TypedArrayReduceRight,
"reverse",TypedArrayReverse,
"slice",TypedArraySlice,
"some",TypedArraySome,
"sort",TypedArraySort,
"toLocaleString",TypedArrayToLocaleString
]);
%AddNamedProperty(S.prototype,"toString",c,
2);
%SetCode(J,Uint8ArrayConstructor);
%FunctionSetPrototype(J,new k());
%InternalSetPrototype(J,S);
%InternalSetPrototype(J.prototype,S.prototype);
%AddNamedProperty(J,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(J.prototype,
"constructor",a.Uint8Array,2);
%AddNamedProperty(J.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);

%SetCode(K,Int8ArrayConstructor);
%FunctionSetPrototype(K,new k());
%InternalSetPrototype(K,S);
%InternalSetPrototype(K.prototype,S.prototype);
%AddNamedProperty(K,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(K.prototype,
"constructor",a.Int8Array,2);
%AddNamedProperty(K.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);

%SetCode(L,Uint16ArrayConstructor);
%FunctionSetPrototype(L,new k());
%InternalSetPrototype(L,S);
%InternalSetPrototype(L.prototype,S.prototype);
%AddNamedProperty(L,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(L.prototype,
"constructor",a.Uint16Array,2);
%AddNamedProperty(L.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);

%SetCode(M,Int16ArrayConstructor);
%FunctionSetPrototype(M,new k());
%InternalSetPrototype(M,S);
%InternalSetPrototype(M.prototype,S.prototype);
%AddNamedProperty(M,"BYTES_PER_ELEMENT",2,
1|2|4);
%AddNamedProperty(M.prototype,
"constructor",a.Int16Array,2);
%AddNamedProperty(M.prototype,
"BYTES_PER_ELEMENT",2,
1|2|4);

%SetCode(N,Uint32ArrayConstructor);
%FunctionSetPrototype(N,new k());
%InternalSetPrototype(N,S);
%InternalSetPrototype(N.prototype,S.prototype);
%AddNamedProperty(N,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(N.prototype,
"constructor",a.Uint32Array,2);
%AddNamedProperty(N.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);

%SetCode(O,Int32ArrayConstructor);
%FunctionSetPrototype(O,new k());
%InternalSetPrototype(O,S);
%InternalSetPrototype(O.prototype,S.prototype);
%AddNamedProperty(O,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(O.prototype,
"constructor",a.Int32Array,2);
%AddNamedProperty(O.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);

%SetCode(P,Float32ArrayConstructor);
%FunctionSetPrototype(P,new k());
%InternalSetPrototype(P,S);
%InternalSetPrototype(P.prototype,S.prototype);
%AddNamedProperty(P,"BYTES_PER_ELEMENT",4,
1|2|4);
%AddNamedProperty(P.prototype,
"constructor",a.Float32Array,2);
%AddNamedProperty(P.prototype,
"BYTES_PER_ELEMENT",4,
1|2|4);

%SetCode(Q,Float64ArrayConstructor);
%FunctionSetPrototype(Q,new k());
%InternalSetPrototype(Q,S);
%InternalSetPrototype(Q.prototype,S.prototype);
%AddNamedProperty(Q,"BYTES_PER_ELEMENT",8,
1|2|4);
%AddNamedProperty(Q.prototype,
"constructor",a.Float64Array,2);
%AddNamedProperty(Q.prototype,
"BYTES_PER_ELEMENT",8,
1|2|4);

%SetCode(R,Uint8ClampedArrayConstructor);
%FunctionSetPrototype(R,new k());
%InternalSetPrototype(R,S);
%InternalSetPrototype(R.prototype,S.prototype);
%AddNamedProperty(R,"BYTES_PER_ELEMENT",1,
1|2|4);
%AddNamedProperty(R.prototype,
"constructor",a.Uint8ClampedArray,2);
%AddNamedProperty(R.prototype,
"BYTES_PER_ELEMENT",1,
1|2|4);


function DataViewGetInt8JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getInt8',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetInt8(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetInt8JS,1);
function DataViewSetInt8JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setInt8',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetInt8(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetInt8JS,2);

function DataViewGetUint8JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getUint8',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetUint8(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetUint8JS,1);
function DataViewSetUint8JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setUint8',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetUint8(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetUint8JS,2);

function DataViewGetInt16JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getInt16',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetInt16(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetInt16JS,1);
function DataViewSetInt16JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setInt16',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetInt16(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetInt16JS,2);

function DataViewGetUint16JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getUint16',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetUint16(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetUint16JS,1);
function DataViewSetUint16JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setUint16',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetUint16(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetUint16JS,2);

function DataViewGetInt32JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getInt32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetInt32(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetInt32JS,1);
function DataViewSetInt32JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setInt32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetInt32(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetInt32JS,2);

function DataViewGetUint32JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getUint32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetUint32(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetUint32JS,1);
function DataViewSetUint32JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setUint32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetUint32(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetUint32JS,2);

function DataViewGetFloat32JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getFloat32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetFloat32(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetFloat32JS,1);
function DataViewSetFloat32JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setFloat32',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetFloat32(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetFloat32JS,2);

function DataViewGetFloat64JS(ai,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.getFloat64',this);
}
ai=(ai===(void 0))?0:F(ai,159);
return %DataViewGetFloat64(this,ai,!!bA);
}
%FunctionSetLength(DataViewGetFloat64JS,1);
function DataViewSetFloat64JS(ai,au,bA){
if(!(%_ClassOf(this)==='DataView')){
throw %make_type_error(44,
'DataView.setFloat64',this);
}
ai=(ai===(void 0))?0:F(ai,159);
%DataViewSetFloat64(this,ai,(%_ToNumber(au)),!!bA);
}
%FunctionSetLength(DataViewSetFloat64JS,2);


b.InstallFunctions(j.prototype,2,[
"getInt8",DataViewGetInt8JS,
"setInt8",DataViewSetInt8JS,
"getUint8",DataViewGetUint8JS,
"setUint8",DataViewSetUint8JS,
"getInt16",DataViewGetInt16JS,
"setInt16",DataViewSetInt16JS,
"getUint16",DataViewGetUint16JS,
"setUint16",DataViewSetUint16JS,
"getInt32",DataViewGetInt32JS,
"setInt32",DataViewSetInt32JS,
"getUint32",DataViewGetUint32JS,
"setUint32",DataViewSetUint32JS,
"getFloat32",DataViewGetFloat32JS,
"setFloat32",DataViewSetFloat32JS,
"getFloat64",DataViewGetFloat64JS,
"setFloat64",DataViewSetFloat64JS
]);
})

Hiterator-prototype—
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d=b.ImportNow("IteratorPrototype");
var e=b.ImportNow("iterator_symbol");
function IteratorPrototypeIterator(){
return this;
}
b.SetFunctionName(IteratorPrototypeIterator,e);
%AddNamedProperty(d,e,
IteratorPrototypeIterator,2);
})

(collectionëÑ
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=a.Object;
var e=a.Set;
var f=b.ImportNow("hash_code_symbol");
var g;
var h;
var i;
var j;
var k=b.ImportNow("species_symbol");
var l=b.ImportNow("to_string_tag_symbol");
b.Import(function(m){
g=m.MathRandom;
h=m.MapIterator;
i=m.NumberIsNaN;
j=m.SetIterator;
});
function HashToEntry(n,o,p){
var q=(o&((p)-1));
return((%_FixedArrayGet(n,(3+(q))|0)));
}
%SetForceInlineFlag(HashToEntry);
function SetFindEntry(n,p,r,o){
var s=HashToEntry(n,o,p);
if(s===-1)return s;
var t=((%_FixedArrayGet(n,((3+(p)+((s)<<1)))|0)));
if(r===t)return s;
var u=i(r);
while(true){
if(u&&i(t)){
return s;
}
s=((%_FixedArrayGet(n,((3+(p)+((s)<<1))+1)|0)));
if(s===-1)return s;
t=((%_FixedArrayGet(n,((3+(p)+((s)<<1)))|0)));
if(r===t)return s;
}
return-1;
}
%SetForceInlineFlag(SetFindEntry);
function MapFindEntry(n,p,r,o){
var s=HashToEntry(n,o,p);
if(s===-1)return s;
var t=((%_FixedArrayGet(n,((3+(p)+((s)*3)))|0)));
if(r===t)return s;
var u=i(r);
while(true){
if(u&&i(t)){
return s;
}
s=((%_FixedArrayGet(n,((3+(p)+((s)*3))+2)|0)));
if(s===-1)return s;
t=((%_FixedArrayGet(n,((3+(p)+((s)*3)))|0)));
if(r===t)return s;
}
return-1;
}
%SetForceInlineFlag(MapFindEntry);
function ComputeIntegerHash(r,v){
var o=r;
o=o^v;
o=~o+(o<<15);
o=o^(o>>>12);
o=o+(o<<2);
o=o^(o>>>4);
o=(o*2057)|0;
o=o^(o>>>16);
return o&0x3fffffff;
}
%SetForceInlineFlag(ComputeIntegerHash);
function GetExistingHash(r){
if(%_IsSmi(r)){
return ComputeIntegerHash(r,0);
}
if((typeof(r)==='string')){
var w=%_StringGetRawHashField(r);
if((w&1)===0){
return w>>>2;
}
}else if((%_IsJSReceiver(r))&&!(%_IsJSProxy(r))&&!(%_ClassOf(r)==='global')){
var o=(r[f]);
return o;
}
return %GenericHash(r);
}
%SetForceInlineFlag(GetExistingHash);
function GetHash(r){
var o=GetExistingHash(r);
if((o===(void 0))){
o=(g()*0x40000000)|0;
if(o===0)o=1;
(r[f]=o);
}
return o;
}
%SetForceInlineFlag(GetHash);
function SetConstructor(x){
if((new.target===(void 0))){
throw %make_type_error(27,"Set");
}
%_SetInitialize(this);
if(!(x==null)){
var y=this.add;
if(!(typeof(y)==='function')){
throw %make_type_error(86,y,'add',this);
}
for(var z of x){
%_Call(y,this,z);
}
}
}
function SetAdd(r){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,'Set.prototype.add',this);
}
if(r===0){
r=0;
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetHash(r);
if(SetFindEntry(n,p,r,o)!==-1)return this;
var A=((%_FixedArrayGet(n,(1)|0)));
var B=((%_FixedArrayGet(n,(2)|0)));
var C=p<<1;
if((A+B)>=C){
%SetGrow(this);
n=%_JSCollectionGetTable(this);
p=((%_FixedArrayGet(n,(0)|0)));
A=((%_FixedArrayGet(n,(1)|0)));
B=((%_FixedArrayGet(n,(2)|0)));
}
var s=A+B;
var D=(3+(p)+((s)<<1));
var q=(o&((p)-1));
var E=((%_FixedArrayGet(n,(3+(q))|0)));
((%_FixedArraySet(n,(3+(q))|0,s)));
(((%_FixedArraySet(n,(1)|0,(A+1)|0))));
(%_FixedArraySet(n,(D)|0,r));
((%_FixedArraySet(n,(D+1)|0,(E)|0)));
return this;
}
function SetHas(r){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,'Set.prototype.has',this);
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetExistingHash(r);
if((o===(void 0)))return false;
return SetFindEntry(n,p,r,o)!==-1;
}
function SetDelete(r){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.delete',this);
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetExistingHash(r);
if((o===(void 0)))return false;
var s=SetFindEntry(n,p,r,o);
if(s===-1)return false;
var A=((%_FixedArrayGet(n,(1)|0)))-1;
var B=((%_FixedArrayGet(n,(2)|0)))+1;
var D=(3+(p)+((s)<<1));
(%_FixedArraySet(n,(D)|0,%_TheHole()));
(((%_FixedArraySet(n,(1)|0,(A)|0))));
(((%_FixedArraySet(n,(2)|0,(B)|0))));
if(A<(p>>>1))%SetShrink(this);
return true;
}
function SetGetSize(){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.size',this);
}
var n=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(n,(1)|0)));
}
function SetClearJS(){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.clear',this);
}
%_SetClear(this);
}
function SetForEach(F,G){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.forEach',this);
}
if(!(typeof(F)==='function'))throw %make_type_error(15,F);
var H=new j(this,2);
var r;
var I=[(void 0)];
while(%SetIteratorNext(H,I)){
r=I[0];
%_Call(F,G,r,r,this);
}
}
function SetSpecies(){
return this;
}
%SetCode(e,SetConstructor);
%FunctionSetLength(e,0);
%FunctionSetPrototype(e,new d());
%AddNamedProperty(e.prototype,"constructor",e,2);
%AddNamedProperty(e.prototype,l,"Set",
2|1);
%FunctionSetLength(SetForEach,1);
b.InstallGetter(e,k,SetSpecies);
b.InstallGetter(e.prototype,"size",SetGetSize);
b.InstallFunctions(e.prototype,2,[
"add",SetAdd,
"has",SetHas,
"delete",SetDelete,
"clear",SetClearJS,
"forEach",SetForEach
]);
function MapConstructor(x){
if((new.target===(void 0))){
throw %make_type_error(27,"Map");
}
%_MapInitialize(this);
if(!(x==null)){
var y=this.set;
if(!(typeof(y)==='function')){
throw %make_type_error(86,y,'set',this);
}
for(var J of x){
if(!(%_IsJSReceiver(J))){
throw %make_type_error(51,J);
}
%_Call(y,this,J[0],J[1]);
}
}
}
function MapGet(r){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.get',this);
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetExistingHash(r);
if((o===(void 0)))return(void 0);
var s=MapFindEntry(n,p,r,o);
if(s===-1)return(void 0);
return((%_FixedArrayGet(n,((3+(p)+((s)*3))+1)|0)));
}
function MapSet(r,z){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.set',this);
}
if(r===0){
r=0;
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetHash(r);
var s=MapFindEntry(n,p,r,o);
if(s!==-1){
var K=(3+(p)+((s)*3));
(%_FixedArraySet(n,(K+1)|0,z));
return this;
}
var A=((%_FixedArrayGet(n,(1)|0)));
var B=((%_FixedArrayGet(n,(2)|0)));
var C=p<<1;
if((A+B)>=C){
%MapGrow(this);
n=%_JSCollectionGetTable(this);
p=((%_FixedArrayGet(n,(0)|0)));
A=((%_FixedArrayGet(n,(1)|0)));
B=((%_FixedArrayGet(n,(2)|0)));
}
s=A+B;
var D=(3+(p)+((s)*3));
var q=(o&((p)-1));
var E=((%_FixedArrayGet(n,(3+(q))|0)));
((%_FixedArraySet(n,(3+(q))|0,s)));
(((%_FixedArraySet(n,(1)|0,(A+1)|0))));
(%_FixedArraySet(n,(D)|0,r));
(%_FixedArraySet(n,(D+1)|0,z));
(%_FixedArraySet(n,(D+2)|0,E));
return this;
}
function MapHas(r){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.has',this);
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetHash(r);
return MapFindEntry(n,p,r,o)!==-1;
}
function MapDelete(r){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.delete',this);
}
var n=%_JSCollectionGetTable(this);
var p=((%_FixedArrayGet(n,(0)|0)));
var o=GetHash(r);
var s=MapFindEntry(n,p,r,o);
if(s===-1)return false;
var A=((%_FixedArrayGet(n,(1)|0)))-1;
var B=((%_FixedArrayGet(n,(2)|0)))+1;
var D=(3+(p)+((s)*3));
(%_FixedArraySet(n,(D)|0,%_TheHole()));
(%_FixedArraySet(n,(D+1)|0,%_TheHole()));
(((%_FixedArraySet(n,(1)|0,(A)|0))));
(((%_FixedArraySet(n,(2)|0,(B)|0))));
if(A<(p>>>1))%MapShrink(this);
return true;
}
function MapGetSize(){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.size',this);
}
var n=%_JSCollectionGetTable(this);
return((%_FixedArrayGet(n,(1)|0)));
}
function MapClearJS(){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.clear',this);
}
%_MapClear(this);
}
function MapForEach(F,G){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.forEach',this);
}
if(!(typeof(F)==='function'))throw %make_type_error(15,F);
var H=new h(this,3);
var I=[(void 0),(void 0)];
while(%MapIteratorNext(H,I)){
%_Call(F,G,I[1],I[0],this);
}
}
function MapSpecies(){
return this;
}
%SetCode(c,MapConstructor);
%FunctionSetLength(c,0);
%FunctionSetPrototype(c,new d());
%AddNamedProperty(c.prototype,"constructor",c,2);
%AddNamedProperty(
c.prototype,l,"Map",2|1);
%FunctionSetLength(MapForEach,1);
b.InstallGetter(c,k,MapSpecies);
b.InstallGetter(c.prototype,"size",MapGetSize);
b.InstallFunctions(c.prototype,2,[
"get",MapGet,
"set",MapSet,
"has",MapHas,
"delete",MapDelete,
"clear",MapClearJS,
"forEach",MapForEach
]);
%InstallToContext([
"map_get",MapGet,
"map_set",MapSet,
"map_has",MapHas,
"map_delete",MapDelete,
"set_add",SetAdd,
"set_has",SetHas,
"set_delete",SetDelete,
]);
b.Export(function(L){
L.GetExistingHash=GetExistingHash;
L.GetHash=GetHash;
});
})

<weak-collectionµ0
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c;
var d;
var e=a.Object;
var f=a.WeakMap;
var g=a.WeakSet;
var h=b.ImportNow("to_string_tag_symbol");
b.Import(function(i){
c=i.GetExistingHash;
d=i.GetHash;
});
function WeakMapConstructor(j){
if((new.target===(void 0))){
throw %make_type_error(27,"WeakMap");
}
%WeakCollectionInitialize(this);
if(!(j==null)){
var k=this.set;
if(!(typeof(k)==='function')){
throw %make_type_error(86,k,'set',this);
}
for(var l of j){
if(!(%_IsJSReceiver(l))){
throw %make_type_error(51,l);
}
%_Call(k,this,l[0],l[1]);
}
}
}
function WeakMapGet(m){
if(!(%_ClassOf(this)==='WeakMap')){
throw %make_type_error(44,
'WeakMap.prototype.get',this);
}
if(!(%_IsJSReceiver(m)))return(void 0);
var n=c(m);
if((n===(void 0)))return(void 0);
return %WeakCollectionGet(this,m,n);
}
function WeakMapSet(m,o){
if(!(%_ClassOf(this)==='WeakMap')){
throw %make_type_error(44,
'WeakMap.prototype.set',this);
}
if(!(%_IsJSReceiver(m)))throw %make_type_error(164);
return %WeakCollectionSet(this,m,o,d(m));
}
function WeakMapHas(m){
if(!(%_ClassOf(this)==='WeakMap')){
throw %make_type_error(44,
'WeakMap.prototype.has',this);
}
if(!(%_IsJSReceiver(m)))return false;
var n=c(m);
if((n===(void 0)))return false;
return %WeakCollectionHas(this,m,n);
}
function WeakMapDelete(m){
if(!(%_ClassOf(this)==='WeakMap')){
throw %make_type_error(44,
'WeakMap.prototype.delete',this);
}
if(!(%_IsJSReceiver(m)))return false;
var n=c(m);
if((n===(void 0)))return false;
return %WeakCollectionDelete(this,m,n);
}
%SetCode(f,WeakMapConstructor);
%FunctionSetLength(f,0);
%FunctionSetPrototype(f,new e());
%AddNamedProperty(f.prototype,"constructor",f,
2);
%AddNamedProperty(f.prototype,h,"WeakMap",
2|1);
b.InstallFunctions(f.prototype,2,[
"get",WeakMapGet,
"set",WeakMapSet,
"has",WeakMapHas,
"delete",WeakMapDelete
]);
function WeakSetConstructor(j){
if((new.target===(void 0))){
throw %make_type_error(27,"WeakSet");
}
%WeakCollectionInitialize(this);
if(!(j==null)){
var k=this.add;
if(!(typeof(k)==='function')){
throw %make_type_error(86,k,'add',this);
}
for(var o of j){
%_Call(k,this,o);
}
}
}
function WeakSetAdd(o){
if(!(%_ClassOf(this)==='WeakSet')){
throw %make_type_error(44,
'WeakSet.prototype.add',this);
}
if(!(%_IsJSReceiver(o)))throw %make_type_error(165);
return %WeakCollectionSet(this,o,true,d(o));
}
function WeakSetHas(o){
if(!(%_ClassOf(this)==='WeakSet')){
throw %make_type_error(44,
'WeakSet.prototype.has',this);
}
if(!(%_IsJSReceiver(o)))return false;
var n=c(o);
if((n===(void 0)))return false;
return %WeakCollectionHas(this,o,n);
}
function WeakSetDelete(o){
if(!(%_ClassOf(this)==='WeakSet')){
throw %make_type_error(44,
'WeakSet.prototype.delete',this);
}
if(!(%_IsJSReceiver(o)))return false;
var n=c(o);
if((n===(void 0)))return false;
return %WeakCollectionDelete(this,o,n);
}
%SetCode(g,WeakSetConstructor);
%FunctionSetLength(g,0);
%FunctionSetPrototype(g,new e());
%AddNamedProperty(g.prototype,"constructor",g,
2);
%AddNamedProperty(g.prototype,h,"WeakSet",
2|1);
b.InstallFunctions(g.prototype,2,[
"add",WeakSetAdd,
"has",WeakSetHas,
"delete",WeakSetDelete
]);
})

Lcollection-iteratorÒ(
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=a.Set;
var e=b.ImportNow("iterator_symbol");
var f=b.ImportNow("MapIterator");
var g=b.ImportNow("to_string_tag_symbol");
var h=b.ImportNow("SetIterator");
function SetIteratorConstructor(i,j){
%SetIteratorInitialize(this,i,j);
}
function SetIteratorNextJS(){
if(!(%_ClassOf(this)==='Set Iterator')){
throw %make_type_error(44,
'Set Iterator.prototype.next',this);
}
var k=[(void 0),(void 0)];
var l=%_CreateIterResultObject(k,false);
switch(%SetIteratorNext(this,k)){
case 0:
l.value=(void 0);
l.done=true;
break;
case 2:
l.value=k[0];
break;
case 3:
k[1]=k[0];
break;
}
return l;
}
function SetEntries(){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.entries',this);
}
return new h(this,3);
}
function SetValues(){
if(!(%_ClassOf(this)==='Set')){
throw %make_type_error(44,
'Set.prototype.values',this);
}
return new h(this,2);
}
%SetCode(h,SetIteratorConstructor);
%FunctionSetInstanceClassName(h,'Set Iterator');
b.InstallFunctions(h.prototype,2,[
'next',SetIteratorNextJS
]);
%AddNamedProperty(h.prototype,g,
"Set Iterator",1|2);
b.InstallFunctions(d.prototype,2,[
'entries',SetEntries,
'keys',SetValues,
'values',SetValues
]);
%AddNamedProperty(d.prototype,e,SetValues,2);
function MapIteratorConstructor(m,j){
%MapIteratorInitialize(this,m,j);
}
function MapIteratorNextJS(){
if(!(%_ClassOf(this)==='Map Iterator')){
throw %make_type_error(44,
'Map Iterator.prototype.next',this);
}
var k=[(void 0),(void 0)];
var l=%_CreateIterResultObject(k,false);
switch(%MapIteratorNext(this,k)){
case 0:
l.value=(void 0);
l.done=true;
break;
case 1:
l.value=k[0];
break;
case 2:
l.value=k[1];
break;
}
return l;
}
function MapEntries(){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.entries',this);
}
return new f(this,3);
}
function MapKeys(){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.keys',this);
}
return new f(this,1);
}
function MapValues(){
if(!(%_ClassOf(this)==='Map')){
throw %make_type_error(44,
'Map.prototype.values',this);
}
return new f(this,2);
}
%SetCode(f,MapIteratorConstructor);
%FunctionSetInstanceClassName(f,'Map Iterator');
b.InstallFunctions(f.prototype,2,[
'next',MapIteratorNextJS
]);
%AddNamedProperty(f.prototype,g,
"Map Iterator",1|2);
b.InstallFunctions(c.prototype,2,[
'entries',MapEntries,
'keys',MapKeys,
'values',MapValues
]);
%AddNamedProperty(c.prototype,e,MapEntries,2);
b.Export(function(n){
n.MapEntries=MapEntries;
n.MapIteratorNext=MapIteratorNextJS;
n.SetIteratorNext=SetIteratorNextJS;
n.SetValues=SetValues;
});
})

promiseÂå
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d=b.InternalArray;
var e=
b.ImportNow("promise_combined_deferred_symbol");
var f=
b.ImportNow("promise_has_handler_symbol");
var g=
b.ImportNow("promise_reject_reactions_symbol");
var h=
b.ImportNow("promise_fulfill_reactions_symbol");
var i=
b.ImportNow("promise_deferred_reactions_symbol");
var j=b.ImportNow("promise_raw_symbol");
var k=b.ImportNow("promise_state_symbol");
var l=b.ImportNow("promise_result_symbol");
var m;
var n=b.ImportNow("species_symbol");
var o=b.ImportNow("to_string_tag_symbol");
b.Import(function(p){
m=p.SpeciesConstructor;
});
const kPending=0;
const kFulfilled=+1;
const kRejected=-1;
var q=0;
function CreateResolvingFunctions(r){
var s=false;
var t=value=>{
if(s===true)return;
s=true;
ResolvePromise(r,value);
};
var u=reason=>{
if(s===true)return;
s=true;
RejectPromise(r,reason);
};
return{
__proto__:null,
resolve:t,
reject:u
};
}
var v=function Promise(w){
if(w===j){
return %_NewObject(v,new.target);
}
if((new.target===(void 0)))throw %make_type_error(65,this);
if(!(typeof(w)==='function')){
throw %make_type_error(127,w);
}
var r=PromiseInit(%_NewObject(v,new.target));
var x=CreateResolvingFunctions(r);
var y=(%_DebugIsActive()!=0);
try{
if(y)%DebugPushPromise(r);
w(x.resolve,x.reject);
}%catch(e){
%_Call(x.reject,(void 0),e);
}finally{
if(y)%DebugPopPromise();
}
return r;
}
function PromiseSet(r,z,A){
(r[k]=z);
(r[l]=A);
(r[h]=(void 0));
(r[g]=(void 0));
(r[i]=(void 0));
return r;
}
function PromiseCreateAndSet(z,A){
var r=new v(j);
if((%_DebugIsActive()!=0))PromiseSet(r,kPending,(void 0));
return PromiseSet(r,z,A);
}
function PromiseInit(r){
return PromiseSet(r,kPending,(void 0));
}
function FulfillPromise(r,z,A,B){
if((r[k])===kPending){
var C=(r[B]);
if(!(C===(void 0))){
var D=(r[i]);
PromiseEnqueue(A,C,D,z);
}
PromiseSet(r,z,A);
}
}
function PromiseHandle(A,E,F){
var y=(%_DebugIsActive()!=0);
try{
if(y)%DebugPushPromise(F.promise);
var G=E(A);
F.resolve(G);
}%catch(exception){
try{F.reject(exception);}catch(e){}
}finally{
if(y)%DebugPopPromise();
}
}
function PromiseEnqueue(A,C,D,z){
var H,I,J=(%_DebugIsActive()!=0);
%EnqueueMicrotask(function(){
if(J){
%DebugAsyncTaskEvent({type:"willHandle",id:H,name:I});
}
if((%_IsArray(C))){
for(var K=0;K<C.length;K+=2){
PromiseHandle(A,C[K],C[K+1]);
}
}else{
PromiseHandle(A,C,D);
}
if(J){
%DebugAsyncTaskEvent({type:"didHandle",id:H,name:I});
}
});
if(J){
H=++q;
I=z===kFulfilled?"Promise.resolve":"Promise.reject";
%DebugAsyncTaskEvent({type:"enqueue",id:H,name:I});
}
}
function PromiseAttachCallbacks(r,F,L,M){
var N=
(r[h]);
if((N===(void 0))){
(r[h]=L);
(r[g]=M);
(r[i]=F);
}else if(!(%_IsArray(N))){
var O=new d();
var P=new d();
var Q=(r[i]);
O.push(
N,Q,L,F);
P.push((r[g]),
Q,
M,
F);
(r[h]=O);
(r[g]=P);
}else{
N.push(L,F);
(r[g]).push(M,F);
}
}
function PromiseIdResolveHandler(R){return R}
function PromiseIdRejectHandler(S){throw S}
function PromiseNopResolver(){}
function IsPromise(R){
return(%_IsJSReceiver(R))&&(!(R[k]===(void 0)));
}
function PromiseCreate(){
return new v(PromiseNopResolver)
}
function ResolvePromise(r,T){
if(T===r){
return RejectPromise(r,%make_type_error(82,T));
}
if((%_IsJSReceiver(T))){
try{
var U=T.then;
}catch(e){
return RejectPromise(r,e);
}
if(IsPromise(T)&&U===PromiseThen){
var V=(T[k]);
if(V===kFulfilled){
var W=(T[l]);
FulfillPromise(r,kFulfilled,W,
h);
(r[f]=true);
return;
}else if(V===kRejected){
var W=(T[l]);
if(!(!(T[f]===(void 0)))){
%PromiseRevokeReject(T);
}
RejectPromise(r,W);
(T[f]=true);
return;
}
}
if((typeof(U)==='function')){
var H;
var I="PromiseResolveThenableJob";
var J=(%_DebugIsActive()!=0);
%EnqueueMicrotask(function(){
if(J){
%DebugAsyncTaskEvent({type:"willHandle",id:H,name:I});
}
var x=CreateResolvingFunctions(r);
try{
%_Call(U,T,x.resolve,x.reject);
}catch(e){
%_Call(x.reject,(void 0),e);
}
if(J){
%DebugAsyncTaskEvent({type:"didHandle",id:H,name:I});
}
});
if(J){
H=++q;
%DebugAsyncTaskEvent({type:"enqueue",id:H,name:I});
}
return;
}
}
FulfillPromise(r,kFulfilled,T,h);
}
function RejectPromise(r,X){
if((r[k])===kPending){
var y=(%_DebugIsActive()!=0);
if(y||
!(!(r[f]===(void 0)))){
%PromiseRejectEvent(r,X,y);
}
}
FulfillPromise(r,kRejected,X,g)
}
function NewPromiseCapability(Y){
if(Y===v){
var r=PromiseInit(new v(j));
var x=CreateResolvingFunctions(r);
return{
promise:r,
resolve:x.resolve,
reject:x.reject
};
}
var G={promise:(void 0),resolve:(void 0),reject:(void 0)};
G.promise=new Y((t,u)=>{
if(!(G.resolve===(void 0))||!(G.reject===(void 0)))
throw %make_type_error(83);
G.resolve=t;
G.reject=u;
});
if(!(typeof(G.resolve)==='function')||!(typeof(G.reject)==='function'))
throw %make_type_error(84);
return G;
}
function PromiseReject(S){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(16,PromiseResolve);
}
if(this===v){
var r=PromiseCreateAndSet(kRejected,S);
%PromiseRejectEvent(r,S,false);
return r;
}else{
var Z=NewPromiseCapability(this);
%_Call(Z.reject,(void 0),S);
return Z.promise;
}
}
function PromiseCreateRejected(S){
return %_Call(PromiseReject,v,S);
}
function PromiseCreateResolved(A){
var r=PromiseInit(new v(j));
var aa=ResolvePromise(r,A);
return r;
}
function PromiseCastResolved(A){
if(IsPromise(A)){
return A;
}else{
var r=PromiseInit(new v(j));
var aa=ResolvePromise(r,A);
return r;
}
}
function PerformPromiseThen(r,L,M,ab){
if(!(typeof(L)==='function'))L=PromiseIdResolveHandler;
if(!(typeof(M)==='function'))M=PromiseIdRejectHandler;
var z=(r[k]);
switch(z){
case kPending:
PromiseAttachCallbacks(r,ab,L,M);
break;
case kFulfilled:
PromiseEnqueue((r[l]),
L,ab,kFulfilled);
break;
case kRejected:
if(!(!(r[f]===(void 0)))){
%PromiseRevokeReject(r);
}
PromiseEnqueue((r[l]),
M,ab,kRejected);
break;
}
(r[f]=true);
return ab.promise;
}
function PromiseThen(L,M){
var z=(this[k]);
if((z===(void 0))){
throw %make_type_error(65,this);
}
var ac=m(this,v);
var ab=NewPromiseCapability(ac);
return PerformPromiseThen(this,L,M,ab);
}
function PromiseCatch(M){
return this.then((void 0),M);
}
function PromiseResolve(R){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(16,PromiseResolve);
}
if(IsPromise(R)&&R.constructor===this)return R;
if(this===v){
var r=PromiseInit(new v(j));
var aa=ResolvePromise(r,R);
return r;
}
var Z=NewPromiseCapability(this);
var aa=%_Call(Z.resolve,(void 0),R);
return Z.promise;
}
function PromiseAll(ad){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(16,"Promise.all");
}
var F=NewPromiseCapability(this);
var ae=new d();
var af;
function CreateResolveElementFunction(ag,ah,Z){
var ai=false;
return(R)=>{
if(ai===true)return;
ai=true;
ah[ag]=R;
if(--af===0){
var aj=[];
%MoveArrayContents(ah,aj);
%_Call(Z.resolve,(void 0),aj);
}
};
}
try{
var K=0;
af=1;
for(var A of ad){
var ak=this.resolve(A);
++af;
ak.then(
CreateResolveElementFunction(K,ae,F),
F.reject);
(F.reject[e]=F);
++K;
}
if(--af===0){
var aj=[];
%MoveArrayContents(ae,aj);
%_Call(F.resolve,(void 0),aj);
}
}catch(e){
%_Call(F.reject,(void 0),e);
}
return F.promise;
}
function PromiseRace(ad){
if(!(%_IsJSReceiver(this))){
throw %make_type_error(16,PromiseRace);
}
var F=NewPromiseCapability(this);
try{
for(var A of ad){
this.resolve(A).then(F.resolve,F.reject);
(F.reject[e]=F);
}
}catch(e){
F.reject(e)
}
return F.promise;
}
function PromiseHasUserDefinedRejectHandlerCheck(E,F){
if(E!==PromiseIdRejectHandler){
var al=(E[e]);
if((al===(void 0)))return true;
if(PromiseHasUserDefinedRejectHandlerRecursive(al.promise)){
return true;
}
}else if(PromiseHasUserDefinedRejectHandlerRecursive(F.promise)){
return true;
}
return false;
}
function PromiseHasUserDefinedRejectHandlerRecursive(r){
var am=(r[g]);
var D=(r[i]);
if((am===(void 0)))return false;
if(!(%_IsArray(am))){
return PromiseHasUserDefinedRejectHandlerCheck(am,D);
}else{
for(var K=0;K<am.length;K+=2){
if(PromiseHasUserDefinedRejectHandlerCheck(am[K],am[K+1])){
return true;
}
}
}
return false;
}
function PromiseHasUserDefinedRejectHandler(){
return PromiseHasUserDefinedRejectHandlerRecursive(this);
};
function PromiseSpecies(){
return this;
}
%AddNamedProperty(a,'Promise',v,2);
%AddNamedProperty(v.prototype,o,"Promise",
2|1);
b.InstallFunctions(v,2,[
"reject",PromiseReject,
"all",PromiseAll,
"race",PromiseRace,
"resolve",PromiseResolve
]);
b.InstallGetter(v,n,PromiseSpecies);
b.InstallFunctions(v.prototype,2,[
"then",PromiseThen,
"catch",PromiseCatch
]);
%InstallToContext([
"promise_catch",PromiseCatch,
"promise_create",PromiseCreate,
"promise_has_user_defined_reject_handler",PromiseHasUserDefinedRejectHandler,
"promise_reject",RejectPromise,
"promise_resolve",ResolvePromise,
"promise_then",PromiseThen,
"promise_create_rejected",PromiseCreateRejected,
"promise_create_resolved",PromiseCreateResolved
]);
b.InstallFunctions(c,0,[
"createPromise",PromiseCreate,
"resolvePromise",ResolvePromise,
"rejectPromise",RejectPromise
]);
b.Export(function(an){
an.PromiseCastResolved=PromiseCastResolved;
an.PromiseThen=PromiseThen;
an.GlobalPromise=v;
an.NewPromiseCapability=NewPromiseCapability;
an.PerformPromiseThen=PerformPromiseThen;
});
})

 messagesÕ	
(function(a,b){
%CheckIsBootstrapping();
var c=b.ImportNow("Script");
%FunctionSetInstanceClassName(c,'Script');
%AddNamedProperty(c.prototype,'constructor',c,
2|4|1);
function ScriptLocationFromPosition(position,
include_resource_offset){
return %ScriptPositionInfo(this,position,!!include_resource_offset);
}
function ScriptNameOrSourceURL(){
if(this.source_url)return this.source_url;
return this.name;
}
b.SetUpLockedPrototype(c,[
"source",
"name",
"source_url",
"source_mapping_url",
"line_offset",
"column_offset"
],[
"locationFromPosition",ScriptLocationFromPosition,
"nameOrSourceURL",ScriptNameOrSourceURL,
]
);
});

8array-iteratore%
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=
b.ImportNow("array_iteration_kind_symbol");
var d=
b.ImportNow("array_iterator_next_symbol");
var e=
b.ImportNow("array_iterator_object_symbol");
var f=a.Array;
var g=b.ImportNow("IteratorPrototype");
var h=b.ImportNow("iterator_symbol");
var i=b.ImportNow("to_string_tag_symbol");
var j=%object_get_prototype_of(a.Uint8Array);
function ArrayIterator(){}
function CreateArrayIterator(k,l){
var m=(%_ToObject(k));
var n=new ArrayIterator;
(n[e]=m);
(n[d]=0);
(n[c]=l);
return n;
}
function ArrayIteratorIterator(){
return this;
}
function ArrayIteratorNext(){
var n=this;
var o=(void 0);
var p=true;
if(!(%_IsJSReceiver(n))||
!(!(n[d]===(void 0)))){
throw %make_type_error(44,
'Array Iterator.prototype.next',this);
}
var k=(n[e]);
if(!(k===(void 0))){
var q=(n[d]);
var r=(n[c]);
var s=((k.length)>>>0);
if(q>=s){
(n[e]=(void 0));
}else{
(n[d]=q+1);
if(r==2){
o=k[q];
}else if(r==3){
o=[q,k[q]];
}else{
o=q;
}
p=false;
}
}
return %_CreateIterResultObject(o,p);
}
function ArrayEntries(){
return CreateArrayIterator(this,3);
}
function ArrayValues(){
return CreateArrayIterator(this,2);
}
function ArrayKeys(){
return CreateArrayIterator(this,1);
}
function TypedArrayEntries(){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
return %_Call(ArrayEntries,this);
}
function TypedArrayValues(){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
return %_Call(ArrayValues,this);
}
function TypedArrayKeys(){
if(!(%_IsTypedArray(this)))throw %make_type_error(72);
return %_Call(ArrayKeys,this);
}
%FunctionSetPrototype(ArrayIterator,{__proto__:g});
%FunctionSetInstanceClassName(ArrayIterator,'Array Iterator');
b.InstallFunctions(ArrayIterator.prototype,2,[
'next',ArrayIteratorNext
]);
b.SetFunctionName(ArrayIteratorIterator,h);
%AddNamedProperty(ArrayIterator.prototype,i,
"Array Iterator",1|2);
b.InstallFunctions(f.prototype,2,[
'entries',ArrayEntries,
'keys',ArrayKeys
]);
b.SetFunctionName(ArrayValues,'values');
%FunctionRemovePrototype(ArrayValues);
%SetNativeFlag(ArrayValues);
%AddNamedProperty(f.prototype,h,ArrayValues,
2);
b.InstallFunctions(j.prototype,2,[
'entries',TypedArrayEntries,
'keys',TypedArrayKeys,
'values',TypedArrayValues
]);
%AddNamedProperty(j.prototype,
h,TypedArrayValues,2);
b.Export(function(t){
t.ArrayValues=ArrayValues;
});
%InstallToContext(["array_values_iterator",ArrayValues]);
})

<string-iterator=
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.String;
var d=b.ImportNow("IteratorPrototype");
var e=b.ImportNow("iterator_symbol");
var f=
b.ImportNow("string_iterator_iterated_string_symbol");
var g=
b.ImportNow("string_iterator_next_index_symbol");
var h=b.ImportNow("to_string_tag_symbol");
function StringIterator(){}
function CreateStringIterator(i){
if((%IS_VAR(i)===null)||(i===(void 0)))throw %make_type_error(17,'String.prototype[Symbol.iterator]');
var j=(%_ToString(i));
var k=new StringIterator;
(k[f]=j);
(k[g]=0);
return k;
}
function StringIteratorNext(){
var k=this;
var l=(void 0);
var m=true;
if(!(%_IsJSReceiver(k))||
!(!(k[g]===(void 0)))){
throw %make_type_error(44,
'String Iterator.prototype.next');
}
var j=(k[f]);
if(!(j===(void 0))){
var n=(k[g]);
var o=((j.length)>>>0);
if(n>=o){
(k[f]=(void 0));
}else{
var p=%_StringCharCodeAt(j,n);
l=%_StringCharFromCode(p);
m=false;
n++;
if(p>=0xD800&&p<=0xDBFF&&n<o){
var q=%_StringCharCodeAt(j,n);
if(q>=0xDC00&&q<=0xDFFF){
l+=%_StringCharFromCode(q);
n++;
}
}
(k[g]=n);
}
}
return %_CreateIterResultObject(l,m);
}
function StringPrototypeIterator(){
return CreateStringIterator(this);
}
%FunctionSetPrototype(StringIterator,{__proto__:d});
%FunctionSetInstanceClassName(StringIterator,'String Iterator');
b.InstallFunctions(StringIterator.prototype,2,[
'next',StringIteratorNext
]);
%AddNamedProperty(StringIterator.prototype,h,
"String Iterator",1|2);
b.SetFunctionName(StringPrototypeIterator,e);
%AddNamedProperty(c.prototype,e,
StringPrototypeIterator,2);
})

$templates
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Map;
var d=b.InternalArray;
var e=new c;
var f=c.prototype.get;
var g=c.prototype.set;
function SameCallSiteElements(h,i){
var j=h.length;
var i=i.raw;
if(j!==i.length)return false;
for(var k=0;k<j;++k){
if(h[k]!==i[k])return false;
}
return true;
}
function GetCachedCallSite(l,m){
var n=%_Call(f,e,m);
if((n===(void 0)))return;
var j=n.length;
for(var k=0;k<j;++k){
if(SameCallSiteElements(l,n[k]))return n[k];
}
}
function SetCachedCallSite(l,m){
var n=%_Call(f,e,m);
var o;
if((n===(void 0))){
o=new d(1);
o[0]=l;
%_Call(g,e,m,o);
}else{
n.push(l);
}
return l;
}
function GetTemplateCallSite(l,h,m){
var p=GetCachedCallSite(h,m);
if(!(p===(void 0)))return p;
%AddNamedProperty(l,"raw",%object_freeze(h),
1|2|4);
return SetCachedCallSite(%object_freeze(l),m);
}
%InstallToContext(["get_template_call_site",GetTemplateCallSite]);
})

spread5
(function(a,b){
'use strict';
var c=b.InternalArray;
function SpreadArguments(){
var d=arguments.length;
var e=new c();
for(var f=0;f<d;++f){
var g=arguments[f];
var h=g.length;
for(var i=0;i<h;++i){
e.push(g[i]);
}
}
return e;
}
function SpreadIterable(j){
if((j==null)){
throw %make_type_error(70,j);
}
var e=new c();
for(var k of j){
e.push(k);
}
return e;
}
%InstallToContext([
"spread_arguments",SpreadArguments,
"spread_iterable",SpreadIterable,
]);
})

proxyΩ
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Proxy;
function ProxyCreateRevocable(d,e){
var f=new c(d,e);
return{proxy:f,revoke:()=>%JSProxyRevoke(f)};
}
b.InstallFunctions(c,2,[
"revocable",ProxyCreateRevocable
]);
})

i18nn
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c;
var d;
var e;
var f=a.Date;
var g=a.Number;
var h=a.RegExp;
var i=a.String;
var j=b.InstallFunctions;
var k=b.InstallGetter;
var l=b.InternalArray;
var m;
var n
var o;
var p=b.ImportNow("ObjectHasOwnProperty");
var q=b.OverrideFunction;
var r=b.ImportNow("intl_pattern_symbol");
var s=b.ImportNow("intl_resolved_symbol");
var t=b.SetFunctionName;
var u;
var v;
var w;
var x;
b.Import(function(y){
c=y.ArrayJoin;
d=y.ArrayPush;
o=y.IsNaN;
m=y.InternalRegExpMatch;
n=y.InternalRegExpReplace;
u=y.StringIndexOf;
v=y.StringLastIndexOf;
w=y.StringSubstr;
x=y.StringSubstring;
});
b.ImportFromExperimental(function(y){
e=y.FLAG_intl_extra;
});
function InstallFunction(z,A,B){
j(z,2,[A,B]);
}
function InstallConstructor(z,A,B){
%CheckIsBootstrapping();
t(B,A);
%AddNamedProperty(z,A,B,2);
%SetNativeFlag(B);
%ToFastProperties(z);
}
function AddBoundMethod(C,D,E,F,G){
%CheckIsBootstrapping();
var H=%CreatePrivateSymbol(D);
var I=(0,(function(){
if(!%IsInitializedIntlObjectOfType(this,G)){
throw %make_type_error(53,D);
}
if((this[H]===(void 0))){
var J;
if((F===(void 0))||F===2){
J=(0,((x,y)=>E(this,x,y)));
}else if(F===1){
J=(0,(x=>E(this,x)));
}else{
J=(0,((...args)=>{
if(args.length>0){
return E(this,args[0]);
}else{
return E(this);
}
}));
}
%SetNativeFlag(J);
this[H]=J;
}
return this[H];
}));
%FunctionRemovePrototype(I);
%DefineGetterPropertyUnchecked(C.prototype,D,I,2);
%SetNativeFlag(I);
}
var K={};
%AddNamedProperty(a,"Intl",K,2);
var L={
'collator':(void 0),
'numberformat':(void 0),
'dateformat':(void 0),
'breakiterator':(void 0)
};
var M=(void 0);
function GetDefaultICULocaleJS(){
if((M===(void 0))){
M=%GetDefaultICULocale();
}
return M;
}
var N=(void 0);
function GetUnicodeExtensionRE(){
if(((void 0)===(void 0))){
N=new h('-u(-[a-z0-9]{2,8})+','g');
}
return N;
}
var O=(void 0);
function GetAnyExtensionRE(){
if((O===(void 0))){
O=new h('-[a-z0-9]{1}-.*','g');
}
return O;
}
var P=(void 0);
function GetQuotedStringRE(){
if((P===(void 0))){
P=new h("'[^']+'",'g');
}
return P;
}
var Q=(void 0);
function GetServiceRE(){
if((Q===(void 0))){
Q=
new h('^(collator|numberformat|dateformat|breakiterator)$');
}
return Q;
}
var R=(void 0);
function GetLanguageTagRE(){
if((R===(void 0))){
BuildLanguageTagREs();
}
return R;
}
var S=(void 0);
function GetLanguageVariantRE(){
if((S===(void 0))){
BuildLanguageTagREs();
}
return S;
}
var T=(void 0);
function GetLanguageSingletonRE(){
if((T===(void 0))){
BuildLanguageTagREs();
}
return T;
}
var U=(void 0);
function GetTimezoneNameCheckRE(){
if((U===(void 0))){
U=new h(
'^([A-Za-z]+)/([A-Za-z_-]+)((?:\/[A-Za-z_-]+)+)*$');
}
return U;
}
var V=(void 0);
function GetTimezoneNameLocationPartRE(){
if((V===(void 0))){
V=
new h('^([A-Za-z]+)((?:[_-][A-Za-z]+)+)*$');
}
return V;
}
function supportedLocalesOf(W,X,Y){
if((m(GetServiceRE(),W)===null)){
throw %make_error(7,W);
}
if((Y===(void 0))){
Y={};
}else{
Y=(%_ToObject(Y));
}
var Z=Y.localeMatcher;
if(!(Z===(void 0))){
Z=(%_ToString(Z));
if(Z!=='lookup'&&Z!=='best fit'){
throw %make_range_error(174,Z);
}
}else{
Z='best fit';
}
var aa=initializeLocaleList(X);
if((L[W]===(void 0))){
L[W]=getAvailableLocalesOf(W);
}
if(Z==='best fit'){
return initializeLocaleList(bestFitSupportedLocalesOf(
aa,L[W]));
}
return initializeLocaleList(lookupSupportedLocalesOf(
aa,L[W]));
}
function lookupSupportedLocalesOf(aa,ab){
var ac=new l();
for(var ad=0;ad<aa.length;++ad){
var ae=n(
GetUnicodeExtensionRE(),aa[ad],'');
do{
if(!(ab[ae]===(void 0))){
%_Call(d,ac,aa[ad]);
break;
}
var af=%_Call(v,ae,'-');
if(af===-1){
break;
}
ae=%_Call(x,ae,0,af);
}while(true);
}
return ac;
}
function bestFitSupportedLocalesOf(aa,ab){
return lookupSupportedLocalesOf(aa,ab);
}
function getGetOption(Y,ag){
if((Y===(void 0)))throw %make_error(4,ag);
var ah=function getOption(ai,G,aj,ak){
if(!(Y[ai]===(void 0))){
var al=Y[ai];
switch(G){
case'boolean':
al=(!!(al));
break;
case'string':
al=(%_ToString(al));
break;
case'number':
al=(%_ToNumber(al));
break;
default:
throw %make_error(8);
}
if(!(aj===(void 0))&&%ArrayIndexOf(aj,al,0)===-1){
throw %make_range_error(184,al,ag,ai);
}
return al;
}
return ak;
}
return ah;
}
function resolveLocale(W,aa,Y){
aa=initializeLocaleList(aa);
var ah=getGetOption(Y,W);
var Z=ah('localeMatcher','string',
['lookup','best fit'],'best fit');
var am;
if(Z==='lookup'){
am=lookupMatcher(W,aa);
}else{
am=bestFitMatcher(W,aa);
}
return am;
}
function lookupMatcher(W,aa){
if((m(GetServiceRE(),W)===null)){
throw %make_error(7,W);
}
if((L[W]===(void 0))){
L[W]=getAvailableLocalesOf(W);
}
for(var ad=0;ad<aa.length;++ad){
var ae=n(
GetAnyExtensionRE(),aa[ad],'');
do{
if(!(L[W][ae]===(void 0))){
var an=m(
GetUnicodeExtensionRE(),aa[ad]);
var ao=(an===null)?'':an[0];
return{'locale':ae,'extension':ao,'position':ad};
}
var af=%_Call(v,ae,'-');
if(af===-1){
break;
}
ae=%_Call(x,ae,0,af);
}while(true);
}
return{'locale':GetDefaultICULocaleJS(),'extension':'','position':-1};
}
function bestFitMatcher(W,aa){
return lookupMatcher(W,aa);
}
function parseExtension(ao){
var ap=%StringSplit(ao,'-',4294967295);
if(ap.length<=2||
(ap[0]!==''&&ap[1]!=='u')){
return{};
}
var aq={};
var ar=(void 0);
var al=(void 0);
for(var ad=2;ad<ap.length;++ad){
var F=ap[ad].length;
var as=ap[ad];
if(F===2){
if(!(ar===(void 0))){
if(!(ar in aq)){
aq[ar]=al;
}
al=(void 0);
}
ar=as;
}else if(F>=3&&F<=8&&!(ar===(void 0))){
if((al===(void 0))){
al=as;
}else{
al=al+"-"+as;
}
}else{
return{};
}
}
if(!(ar===(void 0))&&!(ar in aq)){
aq[ar]=al;
}
return aq;
}
function setOptions(at,aq,au,ah,av){
var ao='';
var aw=function updateExtension(ar,al){
return'-'+ar+'-'+(%_ToString(al));
}
var ax=function updateProperty(ai,G,al){
if(G==='boolean'&&(typeof al==='string')){
al=(al==='true')?true:false;
}
if(!(ai===(void 0))){
defineWEProperty(av,ai,al);
}
}
for(var ar in au){
if((%_Call(p,au,ar))){
var al=(void 0);
var ay=au[ar];
if(!(ay.property===(void 0))){
al=ah(ay.property,ay.type,ay.values);
}
if(!(al===(void 0))){
ax(ay.property,ay.type,al);
ao+=aw(ar,al);
continue;
}
if((%_Call(p,aq,ar))){
al=aq[ar];
if(!(al===(void 0))){
ax(ay.property,ay.type,al);
ao+=aw(ar,al);
}else if(ay.type==='boolean'){
ax(ay.property,ay.type,true);
ao+=aw(ar,true);
}
}
}
}
return ao===''?'':'-u'+ao;
}
function freezeArray(az){
var aA=[];
var aB=az.length;
for(var ad=0;ad<aB;ad++){
if(ad in az){
%object_define_property(aA,ad,{value:az[ad],
configurable:false,
writable:false,
enumerable:true});
}
}
%object_define_property(aA,'length',{value:aB,writable:false});
return aA;
}
function makeArray(az){
var aA=[];
%MoveArrayContents(az,aA);
return aA;
}
function getOptimalLanguageTag(aC,am){
if(aC===am){
return aC;
}
var X=%GetLanguageTagVariants([aC,am]);
if(X[0].maximized!==X[1].maximized){
return am;
}
var aD=new h('^'+X[1].base,'g');
return n(aD,am,X[0].base);
}
function getAvailableLocalesOf(W){
var aE=%AvailableLocalesOf(W);
for(var ad in aE){
if((%_Call(p,aE,ad))){
var aF=m(
/^([a-z]{2,3})-([A-Z][a-z]{3})-([A-Z]{2})$/,ad);
if(!(aF===null)){
aE[aF[1]+'-'+aF[3]]=null;
}
}
}
return aE;
}
function defineWEProperty(z,ai,al){
%object_define_property(z,ai,
{value:al,writable:true,enumerable:true});
}
function addWEPropertyIfDefined(z,ai,al){
if(!(al===(void 0))){
defineWEProperty(z,ai,al);
}
}
function defineWECProperty(z,ai,al){
%object_define_property(z,ai,{value:al,
writable:true,
enumerable:true,
configurable:true});
}
function addWECPropertyIfDefined(z,ai,al){
if(!(al===(void 0))){
defineWECProperty(z,ai,al);
}
}
function toTitleCaseWord(aG){
return %StringToUpperCase(%_Call(w,aG,0,1))+
%StringToLowerCase(%_Call(w,aG,1));
}
function toTitleCaseTimezoneLocation(aH){
var aI=m(GetTimezoneNameLocationPartRE(),aH)
if((aI===null))throw %make_range_error(151,aH);
var aJ=toTitleCaseWord(aI[1]);
if(!(aI[2]===(void 0))&&2<aI.length){
var aK=%_Call(x,aI[2],0,1);
var aF=%StringSplit(aI[2],aK,4294967295);
for(var ad=1;ad<aF.length;ad++){
var aL=aF[ad]
var aM=%StringToLowerCase(aL);
aJ=aJ+aK+
((aM!=='es'&&
aM!=='of'&&aM!=='au')?
toTitleCaseWord(aL):aM);
}
}
return aJ;
}
function canonicalizeLanguageTag(aN){
if((!(typeof(aN)==='string')&&!(%_IsJSReceiver(aN)))||
(aN===null)){
throw %make_type_error(52);
}
if((typeof(aN)==='string')&&
!(m(/^[a-z]{2,3}$/,aN)===null)){
return aN;
}
var aO=(%_ToString(aN));
if(isStructuallyValidLanguageTag(aO)===false){
throw %make_range_error(163,aO);
}
var aP=%CanonicalizeLanguageTag(aO);
if(aP==='invalid-tag'){
throw %make_range_error(163,aO);
}
return aP;
}
function canonicalizeLocaleList(X){
var aQ=new l();
if(!(X===(void 0))){
if(typeof X==='string'){
%_Call(d,aQ,canonicalizeLanguageTag(X));
return aQ;
}
var aR=(%_ToObject(X));
var aS=(%_ToLength(aR.length));
for(var aT=0;aT<aS;aT++){
if(aT in aR){
var al=aR[aT];
var aP=canonicalizeLanguageTag(al);
if(%ArrayIndexOf(aQ,aP,0)===-1){
%_Call(d,aQ,aP);
}
}
}
}
return aQ;
}
function initializeLocaleList(X){
return freezeArray(canonicalizeLocaleList(X));
}
function isStructuallyValidLanguageTag(ae){
if((m(GetLanguageTagRE(),ae)===null)){
return false;
}
if(%_Call(u,ae,'x-')===0){
return true;
}
ae=%StringSplit(ae,'-x-',4294967295)[0];
var aU=new l();
var aV=new l();
var aF=%StringSplit(ae,'-',4294967295);
for(var ad=1;ad<aF.length;ad++){
var al=aF[ad];
if(!(m(GetLanguageVariantRE(),al)===null)&&
aV.length===0){
if(%ArrayIndexOf(aU,al,0)===-1){
%_Call(d,aU,al);
}else{
return false;
}
}
if(!(m(GetLanguageSingletonRE(),al)===null)){
if(%ArrayIndexOf(aV,al,0)===-1){
%_Call(d,aV,al);
}else{
return false;
}
}
}
return true;
}
function BuildLanguageTagREs(){
var aW='[a-zA-Z]';
var aX='[0-9]';
var aY='('+aW+'|'+aX+')';
var aZ='(art-lojban|cel-gaulish|no-bok|no-nyn|zh-guoyu|zh-hakka|'+
'zh-min|zh-min-nan|zh-xiang)';
var ba='(en-GB-oed|i-ami|i-bnn|i-default|i-enochian|i-hak|'+
'i-klingon|i-lux|i-mingo|i-navajo|i-pwn|i-tao|i-tay|'+
'i-tsu|sgn-BE-FR|sgn-BE-NL|sgn-CH-DE)';
var bb='('+ba+'|'+aZ+')';
var bc='(x(-'+aY+'{1,8})+)';
var bd='('+aX+'|[A-WY-Za-wy-z])';
T=new h('^'+bd+'$','i');
var ao='('+bd+'(-'+aY+'{2,8})+)';
var be='('+aY+'{5,8}|('+aX+aY+'{3}))';
S=new h('^'+be+'$','i');
var bf='('+aW+'{2}|'+aX+'{3})';
var bg='('+aW+'{4})';
var bh='('+aW+'{3}(-'+aW+'{3}){0,2})';
var bi='('+aW+'{2,3}(-'+bh+')?|'+aW+'{4}|'+
aW+'{5,8})';
var bj=bi+'(-'+bg+')?(-'+bf+')?(-'+
be+')*(-'+ao+')*(-'+bc+')?';
var bk=
'^('+bj+'|'+bc+'|'+bb+')$';
R=new h(bk,'i');
}
var bl={
get(){
%IncrementUseCounter(16);
return this[s];
},
set(al){
this[s]=al;
}
};
InstallFunction(K,'getCanonicalLocales',function(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
return makeArray(canonicalizeLocaleList(X));
}
);
function initializeCollator(bm,X,Y){
if(%IsInitializedIntlObject(bm)){
throw %make_type_error(125,"Collator");
}
if((Y===(void 0))){
Y={};
}
var ah=getGetOption(Y,'collator');
var bn={};
defineWEProperty(bn,'usage',ah(
'usage','string',['sort','search'],'sort'));
var bo=ah('sensitivity','string',
['base','accent','case','variant']);
if((bo===(void 0))&&bn.usage==='sort'){
bo='variant';
}
defineWEProperty(bn,'sensitivity',bo);
defineWEProperty(bn,'ignorePunctuation',ah(
'ignorePunctuation','boolean',(void 0),false));
var ae=resolveLocale('collator',X,Y);
var aq=parseExtension(ae.extension);
var bp={
'kn':{'property':'numeric','type':'boolean'},
'kf':{'property':'caseFirst','type':'string',
'values':['false','lower','upper']}
};
setOptions(
Y,aq,bp,ah,bn);
var bq='default';
var ao='';
if((%_Call(p,aq,'co'))&&bn.usage==='sort'){
var br=[
'big5han','dict','direct','ducet','gb2312','phonebk','phonetic',
'pinyin','reformed','searchjl','stroke','trad','unihan','zhuyin'
];
if(%ArrayIndexOf(br,aq.co,0)!==-1){
ao='-u-co-'+aq.co;
bq=aq.co;
}
}else if(bn.usage==='search'){
ao='-u-co-search';
}
defineWEProperty(bn,'collation',bq);
var bs=ae.locale+ao;
var am=%object_define_properties({},{
caseFirst:{writable:true},
collation:{value:bn.collation,writable:true},
ignorePunctuation:{writable:true},
locale:{writable:true},
numeric:{writable:true},
requestedLocale:{value:bs,writable:true},
sensitivity:{writable:true},
strength:{writable:true},
usage:{value:bn.usage,writable:true}
});
var bt=%CreateCollator(bs,
bn,
am);
%MarkAsInitializedIntlObjectOfType(bm,'collator',bt);
bm[s]=am;
if(e){
%object_define_property(bm,'resolved',bl);
}
return bm;
}
InstallConstructor(K,'Collator',function(){
var X=arguments[0];
var Y=arguments[1];
if(!this||this===K){
return new K.Collator(X,Y);
}
return initializeCollator((%_ToObject(this)),X,Y);
}
);
InstallFunction(K.Collator.prototype,'resolvedOptions',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if(!%IsInitializedIntlObjectOfType(this,'collator')){
throw %make_type_error(126,"Collator");
}
var bu=this;
var ae=getOptimalLanguageTag(bu[s].requestedLocale,
bu[s].locale);
return{
locale:ae,
usage:bu[s].usage,
sensitivity:bu[s].sensitivity,
ignorePunctuation:bu[s].ignorePunctuation,
numeric:bu[s].numeric,
caseFirst:bu[s].caseFirst,
collation:bu[s].collation
};
}
);
InstallFunction(K.Collator,'supportedLocalesOf',function(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
return supportedLocalesOf('collator',X,arguments[1]);
}
);
function compare(bm,bv,bw){
return %InternalCompare(%GetImplFromInitializedIntlObject(bm),
(%_ToString(bv)),(%_ToString(bw)));
};
AddBoundMethod(K.Collator,'compare',compare,2,'collator');
function isWellFormedCurrencyCode(bx){
return typeof bx=="string"&&bx.length==3&&
(m(/[^A-Za-z]/,bx)===null);
}
function getNumberOption(Y,ai,by,bz,bA){
var al=Y[ai];
if(!(al===(void 0))){
al=(%_ToNumber(al));
if((!%_IsSmi(%IS_VAR(al))&&!(al==al))||al<by||al>bz){
throw %make_range_error(177,ai);
}
return %math_floor(al);
}
return bA;
}
var bB={
get(){
%IncrementUseCounter(15);
return this[r];
},
set(al){
this[r]=al;
}
};
function initializeNumberFormat(bC,X,Y){
if(%IsInitializedIntlObject(bC)){
throw %make_type_error(125,"NumberFormat");
}
if((Y===(void 0))){
Y={};
}
var ah=getGetOption(Y,'numberformat');
var ae=resolveLocale('numberformat',X,Y);
var bn={};
defineWEProperty(bn,'style',ah(
'style','string',['decimal','percent','currency'],'decimal'));
var bx=ah('currency','string');
if(!(bx===(void 0))&&!isWellFormedCurrencyCode(bx)){
throw %make_range_error(158,bx);
}
if(bn.style==='currency'&&(bx===(void 0))){
throw %make_type_error(29);
}
var bD=ah(
'currencyDisplay','string',['code','symbol','name'],'symbol');
if(bn.style==='currency'){
defineWEProperty(bn,'currency',%StringToUpperCase(bx));
defineWEProperty(bn,'currencyDisplay',bD);
}
var bE=getNumberOption(Y,'minimumIntegerDigits',1,21,1);
defineWEProperty(bn,'minimumIntegerDigits',bE);
var bF=Y['minimumFractionDigits'];
var bG=Y['maximumFractionDigits'];
if(!(bF===(void 0))||bn.style!=='currency'){
bF=getNumberOption(Y,'minimumFractionDigits',0,20,0);
defineWEProperty(bn,'minimumFractionDigits',bF);
}
if(!(bG===(void 0))||bn.style!=='currency'){
var bH=bn.style==='percent'?0:3;
bF=(bF===(void 0))?0:bF;
var bI=(bF>bH)?bF:bH;
bG=getNumberOption(Y,'maximumFractionDigits',bF,20,bI);
defineWEProperty(bn,'maximumFractionDigits',bG);
}
var bJ=Y['minimumSignificantDigits'];
var bK=Y['maximumSignificantDigits'];
if(!(bJ===(void 0))||!(bK===(void 0))){
bJ=getNumberOption(Y,'minimumSignificantDigits',1,21,0);
defineWEProperty(bn,'minimumSignificantDigits',bJ);
bK=getNumberOption(Y,'maximumSignificantDigits',bJ,21,21);
defineWEProperty(bn,'maximumSignificantDigits',bK);
}
defineWEProperty(bn,'useGrouping',ah(
'useGrouping','boolean',(void 0),true));
var aq=parseExtension(ae.extension);
var bL={
'nu':{'property':(void 0),'type':'string'}
};
var ao=setOptions(Y,aq,bL,
ah,bn);
var bs=ae.locale+ao;
var am=%object_define_properties({},{
currency:{writable:true},
currencyDisplay:{writable:true},
locale:{writable:true},
maximumFractionDigits:{writable:true},
minimumFractionDigits:{writable:true},
minimumIntegerDigits:{writable:true},
numberingSystem:{writable:true},
requestedLocale:{value:bs,writable:true},
style:{value:bn.style,writable:true},
useGrouping:{writable:true}
});
if((%_Call(p,bn,'minimumSignificantDigits'))){
defineWEProperty(am,'minimumSignificantDigits',(void 0));
}
if((%_Call(p,bn,'maximumSignificantDigits'))){
defineWEProperty(am,'maximumSignificantDigits',(void 0));
}
var bM=%CreateNumberFormat(bs,
bn,
am);
if(bn.style==='currency'){
%object_define_property(am,'currencyDisplay',
{value:bD,writable:true});
}
%MarkAsInitializedIntlObjectOfType(bC,'numberformat',bM);
bC[s]=am;
if(e){
%object_define_property(am,'pattern',bB);
%object_define_property(bC,'resolved',bl);
}
return bC;
}
InstallConstructor(K,'NumberFormat',function(){
var X=arguments[0];
var Y=arguments[1];
if(!this||this===K){
return new K.NumberFormat(X,Y);
}
return initializeNumberFormat((%_ToObject(this)),X,Y);
}
);
InstallFunction(K.NumberFormat.prototype,'resolvedOptions',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if(!%IsInitializedIntlObjectOfType(this,'numberformat')){
throw %make_type_error(126,"NumberFormat");
}
var bN=this;
var ae=getOptimalLanguageTag(bN[s].requestedLocale,
bN[s].locale);
var aJ={
locale:ae,
numberingSystem:bN[s].numberingSystem,
style:bN[s].style,
useGrouping:bN[s].useGrouping,
minimumIntegerDigits:bN[s].minimumIntegerDigits,
minimumFractionDigits:bN[s].minimumFractionDigits,
maximumFractionDigits:bN[s].maximumFractionDigits,
};
if(aJ.style==='currency'){
defineWECProperty(aJ,'currency',bN[s].currency);
defineWECProperty(aJ,'currencyDisplay',
bN[s].currencyDisplay);
}
if((%_Call(p,bN[s],'minimumSignificantDigits'))){
defineWECProperty(aJ,'minimumSignificantDigits',
bN[s].minimumSignificantDigits);
}
if((%_Call(p,bN[s],'maximumSignificantDigits'))){
defineWECProperty(aJ,'maximumSignificantDigits',
bN[s].maximumSignificantDigits);
}
return aJ;
}
);
InstallFunction(K.NumberFormat,'supportedLocalesOf',function(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
return supportedLocalesOf('numberformat',X,arguments[1]);
}
);
function formatNumber(bM,al){
var bO=(%_ToNumber(al))+0;
return %InternalNumberFormat(%GetImplFromInitializedIntlObject(bM),
bO);
}
function IntlParseNumber(bM,al){
return %InternalNumberParse(%GetImplFromInitializedIntlObject(bM),
(%_ToString(al)));
}
AddBoundMethod(K.NumberFormat,'format',formatNumber,1,'numberformat');
function toLDMLString(Y){
var ah=getGetOption(Y,'dateformat');
var bP='';
var bQ=ah('weekday','string',['narrow','short','long']);
bP+=appendToLDMLString(
bQ,{narrow:'EEEEE',short:'EEE',long:'EEEE'});
bQ=ah('era','string',['narrow','short','long']);
bP+=appendToLDMLString(
bQ,{narrow:'GGGGG',short:'GGG',long:'GGGG'});
bQ=ah('year','string',['2-digit','numeric']);
bP+=appendToLDMLString(bQ,{'2-digit':'yy','numeric':'y'});
bQ=ah('month','string',
['2-digit','numeric','narrow','short','long']);
bP+=appendToLDMLString(bQ,{'2-digit':'MM','numeric':'M',
'narrow':'MMMMM','short':'MMM','long':'MMMM'});
bQ=ah('day','string',['2-digit','numeric']);
bP+=appendToLDMLString(
bQ,{'2-digit':'dd','numeric':'d'});
var bR=ah('hour12','boolean');
bQ=ah('hour','string',['2-digit','numeric']);
if((bR===(void 0))){
bP+=appendToLDMLString(bQ,{'2-digit':'jj','numeric':'j'});
}else if(bR===true){
bP+=appendToLDMLString(bQ,{'2-digit':'hh','numeric':'h'});
}else{
bP+=appendToLDMLString(bQ,{'2-digit':'HH','numeric':'H'});
}
bQ=ah('minute','string',['2-digit','numeric']);
bP+=appendToLDMLString(bQ,{'2-digit':'mm','numeric':'m'});
bQ=ah('second','string',['2-digit','numeric']);
bP+=appendToLDMLString(bQ,{'2-digit':'ss','numeric':'s'});
bQ=ah('timeZoneName','string',['short','long']);
bP+=appendToLDMLString(bQ,{short:'z',long:'zzzz'});
return bP;
}
function appendToLDMLString(bQ,bS){
if(!(bQ===(void 0))){
return bS[bQ];
}else{
return'';
}
}
function fromLDMLString(bP){
bP=n(GetQuotedStringRE(),bP,'');
var Y={};
var aI=m(/E{3,5}/,bP);
Y=appendToDateTimeObject(
Y,'weekday',aI,{EEEEE:'narrow',EEE:'short',EEEE:'long'});
aI=m(/G{3,5}/,bP);
Y=appendToDateTimeObject(
Y,'era',aI,{GGGGG:'narrow',GGG:'short',GGGG:'long'});
aI=m(/y{1,2}/,bP);
Y=appendToDateTimeObject(
Y,'year',aI,{y:'numeric',yy:'2-digit'});
aI=m(/M{1,5}/,bP);
Y=appendToDateTimeObject(Y,'month',aI,{MM:'2-digit',
M:'numeric',MMMMM:'narrow',MMM:'short',MMMM:'long'});
aI=m(/L{1,5}/,bP);
Y=appendToDateTimeObject(Y,'month',aI,{LL:'2-digit',
L:'numeric',LLLLL:'narrow',LLL:'short',LLLL:'long'});
aI=m(/d{1,2}/,bP);
Y=appendToDateTimeObject(
Y,'day',aI,{d:'numeric',dd:'2-digit'});
aI=m(/h{1,2}/,bP);
if(aI!==null){
Y['hour12']=true;
}
Y=appendToDateTimeObject(
Y,'hour',aI,{h:'numeric',hh:'2-digit'});
aI=m(/H{1,2}/,bP);
if(aI!==null){
Y['hour12']=false;
}
Y=appendToDateTimeObject(
Y,'hour',aI,{H:'numeric',HH:'2-digit'});
aI=m(/m{1,2}/,bP);
Y=appendToDateTimeObject(
Y,'minute',aI,{m:'numeric',mm:'2-digit'});
aI=m(/s{1,2}/,bP);
Y=appendToDateTimeObject(
Y,'second',aI,{s:'numeric',ss:'2-digit'});
aI=m(/z|zzzz/,bP);
Y=appendToDateTimeObject(
Y,'timeZoneName',aI,{z:'short',zzzz:'long'});
return Y;
}
function appendToDateTimeObject(Y,bQ,aI,bS){
if((aI===null)){
if(!(%_Call(p,Y,bQ))){
defineWEProperty(Y,bQ,(void 0));
}
return Y;
}
var ai=aI[0];
defineWEProperty(Y,bQ,bS[ai]);
return Y;
}
function toDateTimeOptions(Y,bT,bU){
if((Y===(void 0))){
Y={};
}else{
Y=(%_ToObject(Y));
}
var bV=true;
if((bT==='date'||bT==='any')&&
(!(Y.weekday===(void 0))||!(Y.year===(void 0))||
!(Y.month===(void 0))||!(Y.day===(void 0)))){
bV=false;
}
if((bT==='time'||bT==='any')&&
(!(Y.hour===(void 0))||!(Y.minute===(void 0))||
!(Y.second===(void 0)))){
bV=false;
}
if(bV&&(bU==='date'||bU==='all')){
%object_define_property(Y,'year',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
%object_define_property(Y,'month',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
%object_define_property(Y,'day',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
if(bV&&(bU==='time'||bU==='all')){
%object_define_property(Y,'hour',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
%object_define_property(Y,'minute',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
%object_define_property(Y,'second',{value:'numeric',
writable:true,
enumerable:true,
configurable:true});
}
return Y;
}
function initializeDateTimeFormat(bW,X,Y){
if(%IsInitializedIntlObject(bW)){
throw %make_type_error(125,"DateTimeFormat");
}
if((Y===(void 0))){
Y={};
}
var ae=resolveLocale('dateformat',X,Y);
Y=toDateTimeOptions(Y,'any','date');
var ah=getGetOption(Y,'dateformat');
var Z=ah('formatMatcher','string',
['basic','best fit'],'best fit');
var bP=toLDMLString(Y);
var bX=canonicalizeTimeZoneID(Y.timeZone);
var bn={};
var aq=parseExtension(ae.extension);
var bY={
'ca':{'property':(void 0),'type':'string'},
'nu':{'property':(void 0),'type':'string'}
};
var ao=setOptions(Y,aq,bY,
ah,bn);
var bs=ae.locale+ao;
var am=%object_define_properties({},{
calendar:{writable:true},
day:{writable:true},
era:{writable:true},
hour12:{writable:true},
hour:{writable:true},
locale:{writable:true},
minute:{writable:true},
month:{writable:true},
numberingSystem:{writable:true},
[r]:{writable:true},
requestedLocale:{value:bs,writable:true},
second:{writable:true},
timeZone:{writable:true},
timeZoneName:{writable:true},
tz:{value:bX,writable:true},
weekday:{writable:true},
year:{writable:true}
});
var bM=%CreateDateTimeFormat(
bs,{skeleton:bP,timeZone:bX},am);
if(am.timeZone==="Etc/Unknown"){
throw %make_range_error(183,bX);
}
%MarkAsInitializedIntlObjectOfType(bW,'dateformat',bM);
bW[s]=am;
if(e){
%object_define_property(am,'pattern',bB);
%object_define_property(bW,'resolved',bl);
}
return bW;
}
InstallConstructor(K,'DateTimeFormat',function(){
var X=arguments[0];
var Y=arguments[1];
if(!this||this===K){
return new K.DateTimeFormat(X,Y);
}
return initializeDateTimeFormat((%_ToObject(this)),X,Y);
}
);
InstallFunction(K.DateTimeFormat.prototype,'resolvedOptions',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if(!%IsInitializedIntlObjectOfType(this,'dateformat')){
throw %make_type_error(126,"DateTimeFormat");
}
var bZ={
'gregorian':'gregory',
'ethiopic-amete-alem':'ethioaa'
};
var bN=this;
var ca=fromLDMLString(bN[s][r]);
var cb=bZ[bN[s].calendar];
if((cb===(void 0))){
cb=bN[s].calendar;
}
var ae=getOptimalLanguageTag(bN[s].requestedLocale,
bN[s].locale);
var aJ={
locale:ae,
numberingSystem:bN[s].numberingSystem,
calendar:cb,
timeZone:bN[s].timeZone
};
addWECPropertyIfDefined(aJ,'timeZoneName',ca.timeZoneName);
addWECPropertyIfDefined(aJ,'era',ca.era);
addWECPropertyIfDefined(aJ,'year',ca.year);
addWECPropertyIfDefined(aJ,'month',ca.month);
addWECPropertyIfDefined(aJ,'day',ca.day);
addWECPropertyIfDefined(aJ,'weekday',ca.weekday);
addWECPropertyIfDefined(aJ,'hour12',ca.hour12);
addWECPropertyIfDefined(aJ,'hour',ca.hour);
addWECPropertyIfDefined(aJ,'minute',ca.minute);
addWECPropertyIfDefined(aJ,'second',ca.second);
return aJ;
}
);
InstallFunction(K.DateTimeFormat,'supportedLocalesOf',function(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
return supportedLocalesOf('dateformat',X,arguments[1]);
}
);
function formatDate(bM,cc){
var cd;
if((cc===(void 0))){
cd=%DateCurrentTime();
}else{
cd=(%_ToNumber(cc));
}
if(!(%_IsSmi(%IS_VAR(cd))||((cd==cd)&&(cd!=1/0)&&(cd!=-1/0))))throw %make_range_error(149);
return %InternalDateFormat(%GetImplFromInitializedIntlObject(bM),
new f(cd));
}
function IntlParseDate(bM,al){
return %InternalDateParse(%GetImplFromInitializedIntlObject(bM),
(%_ToString(al)));
}
AddBoundMethod(K.DateTimeFormat,'format',formatDate,0,'dateformat');
function canonicalizeTimeZoneID(ce){
if((ce===(void 0))){
return ce;
}
ce=(%_ToString(ce));
var cf=%StringToUpperCase(ce);
if(cf==='UTC'||cf==='GMT'||
cf==='ETC/UTC'||cf==='ETC/GMT'){
return'UTC';
}
var aI=m(GetTimezoneNameCheckRE(),ce);
if((aI===null))throw %make_range_error(150,ce);
var aJ=toTitleCaseTimezoneLocation(aI[1])+'/'+
toTitleCaseTimezoneLocation(aI[2]);
if(!(aI[3]===(void 0))&&3<aI.length){
var cg=%StringSplit(aI[3],'/',4294967295);
for(var ad=1;ad<cg.length;ad++){
aJ=aJ+'/'+toTitleCaseTimezoneLocation(cg[ad]);
}
}
return aJ;
}
function initializeBreakIterator(ch,X,Y){
if(%IsInitializedIntlObject(ch)){
throw %make_type_error(125,"v8BreakIterator");
}
if((Y===(void 0))){
Y={};
}
var ah=getGetOption(Y,'breakiterator');
var bn={};
defineWEProperty(bn,'type',ah(
'type','string',['character','word','sentence','line'],'word'));
var ae=resolveLocale('breakiterator',X,Y);
var am=%object_define_properties({},{
requestedLocale:{value:ae.locale,writable:true},
type:{value:bn.type,writable:true},
locale:{writable:true}
});
var ci=%CreateBreakIterator(ae.locale,
bn,
am);
%MarkAsInitializedIntlObjectOfType(ch,'breakiterator',
ci);
ch[s]=am;
if(e){
%object_define_property(ch,'resolved',bl);
}
return ch;
}
InstallConstructor(K,'v8BreakIterator',function(){
var X=arguments[0];
var Y=arguments[1];
if(!this||this===K){
return new K.v8BreakIterator(X,Y);
}
return initializeBreakIterator((%_ToObject(this)),X,Y);
}
);
InstallFunction(K.v8BreakIterator.prototype,'resolvedOptions',
function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if(!%IsInitializedIntlObjectOfType(this,'breakiterator')){
throw %make_type_error(126,"v8BreakIterator");
}
var cj=this;
var ae=
getOptimalLanguageTag(cj[s].requestedLocale,
cj[s].locale);
return{
locale:ae,
type:cj[s].type
};
}
);
InstallFunction(K.v8BreakIterator,'supportedLocalesOf',
function(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
return supportedLocalesOf('breakiterator',X,arguments[1]);
}
);
function adoptText(ch,ck){
%BreakIteratorAdoptText(%GetImplFromInitializedIntlObject(ch),
(%_ToString(ck)));
}
function first(ch){
return %BreakIteratorFirst(%GetImplFromInitializedIntlObject(ch));
}
function next(ch){
return %BreakIteratorNext(%GetImplFromInitializedIntlObject(ch));
}
function current(ch){
return %BreakIteratorCurrent(%GetImplFromInitializedIntlObject(ch));
}
function breakType(ch){
return %BreakIteratorBreakType(%GetImplFromInitializedIntlObject(ch));
}
AddBoundMethod(K.v8BreakIterator,'adoptText',adoptText,1,
'breakiterator');
AddBoundMethod(K.v8BreakIterator,'first',first,0,'breakiterator');
AddBoundMethod(K.v8BreakIterator,'next',next,0,'breakiterator');
AddBoundMethod(K.v8BreakIterator,'current',current,0,'breakiterator');
AddBoundMethod(K.v8BreakIterator,'breakType',breakType,0,
'breakiterator');
var cl={
'collator':K.Collator,
'numberformat':K.NumberFormat,
'dateformatall':K.DateTimeFormat,
'dateformatdate':K.DateTimeFormat,
'dateformattime':K.DateTimeFormat
};
var cm={
'collator':(void 0),
'numberformat':(void 0),
'dateformatall':(void 0),
'dateformatdate':(void 0),
'dateformattime':(void 0),
};
function clearDefaultObjects(){
cm['dateformatall']=(void 0);
cm['dateformatdate']=(void 0);
cm['dateformattime']=(void 0);
}
var cn=0;
function checkDateCacheCurrent(){
var co=%DateCacheVersion();
if(co==cn){
return;
}
cn=co;
clearDefaultObjects();
}
function cachedOrNewService(W,X,Y,bU){
var cp=((bU===(void 0)))?Y:bU;
if((X===(void 0))&&(Y===(void 0))){
checkDateCacheCurrent();
if((cm[W]===(void 0))){
cm[W]=new cl[W](X,cp);
}
return cm[W];
}
return new cl[W](X,cp);
}
function LocaleConvertCase(cq,X,cr){
var bi;
if((X===(void 0))){
bi=GetDefaultICULocaleJS();
}else if((typeof(X)==='string')){
bi=canonicalizeLanguageTag(X);
}else{
var X=initializeLocaleList(X);
bi=X.length>0?X[0]:GetDefaultICULocaleJS();
}
var af=%_Call(u,bi,'-');
if(af!=-1){
bi=%_Call(x,bi,0,af);
}
var cs=['az','el','lt','tr'];
var ct=%ArrayIndexOf(cs,bi,0);
if(ct==-1){
return cr?%StringToUpperCaseI18N(cq):%StringToLowerCaseI18N(cq);
}
return %StringLocaleConvertCase(cq,cr,
cs[ct]);
}
q(i.prototype,'localeCompare',function(cu){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((this==null)){
throw %make_type_error(54);
}
var X=arguments[1];
var Y=arguments[2];
var bm=cachedOrNewService('collator',X,Y);
return compare(bm,this,cu);
}
);
q(i.prototype,'normalize',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.normalize");
var cq=(%_ToString(this));
var cv=arguments[0];
var cw=(cv===(void 0))?'NFC':(%_ToString(cv));
var cx=['NFC','NFD','NFKC','NFKD'];
var cy=%ArrayIndexOf(cx,cw,0);
if(cy===-1){
throw %make_range_error(175,
%_Call(c,cx,', '));
}
return %StringNormalize(cq,cy);
}
);
function ToLowerCaseI18N(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLowerCase");
var cq=(%_ToString(this));
return %StringToLowerCaseI18N(cq);
}
function ToUpperCaseI18N(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toUpperCase");
var cq=(%_ToString(this));
return %StringToUpperCaseI18N(cq);
}
function ToLocaleLowerCaseI18N(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLocaleLowerCase");
return LocaleConvertCase((%_ToString(this)),X,false);
}
%FunctionSetLength(ToLocaleLowerCaseI18N,0);
function ToLocaleUpperCaseI18N(X){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.toLocaleUpperCase");
return LocaleConvertCase((%_ToString(this)),X,true);
}
%FunctionSetLength(ToLocaleUpperCaseI18N,0);
%FunctionRemovePrototype(ToLowerCaseI18N);
%FunctionRemovePrototype(ToUpperCaseI18N);
%FunctionRemovePrototype(ToLocaleLowerCaseI18N);
%FunctionRemovePrototype(ToLocaleUpperCaseI18N);
b.Export(function(cz){
cz.ToLowerCaseI18N=ToLowerCaseI18N;
cz.ToUpperCaseI18N=ToUpperCaseI18N;
cz.ToLocaleLowerCaseI18N=ToLocaleLowerCaseI18N;
cz.ToLocaleUpperCaseI18N=ToLocaleUpperCaseI18N;
});
q(g.prototype,'toLocaleString',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
if(!(this instanceof g)&&typeof(this)!=='number'){
throw %make_type_error(55,"Number");
}
var X=arguments[0];
var Y=arguments[1];
var bC=cachedOrNewService('numberformat',X,Y);
return formatNumber(bC,this);
}
);
function toLocaleDateTime(cA,X,Y,bT,bU,W){
if(!(cA instanceof f)){
throw %make_type_error(55,"Date");
}
if(o(cA))return'Invalid Date';
var bn=toDateTimeOptions(Y,bT,bU);
var bW=
cachedOrNewService(W,X,Y,bn);
return formatDate(bW,cA);
}
q(f.prototype,'toLocaleString',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
var X=arguments[0];
var Y=arguments[1];
return toLocaleDateTime(
this,X,Y,'any','all','dateformatall');
}
);
q(f.prototype,'toLocaleDateString',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
var X=arguments[0];
var Y=arguments[1];
return toLocaleDateTime(
this,X,Y,'date','date','dateformatdate');
}
);
q(f.prototype,'toLocaleTimeString',function(){
if(!(new.target===(void 0))){
throw %make_type_error(81);
}
var X=arguments[0];
var Y=arguments[1];
return toLocaleDateTime(
this,X,Y,'time','time','dateformattime');
}
);
b.Export(function(cz){
cz.AddBoundMethod=AddBoundMethod;
cz.IntlParseDate=IntlParseDate;
cz.IntlParseNumber=IntlParseNumber;
});
})

 Lharmony-async-await’
(function(a,b,c){
"use strict";
%CheckIsBootstrapping();
var d;
var e;
var f;
var g;
var h;
var i;
b.Import(function(j){
d=j.AsyncFunctionNext;
e=j.AsyncFunctionThrow;
f=j.GlobalPromise;
g=j.NewPromiseCapability;
i=j.PromiseCastResolved;
h=j.PerformPromiseThen;
});
function AsyncFunctionAwait(k,l){
var m=i(l);
var n=
(sentValue)=>%_Call(d,k,sentValue);
var o=
(sentError)=>%_Call(e,k,sentError);
var p=g(f);
return h(m,n,o,
p);
}
%InstallToContext(["async_function_await",AsyncFunctionAwait]);
})

<harmony-atomicsÖ(
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Object;
var d;
var e=b.ImportNow("to_string_tag_symbol");
b.Import(function(f){
d=f.MaxSimple;
});
function CheckSharedIntegerTypedArray(g){
if(!%IsSharedIntegerTypedArray(g)){
throw %make_type_error(74,g);
}
}
function CheckSharedInteger32TypedArray(g){
CheckSharedIntegerTypedArray(g);
if(!%IsSharedInteger32TypedArray(g)){
throw %make_type_error(75,g);
}
}
function ValidateIndex(h,i){
var j=(%_ToNumber(h));
var k=(%_ToInteger(j));
if(j!==k){
throw %make_range_error(155);
}
if(k<0||k>=i){
throw %make_range_error(155);
}
return k;
}
function AtomicsCompareExchangeJS(l,h,m,n){
CheckSharedIntegerTypedArray(l);
h=ValidateIndex(h,%_TypedArrayGetLength(l));
m=(%_ToNumber(m));
n=(%_ToNumber(n));
return %_AtomicsCompareExchange(l,h,m,n);
}
function AtomicsAddJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsAdd(g,h,o);
}
function AtomicsSubJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsSub(g,h,o);
}
function AtomicsAndJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsAnd(g,h,o);
}
function AtomicsOrJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsOr(g,h,o);
}
function AtomicsXorJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsXor(g,h,o);
}
function AtomicsExchangeJS(g,h,o){
CheckSharedIntegerTypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
o=(%_ToNumber(o));
return %_AtomicsExchange(g,h,o);
}
function AtomicsIsLockFreeJS(p){
return %_AtomicsIsLockFree(p);
}
function AtomicsWaitJS(g,h,o,q){
CheckSharedInteger32TypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
if((q===(void 0))){
q=(1/0);
}else{
q=(%_ToNumber(q));
if((!%_IsSmi(%IS_VAR(q))&&!(q==q))){
q=(1/0);
}else{
q=d(0,q);
}
}
return %AtomicsWait(g,h,o,q);
}
function AtomicsWakeJS(g,h,r){
CheckSharedInteger32TypedArray(g);
h=ValidateIndex(h,%_TypedArrayGetLength(g));
r=d(0,(%_ToInteger(r)));
return %AtomicsWake(g,h,r);
}
var s=a.Atomics;
%AddNamedProperty(s,e,"Atomics",1|2);
b.InstallFunctions(s,2,[
"compareExchange",AtomicsCompareExchangeJS,
"add",AtomicsAddJS,
"sub",AtomicsSubJS,
"and",AtomicsAndJS,
"or",AtomicsOrJS,
"xor",AtomicsXorJS,
"exchange",AtomicsExchangeJS,
"isLockFree",AtomicsIsLockFreeJS,
"wait",AtomicsWaitJS,
"wake",AtomicsWakeJS,
]);
})

0harmony-simdé¥
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.SIMD;
var d=b.ImportNow("to_string_tag_symbol");
var e=c.Float32x4;


var f=c.Int32x4;

var g=c.Int16x8;

var h=c.Int8x16;


var i=c.Uint32x4;

var j=c.Uint16x8;

var k=c.Uint8x16;


var l=c.Bool32x4;

var m=c.Bool16x8;

var n=c.Bool8x16;



function Float32x4CheckJS(o){
return %Float32x4Check(o);
}
function Float32x4ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='float32x4'){
throw %make_type_error(44,
"Float32x4.prototype.toString",this);
}
var q="SIMD.Float32x4(";
q+=%Float32x4ExtractLane(p,0);
for(var r=1;r<4;r++){
q+=", "+%Float32x4ExtractLane(p,r);
}
return q+")";
}
function Float32x4ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='float32x4'){
throw %make_type_error(44,
"Float32x4.prototype.toLocaleString",this);
}
var q="SIMD.Float32x4(";
q+=%Float32x4ExtractLane(p,0).toLocaleString();
for(var r=1;r<4;r++){
q+=", "+%Float32x4ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Float32x4ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='float32x4'){
throw %make_type_error(44,
"Float32x4.prototype.valueOf",this);
}
return p;
}
function Float32x4ExtractLaneJS(s,t){
return %Float32x4ExtractLane(s,t);
}


function Int32x4CheckJS(o){
return %Int32x4Check(o);
}
function Int32x4ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='int32x4'){
throw %make_type_error(44,
"Int32x4.prototype.toString",this);
}
var q="SIMD.Int32x4(";
q+=%Int32x4ExtractLane(p,0);
for(var r=1;r<4;r++){
q+=", "+%Int32x4ExtractLane(p,r);
}
return q+")";
}
function Int32x4ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='int32x4'){
throw %make_type_error(44,
"Int32x4.prototype.toLocaleString",this);
}
var q="SIMD.Int32x4(";
q+=%Int32x4ExtractLane(p,0).toLocaleString();
for(var r=1;r<4;r++){
q+=", "+%Int32x4ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Int32x4ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='int32x4'){
throw %make_type_error(44,
"Int32x4.prototype.valueOf",this);
}
return p;
}
function Int32x4ExtractLaneJS(s,t){
return %Int32x4ExtractLane(s,t);
}

function Int16x8CheckJS(o){
return %Int16x8Check(o);
}
function Int16x8ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='int16x8'){
throw %make_type_error(44,
"Int16x8.prototype.toString",this);
}
var q="SIMD.Int16x8(";
q+=%Int16x8ExtractLane(p,0);
for(var r=1;r<8;r++){
q+=", "+%Int16x8ExtractLane(p,r);
}
return q+")";
}
function Int16x8ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='int16x8'){
throw %make_type_error(44,
"Int16x8.prototype.toLocaleString",this);
}
var q="SIMD.Int16x8(";
q+=%Int16x8ExtractLane(p,0).toLocaleString();
for(var r=1;r<8;r++){
q+=", "+%Int16x8ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Int16x8ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='int16x8'){
throw %make_type_error(44,
"Int16x8.prototype.valueOf",this);
}
return p;
}
function Int16x8ExtractLaneJS(s,t){
return %Int16x8ExtractLane(s,t);
}

function Int8x16CheckJS(o){
return %Int8x16Check(o);
}
function Int8x16ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='int8x16'){
throw %make_type_error(44,
"Int8x16.prototype.toString",this);
}
var q="SIMD.Int8x16(";
q+=%Int8x16ExtractLane(p,0);
for(var r=1;r<16;r++){
q+=", "+%Int8x16ExtractLane(p,r);
}
return q+")";
}
function Int8x16ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='int8x16'){
throw %make_type_error(44,
"Int8x16.prototype.toLocaleString",this);
}
var q="SIMD.Int8x16(";
q+=%Int8x16ExtractLane(p,0).toLocaleString();
for(var r=1;r<16;r++){
q+=", "+%Int8x16ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Int8x16ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='int8x16'){
throw %make_type_error(44,
"Int8x16.prototype.valueOf",this);
}
return p;
}
function Int8x16ExtractLaneJS(s,t){
return %Int8x16ExtractLane(s,t);
}


function Uint32x4CheckJS(o){
return %Uint32x4Check(o);
}
function Uint32x4ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint32x4'){
throw %make_type_error(44,
"Uint32x4.prototype.toString",this);
}
var q="SIMD.Uint32x4(";
q+=%Uint32x4ExtractLane(p,0);
for(var r=1;r<4;r++){
q+=", "+%Uint32x4ExtractLane(p,r);
}
return q+")";
}
function Uint32x4ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint32x4'){
throw %make_type_error(44,
"Uint32x4.prototype.toLocaleString",this);
}
var q="SIMD.Uint32x4(";
q+=%Uint32x4ExtractLane(p,0).toLocaleString();
for(var r=1;r<4;r++){
q+=", "+%Uint32x4ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Uint32x4ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='uint32x4'){
throw %make_type_error(44,
"Uint32x4.prototype.valueOf",this);
}
return p;
}
function Uint32x4ExtractLaneJS(s,t){
return %Uint32x4ExtractLane(s,t);
}

function Uint16x8CheckJS(o){
return %Uint16x8Check(o);
}
function Uint16x8ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint16x8'){
throw %make_type_error(44,
"Uint16x8.prototype.toString",this);
}
var q="SIMD.Uint16x8(";
q+=%Uint16x8ExtractLane(p,0);
for(var r=1;r<8;r++){
q+=", "+%Uint16x8ExtractLane(p,r);
}
return q+")";
}
function Uint16x8ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint16x8'){
throw %make_type_error(44,
"Uint16x8.prototype.toLocaleString",this);
}
var q="SIMD.Uint16x8(";
q+=%Uint16x8ExtractLane(p,0).toLocaleString();
for(var r=1;r<8;r++){
q+=", "+%Uint16x8ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Uint16x8ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='uint16x8'){
throw %make_type_error(44,
"Uint16x8.prototype.valueOf",this);
}
return p;
}
function Uint16x8ExtractLaneJS(s,t){
return %Uint16x8ExtractLane(s,t);
}

function Uint8x16CheckJS(o){
return %Uint8x16Check(o);
}
function Uint8x16ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint8x16'){
throw %make_type_error(44,
"Uint8x16.prototype.toString",this);
}
var q="SIMD.Uint8x16(";
q+=%Uint8x16ExtractLane(p,0);
for(var r=1;r<16;r++){
q+=", "+%Uint8x16ExtractLane(p,r);
}
return q+")";
}
function Uint8x16ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='uint8x16'){
throw %make_type_error(44,
"Uint8x16.prototype.toLocaleString",this);
}
var q="SIMD.Uint8x16(";
q+=%Uint8x16ExtractLane(p,0).toLocaleString();
for(var r=1;r<16;r++){
q+=", "+%Uint8x16ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Uint8x16ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='uint8x16'){
throw %make_type_error(44,
"Uint8x16.prototype.valueOf",this);
}
return p;
}
function Uint8x16ExtractLaneJS(s,t){
return %Uint8x16ExtractLane(s,t);
}


function Bool32x4CheckJS(o){
return %Bool32x4Check(o);
}
function Bool32x4ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool32x4'){
throw %make_type_error(44,
"Bool32x4.prototype.toString",this);
}
var q="SIMD.Bool32x4(";
q+=%Bool32x4ExtractLane(p,0);
for(var r=1;r<4;r++){
q+=", "+%Bool32x4ExtractLane(p,r);
}
return q+")";
}
function Bool32x4ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool32x4'){
throw %make_type_error(44,
"Bool32x4.prototype.toLocaleString",this);
}
var q="SIMD.Bool32x4(";
q+=%Bool32x4ExtractLane(p,0).toLocaleString();
for(var r=1;r<4;r++){
q+=", "+%Bool32x4ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Bool32x4ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='bool32x4'){
throw %make_type_error(44,
"Bool32x4.prototype.valueOf",this);
}
return p;
}
function Bool32x4ExtractLaneJS(s,t){
return %Bool32x4ExtractLane(s,t);
}

function Bool16x8CheckJS(o){
return %Bool16x8Check(o);
}
function Bool16x8ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool16x8'){
throw %make_type_error(44,
"Bool16x8.prototype.toString",this);
}
var q="SIMD.Bool16x8(";
q+=%Bool16x8ExtractLane(p,0);
for(var r=1;r<8;r++){
q+=", "+%Bool16x8ExtractLane(p,r);
}
return q+")";
}
function Bool16x8ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool16x8'){
throw %make_type_error(44,
"Bool16x8.prototype.toLocaleString",this);
}
var q="SIMD.Bool16x8(";
q+=%Bool16x8ExtractLane(p,0).toLocaleString();
for(var r=1;r<8;r++){
q+=", "+%Bool16x8ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Bool16x8ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='bool16x8'){
throw %make_type_error(44,
"Bool16x8.prototype.valueOf",this);
}
return p;
}
function Bool16x8ExtractLaneJS(s,t){
return %Bool16x8ExtractLane(s,t);
}

function Bool8x16CheckJS(o){
return %Bool8x16Check(o);
}
function Bool8x16ToString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool8x16'){
throw %make_type_error(44,
"Bool8x16.prototype.toString",this);
}
var q="SIMD.Bool8x16(";
q+=%Bool8x16ExtractLane(p,0);
for(var r=1;r<16;r++){
q+=", "+%Bool8x16ExtractLane(p,r);
}
return q+")";
}
function Bool8x16ToLocaleString(){
var p=%ValueOf(this);
if(typeof(p)!=='bool8x16'){
throw %make_type_error(44,
"Bool8x16.prototype.toLocaleString",this);
}
var q="SIMD.Bool8x16(";
q+=%Bool8x16ExtractLane(p,0).toLocaleString();
for(var r=1;r<16;r++){
q+=", "+%Bool8x16ExtractLane(p,r).toLocaleString();
}
return q+")";
}
function Bool8x16ValueOf(){
var p=%ValueOf(this);
if(typeof(p)!=='bool8x16'){
throw %make_type_error(44,
"Bool8x16.prototype.valueOf",this);
}
return p;
}
function Bool8x16ExtractLaneJS(s,t){
return %Bool8x16ExtractLane(s,t);
}



function Int32x4ShiftLeftByScalarJS(s,u){
return %Int32x4ShiftLeftByScalar(s,u);
}
function Int32x4ShiftRightByScalarJS(s,u){
return %Int32x4ShiftRightByScalar(s,u);
}

function Int16x8ShiftLeftByScalarJS(s,u){
return %Int16x8ShiftLeftByScalar(s,u);
}
function Int16x8ShiftRightByScalarJS(s,u){
return %Int16x8ShiftRightByScalar(s,u);
}

function Int8x16ShiftLeftByScalarJS(s,u){
return %Int8x16ShiftLeftByScalar(s,u);
}
function Int8x16ShiftRightByScalarJS(s,u){
return %Int8x16ShiftRightByScalar(s,u);
}


function Uint32x4ShiftLeftByScalarJS(s,u){
return %Uint32x4ShiftLeftByScalar(s,u);
}
function Uint32x4ShiftRightByScalarJS(s,u){
return %Uint32x4ShiftRightByScalar(s,u);
}

function Uint16x8ShiftLeftByScalarJS(s,u){
return %Uint16x8ShiftLeftByScalar(s,u);
}
function Uint16x8ShiftRightByScalarJS(s,u){
return %Uint16x8ShiftRightByScalar(s,u);
}

function Uint8x16ShiftLeftByScalarJS(s,u){
return %Uint8x16ShiftLeftByScalar(s,u);
}
function Uint8x16ShiftRightByScalarJS(s,u){
return %Uint8x16ShiftRightByScalar(s,u);
}


function Int16x8AddSaturateJS(o,v){
return %Int16x8AddSaturate(o,v);
}
function Int16x8SubSaturateJS(o,v){
return %Int16x8SubSaturate(o,v);
}

function Int8x16AddSaturateJS(o,v){
return %Int8x16AddSaturate(o,v);
}
function Int8x16SubSaturateJS(o,v){
return %Int8x16SubSaturate(o,v);
}

function Uint8x16AddSaturateJS(o,v){
return %Uint8x16AddSaturate(o,v);
}
function Uint8x16SubSaturateJS(o,v){
return %Uint8x16SubSaturate(o,v);
}

function Uint16x8AddSaturateJS(o,v){
return %Uint16x8AddSaturate(o,v);
}
function Uint16x8SubSaturateJS(o,v){
return %Uint16x8SubSaturate(o,v);
}


function Float32x4NegJS(o){
return %Float32x4Neg(o);
}


function Int32x4NegJS(o){
return %Int32x4Neg(o);
}

function Int16x8NegJS(o){
return %Int16x8Neg(o);
}

function Int8x16NegJS(o){
return %Int8x16Neg(o);
}


function Bool32x4ReplaceLaneJS(s,t,p){
return %Bool32x4ReplaceLane(s,t,p);
}
function Bool32x4AnyTrueJS(w){
return %Bool32x4AnyTrue(w);
}
function Bool32x4AllTrueJS(w){
return %Bool32x4AllTrue(w);
}

function Bool16x8ReplaceLaneJS(s,t,p){
return %Bool16x8ReplaceLane(s,t,p);
}
function Bool16x8AnyTrueJS(w){
return %Bool16x8AnyTrue(w);
}
function Bool16x8AllTrueJS(w){
return %Bool16x8AllTrue(w);
}

function Bool8x16ReplaceLaneJS(s,t,p){
return %Bool8x16ReplaceLane(s,t,p);
}
function Bool8x16AnyTrueJS(w){
return %Bool8x16AnyTrue(w);
}
function Bool8x16AllTrueJS(w){
return %Bool8x16AllTrue(w);
}


function Float32x4ReplaceLaneJS(s,t,p){
return %Float32x4ReplaceLane(s,t,(%_ToNumber(p)));
}
function Float32x4SelectJS(x,o,v){
return %Float32x4Select(x,o,v);
}
function Float32x4AddJS(o,v){
return %Float32x4Add(o,v);
}
function Float32x4SubJS(o,v){
return %Float32x4Sub(o,v);
}
function Float32x4MulJS(o,v){
return %Float32x4Mul(o,v);
}
function Float32x4MinJS(o,v){
return %Float32x4Min(o,v);
}
function Float32x4MaxJS(o,v){
return %Float32x4Max(o,v);
}
function Float32x4EqualJS(o,v){
return %Float32x4Equal(o,v);
}
function Float32x4NotEqualJS(o,v){
return %Float32x4NotEqual(o,v);
}
function Float32x4LessThanJS(o,v){
return %Float32x4LessThan(o,v);
}
function Float32x4LessThanOrEqualJS(o,v){
return %Float32x4LessThanOrEqual(o,v);
}
function Float32x4GreaterThanJS(o,v){
return %Float32x4GreaterThan(o,v);
}
function Float32x4GreaterThanOrEqualJS(o,v){
return %Float32x4GreaterThanOrEqual(o,v);
}
function Float32x4LoadJS(y,z){
return %Float32x4Load(y,z);
}
function Float32x4StoreJS(y,z,o){
return %Float32x4Store(y,z,o);
}


function Int32x4ReplaceLaneJS(s,t,p){
return %Int32x4ReplaceLane(s,t,(%_ToNumber(p)));
}
function Int32x4SelectJS(x,o,v){
return %Int32x4Select(x,o,v);
}
function Int32x4AddJS(o,v){
return %Int32x4Add(o,v);
}
function Int32x4SubJS(o,v){
return %Int32x4Sub(o,v);
}
function Int32x4MulJS(o,v){
return %Int32x4Mul(o,v);
}
function Int32x4MinJS(o,v){
return %Int32x4Min(o,v);
}
function Int32x4MaxJS(o,v){
return %Int32x4Max(o,v);
}
function Int32x4EqualJS(o,v){
return %Int32x4Equal(o,v);
}
function Int32x4NotEqualJS(o,v){
return %Int32x4NotEqual(o,v);
}
function Int32x4LessThanJS(o,v){
return %Int32x4LessThan(o,v);
}
function Int32x4LessThanOrEqualJS(o,v){
return %Int32x4LessThanOrEqual(o,v);
}
function Int32x4GreaterThanJS(o,v){
return %Int32x4GreaterThan(o,v);
}
function Int32x4GreaterThanOrEqualJS(o,v){
return %Int32x4GreaterThanOrEqual(o,v);
}
function Int32x4LoadJS(y,z){
return %Int32x4Load(y,z);
}
function Int32x4StoreJS(y,z,o){
return %Int32x4Store(y,z,o);
}

function Int16x8ReplaceLaneJS(s,t,p){
return %Int16x8ReplaceLane(s,t,(%_ToNumber(p)));
}
function Int16x8SelectJS(x,o,v){
return %Int16x8Select(x,o,v);
}
function Int16x8AddJS(o,v){
return %Int16x8Add(o,v);
}
function Int16x8SubJS(o,v){
return %Int16x8Sub(o,v);
}
function Int16x8MulJS(o,v){
return %Int16x8Mul(o,v);
}
function Int16x8MinJS(o,v){
return %Int16x8Min(o,v);
}
function Int16x8MaxJS(o,v){
return %Int16x8Max(o,v);
}
function Int16x8EqualJS(o,v){
return %Int16x8Equal(o,v);
}
function Int16x8NotEqualJS(o,v){
return %Int16x8NotEqual(o,v);
}
function Int16x8LessThanJS(o,v){
return %Int16x8LessThan(o,v);
}
function Int16x8LessThanOrEqualJS(o,v){
return %Int16x8LessThanOrEqual(o,v);
}
function Int16x8GreaterThanJS(o,v){
return %Int16x8GreaterThan(o,v);
}
function Int16x8GreaterThanOrEqualJS(o,v){
return %Int16x8GreaterThanOrEqual(o,v);
}
function Int16x8LoadJS(y,z){
return %Int16x8Load(y,z);
}
function Int16x8StoreJS(y,z,o){
return %Int16x8Store(y,z,o);
}

function Int8x16ReplaceLaneJS(s,t,p){
return %Int8x16ReplaceLane(s,t,(%_ToNumber(p)));
}
function Int8x16SelectJS(x,o,v){
return %Int8x16Select(x,o,v);
}
function Int8x16AddJS(o,v){
return %Int8x16Add(o,v);
}
function Int8x16SubJS(o,v){
return %Int8x16Sub(o,v);
}
function Int8x16MulJS(o,v){
return %Int8x16Mul(o,v);
}
function Int8x16MinJS(o,v){
return %Int8x16Min(o,v);
}
function Int8x16MaxJS(o,v){
return %Int8x16Max(o,v);
}
function Int8x16EqualJS(o,v){
return %Int8x16Equal(o,v);
}
function Int8x16NotEqualJS(o,v){
return %Int8x16NotEqual(o,v);
}
function Int8x16LessThanJS(o,v){
return %Int8x16LessThan(o,v);
}
function Int8x16LessThanOrEqualJS(o,v){
return %Int8x16LessThanOrEqual(o,v);
}
function Int8x16GreaterThanJS(o,v){
return %Int8x16GreaterThan(o,v);
}
function Int8x16GreaterThanOrEqualJS(o,v){
return %Int8x16GreaterThanOrEqual(o,v);
}
function Int8x16LoadJS(y,z){
return %Int8x16Load(y,z);
}
function Int8x16StoreJS(y,z,o){
return %Int8x16Store(y,z,o);
}


function Uint32x4ReplaceLaneJS(s,t,p){
return %Uint32x4ReplaceLane(s,t,(%_ToNumber(p)));
}
function Uint32x4SelectJS(x,o,v){
return %Uint32x4Select(x,o,v);
}
function Uint32x4AddJS(o,v){
return %Uint32x4Add(o,v);
}
function Uint32x4SubJS(o,v){
return %Uint32x4Sub(o,v);
}
function Uint32x4MulJS(o,v){
return %Uint32x4Mul(o,v);
}
function Uint32x4MinJS(o,v){
return %Uint32x4Min(o,v);
}
function Uint32x4MaxJS(o,v){
return %Uint32x4Max(o,v);
}
function Uint32x4EqualJS(o,v){
return %Uint32x4Equal(o,v);
}
function Uint32x4NotEqualJS(o,v){
return %Uint32x4NotEqual(o,v);
}
function Uint32x4LessThanJS(o,v){
return %Uint32x4LessThan(o,v);
}
function Uint32x4LessThanOrEqualJS(o,v){
return %Uint32x4LessThanOrEqual(o,v);
}
function Uint32x4GreaterThanJS(o,v){
return %Uint32x4GreaterThan(o,v);
}
function Uint32x4GreaterThanOrEqualJS(o,v){
return %Uint32x4GreaterThanOrEqual(o,v);
}
function Uint32x4LoadJS(y,z){
return %Uint32x4Load(y,z);
}
function Uint32x4StoreJS(y,z,o){
return %Uint32x4Store(y,z,o);
}

function Uint16x8ReplaceLaneJS(s,t,p){
return %Uint16x8ReplaceLane(s,t,(%_ToNumber(p)));
}
function Uint16x8SelectJS(x,o,v){
return %Uint16x8Select(x,o,v);
}
function Uint16x8AddJS(o,v){
return %Uint16x8Add(o,v);
}
function Uint16x8SubJS(o,v){
return %Uint16x8Sub(o,v);
}
function Uint16x8MulJS(o,v){
return %Uint16x8Mul(o,v);
}
function Uint16x8MinJS(o,v){
return %Uint16x8Min(o,v);
}
function Uint16x8MaxJS(o,v){
return %Uint16x8Max(o,v);
}
function Uint16x8EqualJS(o,v){
return %Uint16x8Equal(o,v);
}
function Uint16x8NotEqualJS(o,v){
return %Uint16x8NotEqual(o,v);
}
function Uint16x8LessThanJS(o,v){
return %Uint16x8LessThan(o,v);
}
function Uint16x8LessThanOrEqualJS(o,v){
return %Uint16x8LessThanOrEqual(o,v);
}
function Uint16x8GreaterThanJS(o,v){
return %Uint16x8GreaterThan(o,v);
}
function Uint16x8GreaterThanOrEqualJS(o,v){
return %Uint16x8GreaterThanOrEqual(o,v);
}
function Uint16x8LoadJS(y,z){
return %Uint16x8Load(y,z);
}
function Uint16x8StoreJS(y,z,o){
return %Uint16x8Store(y,z,o);
}

function Uint8x16ReplaceLaneJS(s,t,p){
return %Uint8x16ReplaceLane(s,t,(%_ToNumber(p)));
}
function Uint8x16SelectJS(x,o,v){
return %Uint8x16Select(x,o,v);
}
function Uint8x16AddJS(o,v){
return %Uint8x16Add(o,v);
}
function Uint8x16SubJS(o,v){
return %Uint8x16Sub(o,v);
}
function Uint8x16MulJS(o,v){
return %Uint8x16Mul(o,v);
}
function Uint8x16MinJS(o,v){
return %Uint8x16Min(o,v);
}
function Uint8x16MaxJS(o,v){
return %Uint8x16Max(o,v);
}
function Uint8x16EqualJS(o,v){
return %Uint8x16Equal(o,v);
}
function Uint8x16NotEqualJS(o,v){
return %Uint8x16NotEqual(o,v);
}
function Uint8x16LessThanJS(o,v){
return %Uint8x16LessThan(o,v);
}
function Uint8x16LessThanOrEqualJS(o,v){
return %Uint8x16LessThanOrEqual(o,v);
}
function Uint8x16GreaterThanJS(o,v){
return %Uint8x16GreaterThan(o,v);
}
function Uint8x16GreaterThanOrEqualJS(o,v){
return %Uint8x16GreaterThanOrEqual(o,v);
}
function Uint8x16LoadJS(y,z){
return %Uint8x16Load(y,z);
}
function Uint8x16StoreJS(y,z,o){
return %Uint8x16Store(y,z,o);
}



function Int32x4AndJS(o,v){
return %Int32x4And(o,v);
}
function Int32x4OrJS(o,v){
return %Int32x4Or(o,v);
}
function Int32x4XorJS(o,v){
return %Int32x4Xor(o,v);
}
function Int32x4NotJS(o){
return %Int32x4Not(o);
}

function Int16x8AndJS(o,v){
return %Int16x8And(o,v);
}
function Int16x8OrJS(o,v){
return %Int16x8Or(o,v);
}
function Int16x8XorJS(o,v){
return %Int16x8Xor(o,v);
}
function Int16x8NotJS(o){
return %Int16x8Not(o);
}

function Int8x16AndJS(o,v){
return %Int8x16And(o,v);
}
function Int8x16OrJS(o,v){
return %Int8x16Or(o,v);
}
function Int8x16XorJS(o,v){
return %Int8x16Xor(o,v);
}
function Int8x16NotJS(o){
return %Int8x16Not(o);
}


function Uint32x4AndJS(o,v){
return %Uint32x4And(o,v);
}
function Uint32x4OrJS(o,v){
return %Uint32x4Or(o,v);
}
function Uint32x4XorJS(o,v){
return %Uint32x4Xor(o,v);
}
function Uint32x4NotJS(o){
return %Uint32x4Not(o);
}

function Uint16x8AndJS(o,v){
return %Uint16x8And(o,v);
}
function Uint16x8OrJS(o,v){
return %Uint16x8Or(o,v);
}
function Uint16x8XorJS(o,v){
return %Uint16x8Xor(o,v);
}
function Uint16x8NotJS(o){
return %Uint16x8Not(o);
}

function Uint8x16AndJS(o,v){
return %Uint8x16And(o,v);
}
function Uint8x16OrJS(o,v){
return %Uint8x16Or(o,v);
}
function Uint8x16XorJS(o,v){
return %Uint8x16Xor(o,v);
}
function Uint8x16NotJS(o){
return %Uint8x16Not(o);
}


function Bool32x4AndJS(o,v){
return %Bool32x4And(o,v);
}
function Bool32x4OrJS(o,v){
return %Bool32x4Or(o,v);
}
function Bool32x4XorJS(o,v){
return %Bool32x4Xor(o,v);
}
function Bool32x4NotJS(o){
return %Bool32x4Not(o);
}

function Bool16x8AndJS(o,v){
return %Bool16x8And(o,v);
}
function Bool16x8OrJS(o,v){
return %Bool16x8Or(o,v);
}
function Bool16x8XorJS(o,v){
return %Bool16x8Xor(o,v);
}
function Bool16x8NotJS(o){
return %Bool16x8Not(o);
}

function Bool8x16AndJS(o,v){
return %Bool8x16And(o,v);
}
function Bool8x16OrJS(o,v){
return %Bool8x16Or(o,v);
}
function Bool8x16XorJS(o,v){
return %Bool8x16Xor(o,v);
}
function Bool8x16NotJS(o){
return %Bool8x16Not(o);
}



function Float32x4FromInt32x4JS(o){
return %Float32x4FromInt32x4(o);
}

function Float32x4FromUint32x4JS(o){
return %Float32x4FromUint32x4(o);
}

function Int32x4FromFloat32x4JS(o){
return %Int32x4FromFloat32x4(o);
}

function Int32x4FromUint32x4JS(o){
return %Int32x4FromUint32x4(o);
}

function Uint32x4FromFloat32x4JS(o){
return %Uint32x4FromFloat32x4(o);
}

function Uint32x4FromInt32x4JS(o){
return %Uint32x4FromInt32x4(o);
}

function Int16x8FromUint16x8JS(o){
return %Int16x8FromUint16x8(o);
}

function Uint16x8FromInt16x8JS(o){
return %Uint16x8FromInt16x8(o);
}

function Int8x16FromUint8x16JS(o){
return %Int8x16FromUint8x16(o);
}

function Uint8x16FromInt8x16JS(o){
return %Uint8x16FromInt8x16(o);
}


function Float32x4FromInt32x4BitsJS(o){
return %Float32x4FromInt32x4Bits(o);
}

function Float32x4FromUint32x4BitsJS(o){
return %Float32x4FromUint32x4Bits(o);
}

function Float32x4FromInt16x8BitsJS(o){
return %Float32x4FromInt16x8Bits(o);
}

function Float32x4FromUint16x8BitsJS(o){
return %Float32x4FromUint16x8Bits(o);
}

function Float32x4FromInt8x16BitsJS(o){
return %Float32x4FromInt8x16Bits(o);
}

function Float32x4FromUint8x16BitsJS(o){
return %Float32x4FromUint8x16Bits(o);
}

function Int32x4FromFloat32x4BitsJS(o){
return %Int32x4FromFloat32x4Bits(o);
}

function Int32x4FromUint32x4BitsJS(o){
return %Int32x4FromUint32x4Bits(o);
}

function Int32x4FromInt16x8BitsJS(o){
return %Int32x4FromInt16x8Bits(o);
}

function Int32x4FromUint16x8BitsJS(o){
return %Int32x4FromUint16x8Bits(o);
}

function Int32x4FromInt8x16BitsJS(o){
return %Int32x4FromInt8x16Bits(o);
}

function Int32x4FromUint8x16BitsJS(o){
return %Int32x4FromUint8x16Bits(o);
}

function Uint32x4FromFloat32x4BitsJS(o){
return %Uint32x4FromFloat32x4Bits(o);
}

function Uint32x4FromInt32x4BitsJS(o){
return %Uint32x4FromInt32x4Bits(o);
}

function Uint32x4FromInt16x8BitsJS(o){
return %Uint32x4FromInt16x8Bits(o);
}

function Uint32x4FromUint16x8BitsJS(o){
return %Uint32x4FromUint16x8Bits(o);
}

function Uint32x4FromInt8x16BitsJS(o){
return %Uint32x4FromInt8x16Bits(o);
}

function Uint32x4FromUint8x16BitsJS(o){
return %Uint32x4FromUint8x16Bits(o);
}

function Int16x8FromFloat32x4BitsJS(o){
return %Int16x8FromFloat32x4Bits(o);
}

function Int16x8FromInt32x4BitsJS(o){
return %Int16x8FromInt32x4Bits(o);
}

function Int16x8FromUint32x4BitsJS(o){
return %Int16x8FromUint32x4Bits(o);
}

function Int16x8FromUint16x8BitsJS(o){
return %Int16x8FromUint16x8Bits(o);
}

function Int16x8FromInt8x16BitsJS(o){
return %Int16x8FromInt8x16Bits(o);
}

function Int16x8FromUint8x16BitsJS(o){
return %Int16x8FromUint8x16Bits(o);
}

function Uint16x8FromFloat32x4BitsJS(o){
return %Uint16x8FromFloat32x4Bits(o);
}

function Uint16x8FromInt32x4BitsJS(o){
return %Uint16x8FromInt32x4Bits(o);
}

function Uint16x8FromUint32x4BitsJS(o){
return %Uint16x8FromUint32x4Bits(o);
}

function Uint16x8FromInt16x8BitsJS(o){
return %Uint16x8FromInt16x8Bits(o);
}

function Uint16x8FromInt8x16BitsJS(o){
return %Uint16x8FromInt8x16Bits(o);
}

function Uint16x8FromUint8x16BitsJS(o){
return %Uint16x8FromUint8x16Bits(o);
}

function Int8x16FromFloat32x4BitsJS(o){
return %Int8x16FromFloat32x4Bits(o);
}

function Int8x16FromInt32x4BitsJS(o){
return %Int8x16FromInt32x4Bits(o);
}

function Int8x16FromUint32x4BitsJS(o){
return %Int8x16FromUint32x4Bits(o);
}

function Int8x16FromInt16x8BitsJS(o){
return %Int8x16FromInt16x8Bits(o);
}

function Int8x16FromUint16x8BitsJS(o){
return %Int8x16FromUint16x8Bits(o);
}

function Int8x16FromUint8x16BitsJS(o){
return %Int8x16FromUint8x16Bits(o);
}

function Uint8x16FromFloat32x4BitsJS(o){
return %Uint8x16FromFloat32x4Bits(o);
}

function Uint8x16FromInt32x4BitsJS(o){
return %Uint8x16FromInt32x4Bits(o);
}

function Uint8x16FromUint32x4BitsJS(o){
return %Uint8x16FromUint32x4Bits(o);
}

function Uint8x16FromInt16x8BitsJS(o){
return %Uint8x16FromInt16x8Bits(o);
}

function Uint8x16FromUint16x8BitsJS(o){
return %Uint8x16FromUint16x8Bits(o);
}

function Uint8x16FromInt8x16BitsJS(o){
return %Uint8x16FromInt8x16Bits(o);
}


function Float32x4Load1JS(y,z){
return %Float32x4Load1(y,z);
}
function Float32x4Store1JS(y,z,o){
return %Float32x4Store1(y,z,o);
}

function Float32x4Load2JS(y,z){
return %Float32x4Load2(y,z);
}
function Float32x4Store2JS(y,z,o){
return %Float32x4Store2(y,z,o);
}

function Float32x4Load3JS(y,z){
return %Float32x4Load3(y,z);
}
function Float32x4Store3JS(y,z,o){
return %Float32x4Store3(y,z,o);
}

function Int32x4Load1JS(y,z){
return %Int32x4Load1(y,z);
}
function Int32x4Store1JS(y,z,o){
return %Int32x4Store1(y,z,o);
}

function Int32x4Load2JS(y,z){
return %Int32x4Load2(y,z);
}
function Int32x4Store2JS(y,z,o){
return %Int32x4Store2(y,z,o);
}

function Int32x4Load3JS(y,z){
return %Int32x4Load3(y,z);
}
function Int32x4Store3JS(y,z,o){
return %Int32x4Store3(y,z,o);
}

function Uint32x4Load1JS(y,z){
return %Uint32x4Load1(y,z);
}
function Uint32x4Store1JS(y,z,o){
return %Uint32x4Store1(y,z,o);
}

function Uint32x4Load2JS(y,z){
return %Uint32x4Load2(y,z);
}
function Uint32x4Store2JS(y,z,o){
return %Uint32x4Store2(y,z,o);
}

function Uint32x4Load3JS(y,z){
return %Uint32x4Load3(y,z);
}
function Uint32x4Store3JS(y,z,o){
return %Uint32x4Store3(y,z,o);
}


function Float32x4Splat(w){
return %CreateFloat32x4(w,w,w,w);
}
function Float32x4SwizzleJS(o,A,B,C,D){
return %Float32x4Swizzle(o,A,B,C,D);
}
function Float32x4ShuffleJS(o,v,A,B,C,D){
return %Float32x4Shuffle(o,v,A,B,C,D);
}

function Int32x4Splat(w){
return %CreateInt32x4(w,w,w,w);
}
function Int32x4SwizzleJS(o,A,B,C,D){
return %Int32x4Swizzle(o,A,B,C,D);
}
function Int32x4ShuffleJS(o,v,A,B,C,D){
return %Int32x4Shuffle(o,v,A,B,C,D);
}

function Uint32x4Splat(w){
return %CreateUint32x4(w,w,w,w);
}
function Uint32x4SwizzleJS(o,A,B,C,D){
return %Uint32x4Swizzle(o,A,B,C,D);
}
function Uint32x4ShuffleJS(o,v,A,B,C,D){
return %Uint32x4Shuffle(o,v,A,B,C,D);
}

function Bool32x4Splat(w){
return %CreateBool32x4(w,w,w,w);
}
function Bool32x4SwizzleJS(o,A,B,C,D){
return %Bool32x4Swizzle(o,A,B,C,D);
}
function Bool32x4ShuffleJS(o,v,A,B,C,D){
return %Bool32x4Shuffle(o,v,A,B,C,D);
}


function Int16x8Splat(w){
return %CreateInt16x8(w,w,w,w,w,w,w,w);
}
function Int16x8SwizzleJS(o,A,B,C,D,E,F,G,H){
return %Int16x8Swizzle(o,A,B,C,D,E,F,G,H);
}
function Int16x8ShuffleJS(o,v,A,B,C,D,E,F,G,H){
return %Int16x8Shuffle(o,v,A,B,C,D,E,F,G,H);
}

function Uint16x8Splat(w){
return %CreateUint16x8(w,w,w,w,w,w,w,w);
}
function Uint16x8SwizzleJS(o,A,B,C,D,E,F,G,H){
return %Uint16x8Swizzle(o,A,B,C,D,E,F,G,H);
}
function Uint16x8ShuffleJS(o,v,A,B,C,D,E,F,G,H){
return %Uint16x8Shuffle(o,v,A,B,C,D,E,F,G,H);
}

function Bool16x8Splat(w){
return %CreateBool16x8(w,w,w,w,w,w,w,w);
}
function Bool16x8SwizzleJS(o,A,B,C,D,E,F,G,H){
return %Bool16x8Swizzle(o,A,B,C,D,E,F,G,H);
}
function Bool16x8ShuffleJS(o,v,A,B,C,D,E,F,G,H){
return %Bool16x8Shuffle(o,v,A,B,C,D,E,F,G,H);
}


function Int8x16Splat(w){
return %CreateInt8x16(w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w);
}
function Int8x16SwizzleJS(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
return %Int8x16Swizzle(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15);
}
function Int8x16ShuffleJS(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15){
return %Int8x16Shuffle(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15);
}

function Uint8x16Splat(w){
return %CreateUint8x16(w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w);
}
function Uint8x16SwizzleJS(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
return %Uint8x16Swizzle(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15);
}
function Uint8x16ShuffleJS(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15){
return %Uint8x16Shuffle(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15);
}

function Bool8x16Splat(w){
return %CreateBool8x16(w,w,w,w,w,w,w,w,w,w,w,w,w,w,w,w);
}
function Bool8x16SwizzleJS(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
return %Bool8x16Swizzle(o,A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15);
}
function Bool8x16ShuffleJS(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15){
return %Bool8x16Shuffle(o,v,A,B,C,D,E,F,G,H,c8,c9,c10,
c11,c12,c13,c14,c15);
}


function Float32x4Constructor(A,B,C,D){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Float32x4");
}
return %CreateFloat32x4((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)));
}
function Int32x4Constructor(A,B,C,D){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Int32x4");
}
return %CreateInt32x4((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)));
}
function Uint32x4Constructor(A,B,C,D){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Uint32x4");
}
return %CreateUint32x4((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)));
}
function Bool32x4Constructor(A,B,C,D){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Bool32x4");
}
return %CreateBool32x4(A,B,C,D);
}
function Int16x8Constructor(A,B,C,D,E,F,G,H){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Int16x8");
}
return %CreateInt16x8((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)),
(%_ToNumber(E)),(%_ToNumber(F)),
(%_ToNumber(G)),(%_ToNumber(H)));
}
function Uint16x8Constructor(A,B,C,D,E,F,G,H){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Uint16x8");
}
return %CreateUint16x8((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)),
(%_ToNumber(E)),(%_ToNumber(F)),
(%_ToNumber(G)),(%_ToNumber(H)));
}
function Bool16x8Constructor(A,B,C,D,E,F,G,H){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Bool16x8");
}
return %CreateBool16x8(A,B,C,D,E,F,G,H);
}
function Int8x16Constructor(A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Int8x16");
}
return %CreateInt8x16((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)),
(%_ToNumber(E)),(%_ToNumber(F)),
(%_ToNumber(G)),(%_ToNumber(H)),
(%_ToNumber(c8)),(%_ToNumber(c9)),
(%_ToNumber(c10)),(%_ToNumber(c11)),
(%_ToNumber(c12)),(%_ToNumber(c13)),
(%_ToNumber(c14)),(%_ToNumber(c15)));
}
function Uint8x16Constructor(A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Uint8x16");
}
return %CreateUint8x16((%_ToNumber(A)),(%_ToNumber(B)),
(%_ToNumber(C)),(%_ToNumber(D)),
(%_ToNumber(E)),(%_ToNumber(F)),
(%_ToNumber(G)),(%_ToNumber(H)),
(%_ToNumber(c8)),(%_ToNumber(c9)),
(%_ToNumber(c10)),(%_ToNumber(c11)),
(%_ToNumber(c12)),(%_ToNumber(c13)),
(%_ToNumber(c14)),(%_ToNumber(c15)));
}
function Bool8x16Constructor(A,B,C,D,E,F,G,H,c8,c9,c10,c11,
c12,c13,c14,c15){
if(!(new.target===(void 0))){
throw %make_type_error(66,"Bool8x16");
}
return %CreateBool8x16(A,B,C,D,E,F,G,H,c8,c9,c10,c11,c12,
c13,c14,c15);
}
function Float32x4AbsJS(o){
return %Float32x4Abs(o);
}
function Float32x4SqrtJS(o){
return %Float32x4Sqrt(o);
}
function Float32x4RecipApproxJS(o){
return %Float32x4RecipApprox(o);
}
function Float32x4RecipSqrtApproxJS(o){
return %Float32x4RecipSqrtApprox(o);
}
function Float32x4DivJS(o,v){
return %Float32x4Div(o,v);
}
function Float32x4MinNumJS(o,v){
return %Float32x4MinNum(o,v);
}
function Float32x4MaxNumJS(o,v){
return %Float32x4MaxNum(o,v);
}
%AddNamedProperty(c,d,'SIMD',1|2);
%SetCode(e,Float32x4Constructor);
%FunctionSetPrototype(e,{});
%AddNamedProperty(e.prototype,'constructor',e,
2);
%AddNamedProperty(e.prototype,d,'Float32x4',
2|1);
b.InstallFunctions(e.prototype,2,[
'toLocaleString',Float32x4ToLocaleString,
'toString',Float32x4ToString,
'valueOf',Float32x4ValueOf,
]);


%SetCode(f,Int32x4Constructor);
%FunctionSetPrototype(f,{});
%AddNamedProperty(f.prototype,'constructor',f,
2);
%AddNamedProperty(f.prototype,d,'Int32x4',
2|1);
b.InstallFunctions(f.prototype,2,[
'toLocaleString',Int32x4ToLocaleString,
'toString',Int32x4ToString,
'valueOf',Int32x4ValueOf,
]);

%SetCode(g,Int16x8Constructor);
%FunctionSetPrototype(g,{});
%AddNamedProperty(g.prototype,'constructor',g,
2);
%AddNamedProperty(g.prototype,d,'Int16x8',
2|1);
b.InstallFunctions(g.prototype,2,[
'toLocaleString',Int16x8ToLocaleString,
'toString',Int16x8ToString,
'valueOf',Int16x8ValueOf,
]);

%SetCode(h,Int8x16Constructor);
%FunctionSetPrototype(h,{});
%AddNamedProperty(h.prototype,'constructor',h,
2);
%AddNamedProperty(h.prototype,d,'Int8x16',
2|1);
b.InstallFunctions(h.prototype,2,[
'toLocaleString',Int8x16ToLocaleString,
'toString',Int8x16ToString,
'valueOf',Int8x16ValueOf,
]);


%SetCode(i,Uint32x4Constructor);
%FunctionSetPrototype(i,{});
%AddNamedProperty(i.prototype,'constructor',i,
2);
%AddNamedProperty(i.prototype,d,'Uint32x4',
2|1);
b.InstallFunctions(i.prototype,2,[
'toLocaleString',Uint32x4ToLocaleString,
'toString',Uint32x4ToString,
'valueOf',Uint32x4ValueOf,
]);

%SetCode(j,Uint16x8Constructor);
%FunctionSetPrototype(j,{});
%AddNamedProperty(j.prototype,'constructor',j,
2);
%AddNamedProperty(j.prototype,d,'Uint16x8',
2|1);
b.InstallFunctions(j.prototype,2,[
'toLocaleString',Uint16x8ToLocaleString,
'toString',Uint16x8ToString,
'valueOf',Uint16x8ValueOf,
]);

%SetCode(k,Uint8x16Constructor);
%FunctionSetPrototype(k,{});
%AddNamedProperty(k.prototype,'constructor',k,
2);
%AddNamedProperty(k.prototype,d,'Uint8x16',
2|1);
b.InstallFunctions(k.prototype,2,[
'toLocaleString',Uint8x16ToLocaleString,
'toString',Uint8x16ToString,
'valueOf',Uint8x16ValueOf,
]);


%SetCode(l,Bool32x4Constructor);
%FunctionSetPrototype(l,{});
%AddNamedProperty(l.prototype,'constructor',l,
2);
%AddNamedProperty(l.prototype,d,'Bool32x4',
2|1);
b.InstallFunctions(l.prototype,2,[
'toLocaleString',Bool32x4ToLocaleString,
'toString',Bool32x4ToString,
'valueOf',Bool32x4ValueOf,
]);

%SetCode(m,Bool16x8Constructor);
%FunctionSetPrototype(m,{});
%AddNamedProperty(m.prototype,'constructor',m,
2);
%AddNamedProperty(m.prototype,d,'Bool16x8',
2|1);
b.InstallFunctions(m.prototype,2,[
'toLocaleString',Bool16x8ToLocaleString,
'toString',Bool16x8ToString,
'valueOf',Bool16x8ValueOf,
]);

%SetCode(n,Bool8x16Constructor);
%FunctionSetPrototype(n,{});
%AddNamedProperty(n.prototype,'constructor',n,
2);
%AddNamedProperty(n.prototype,d,'Bool8x16',
2|1);
b.InstallFunctions(n.prototype,2,[
'toLocaleString',Bool8x16ToLocaleString,
'toString',Bool8x16ToString,
'valueOf',Bool8x16ValueOf,
]);



b.InstallFunctions(e,2,[
'splat',Float32x4Splat,
'check',Float32x4CheckJS,
'extractLane',Float32x4ExtractLaneJS,
'replaceLane',Float32x4ReplaceLaneJS,
'neg',Float32x4NegJS,
'abs',Float32x4AbsJS,
'sqrt',Float32x4SqrtJS,
'reciprocalApproximation',Float32x4RecipApproxJS,
'reciprocalSqrtApproximation',Float32x4RecipSqrtApproxJS,
'add',Float32x4AddJS,
'sub',Float32x4SubJS,
'mul',Float32x4MulJS,
'div',Float32x4DivJS,
'min',Float32x4MinJS,
'max',Float32x4MaxJS,
'minNum',Float32x4MinNumJS,
'maxNum',Float32x4MaxNumJS,
'lessThan',Float32x4LessThanJS,
'lessThanOrEqual',Float32x4LessThanOrEqualJS,
'greaterThan',Float32x4GreaterThanJS,
'greaterThanOrEqual',Float32x4GreaterThanOrEqualJS,
'equal',Float32x4EqualJS,
'notEqual',Float32x4NotEqualJS,
'select',Float32x4SelectJS,
'swizzle',Float32x4SwizzleJS,
'shuffle',Float32x4ShuffleJS,
'fromInt32x4',Float32x4FromInt32x4JS,
'fromUint32x4',Float32x4FromUint32x4JS,
'fromInt32x4Bits',Float32x4FromInt32x4BitsJS,
'fromUint32x4Bits',Float32x4FromUint32x4BitsJS,
'fromInt16x8Bits',Float32x4FromInt16x8BitsJS,
'fromUint16x8Bits',Float32x4FromUint16x8BitsJS,
'fromInt8x16Bits',Float32x4FromInt8x16BitsJS,
'fromUint8x16Bits',Float32x4FromUint8x16BitsJS,
'load',Float32x4LoadJS,
'load1',Float32x4Load1JS,
'load2',Float32x4Load2JS,
'load3',Float32x4Load3JS,
'store',Float32x4StoreJS,
'store1',Float32x4Store1JS,
'store2',Float32x4Store2JS,
'store3',Float32x4Store3JS,
]);
b.InstallFunctions(f,2,[
'splat',Int32x4Splat,
'check',Int32x4CheckJS,
'extractLane',Int32x4ExtractLaneJS,
'replaceLane',Int32x4ReplaceLaneJS,
'neg',Int32x4NegJS,
'add',Int32x4AddJS,
'sub',Int32x4SubJS,
'mul',Int32x4MulJS,
'min',Int32x4MinJS,
'max',Int32x4MaxJS,
'and',Int32x4AndJS,
'or',Int32x4OrJS,
'xor',Int32x4XorJS,
'not',Int32x4NotJS,
'shiftLeftByScalar',Int32x4ShiftLeftByScalarJS,
'shiftRightByScalar',Int32x4ShiftRightByScalarJS,
'lessThan',Int32x4LessThanJS,
'lessThanOrEqual',Int32x4LessThanOrEqualJS,
'greaterThan',Int32x4GreaterThanJS,
'greaterThanOrEqual',Int32x4GreaterThanOrEqualJS,
'equal',Int32x4EqualJS,
'notEqual',Int32x4NotEqualJS,
'select',Int32x4SelectJS,
'swizzle',Int32x4SwizzleJS,
'shuffle',Int32x4ShuffleJS,
'fromFloat32x4',Int32x4FromFloat32x4JS,
'fromUint32x4',Int32x4FromUint32x4JS,
'fromFloat32x4Bits',Int32x4FromFloat32x4BitsJS,
'fromUint32x4Bits',Int32x4FromUint32x4BitsJS,
'fromInt16x8Bits',Int32x4FromInt16x8BitsJS,
'fromUint16x8Bits',Int32x4FromUint16x8BitsJS,
'fromInt8x16Bits',Int32x4FromInt8x16BitsJS,
'fromUint8x16Bits',Int32x4FromUint8x16BitsJS,
'load',Int32x4LoadJS,
'load1',Int32x4Load1JS,
'load2',Int32x4Load2JS,
'load3',Int32x4Load3JS,
'store',Int32x4StoreJS,
'store1',Int32x4Store1JS,
'store2',Int32x4Store2JS,
'store3',Int32x4Store3JS,
]);
b.InstallFunctions(i,2,[
'splat',Uint32x4Splat,
'check',Uint32x4CheckJS,
'extractLane',Uint32x4ExtractLaneJS,
'replaceLane',Uint32x4ReplaceLaneJS,
'add',Uint32x4AddJS,
'sub',Uint32x4SubJS,
'mul',Uint32x4MulJS,
'min',Uint32x4MinJS,
'max',Uint32x4MaxJS,
'and',Uint32x4AndJS,
'or',Uint32x4OrJS,
'xor',Uint32x4XorJS,
'not',Uint32x4NotJS,
'shiftLeftByScalar',Uint32x4ShiftLeftByScalarJS,
'shiftRightByScalar',Uint32x4ShiftRightByScalarJS,
'lessThan',Uint32x4LessThanJS,
'lessThanOrEqual',Uint32x4LessThanOrEqualJS,
'greaterThan',Uint32x4GreaterThanJS,
'greaterThanOrEqual',Uint32x4GreaterThanOrEqualJS,
'equal',Uint32x4EqualJS,
'notEqual',Uint32x4NotEqualJS,
'select',Uint32x4SelectJS,
'swizzle',Uint32x4SwizzleJS,
'shuffle',Uint32x4ShuffleJS,
'fromFloat32x4',Uint32x4FromFloat32x4JS,
'fromInt32x4',Uint32x4FromInt32x4JS,
'fromFloat32x4Bits',Uint32x4FromFloat32x4BitsJS,
'fromInt32x4Bits',Uint32x4FromInt32x4BitsJS,
'fromInt16x8Bits',Uint32x4FromInt16x8BitsJS,
'fromUint16x8Bits',Uint32x4FromUint16x8BitsJS,
'fromInt8x16Bits',Uint32x4FromInt8x16BitsJS,
'fromUint8x16Bits',Uint32x4FromUint8x16BitsJS,
'load',Uint32x4LoadJS,
'load1',Uint32x4Load1JS,
'load2',Uint32x4Load2JS,
'load3',Uint32x4Load3JS,
'store',Uint32x4StoreJS,
'store1',Uint32x4Store1JS,
'store2',Uint32x4Store2JS,
'store3',Uint32x4Store3JS,
]);
b.InstallFunctions(l,2,[
'splat',Bool32x4Splat,
'check',Bool32x4CheckJS,
'extractLane',Bool32x4ExtractLaneJS,
'replaceLane',Bool32x4ReplaceLaneJS,
'and',Bool32x4AndJS,
'or',Bool32x4OrJS,
'xor',Bool32x4XorJS,
'not',Bool32x4NotJS,
'anyTrue',Bool32x4AnyTrueJS,
'allTrue',Bool32x4AllTrueJS,
'swizzle',Bool32x4SwizzleJS,
'shuffle',Bool32x4ShuffleJS,
]);
b.InstallFunctions(g,2,[
'splat',Int16x8Splat,
'check',Int16x8CheckJS,
'extractLane',Int16x8ExtractLaneJS,
'replaceLane',Int16x8ReplaceLaneJS,
'neg',Int16x8NegJS,
'add',Int16x8AddJS,
'sub',Int16x8SubJS,
'addSaturate',Int16x8AddSaturateJS,
'subSaturate',Int16x8SubSaturateJS,
'mul',Int16x8MulJS,
'min',Int16x8MinJS,
'max',Int16x8MaxJS,
'and',Int16x8AndJS,
'or',Int16x8OrJS,
'xor',Int16x8XorJS,
'not',Int16x8NotJS,
'shiftLeftByScalar',Int16x8ShiftLeftByScalarJS,
'shiftRightByScalar',Int16x8ShiftRightByScalarJS,
'lessThan',Int16x8LessThanJS,
'lessThanOrEqual',Int16x8LessThanOrEqualJS,
'greaterThan',Int16x8GreaterThanJS,
'greaterThanOrEqual',Int16x8GreaterThanOrEqualJS,
'equal',Int16x8EqualJS,
'notEqual',Int16x8NotEqualJS,
'select',Int16x8SelectJS,
'swizzle',Int16x8SwizzleJS,
'shuffle',Int16x8ShuffleJS,
'fromUint16x8',Int16x8FromUint16x8JS,
'fromFloat32x4Bits',Int16x8FromFloat32x4BitsJS,
'fromInt32x4Bits',Int16x8FromInt32x4BitsJS,
'fromUint32x4Bits',Int16x8FromUint32x4BitsJS,
'fromUint16x8Bits',Int16x8FromUint16x8BitsJS,
'fromInt8x16Bits',Int16x8FromInt8x16BitsJS,
'fromUint8x16Bits',Int16x8FromUint8x16BitsJS,
'load',Int16x8LoadJS,
'store',Int16x8StoreJS,
]);
b.InstallFunctions(j,2,[
'splat',Uint16x8Splat,
'check',Uint16x8CheckJS,
'extractLane',Uint16x8ExtractLaneJS,
'replaceLane',Uint16x8ReplaceLaneJS,
'add',Uint16x8AddJS,
'sub',Uint16x8SubJS,
'addSaturate',Uint16x8AddSaturateJS,
'subSaturate',Uint16x8SubSaturateJS,
'mul',Uint16x8MulJS,
'min',Uint16x8MinJS,
'max',Uint16x8MaxJS,
'and',Uint16x8AndJS,
'or',Uint16x8OrJS,
'xor',Uint16x8XorJS,
'not',Uint16x8NotJS,
'shiftLeftByScalar',Uint16x8ShiftLeftByScalarJS,
'shiftRightByScalar',Uint16x8ShiftRightByScalarJS,
'lessThan',Uint16x8LessThanJS,
'lessThanOrEqual',Uint16x8LessThanOrEqualJS,
'greaterThan',Uint16x8GreaterThanJS,
'greaterThanOrEqual',Uint16x8GreaterThanOrEqualJS,
'equal',Uint16x8EqualJS,
'notEqual',Uint16x8NotEqualJS,
'select',Uint16x8SelectJS,
'swizzle',Uint16x8SwizzleJS,
'shuffle',Uint16x8ShuffleJS,
'fromInt16x8',Uint16x8FromInt16x8JS,
'fromFloat32x4Bits',Uint16x8FromFloat32x4BitsJS,
'fromInt32x4Bits',Uint16x8FromInt32x4BitsJS,
'fromUint32x4Bits',Uint16x8FromUint32x4BitsJS,
'fromInt16x8Bits',Uint16x8FromInt16x8BitsJS,
'fromInt8x16Bits',Uint16x8FromInt8x16BitsJS,
'fromUint8x16Bits',Uint16x8FromUint8x16BitsJS,
'load',Uint16x8LoadJS,
'store',Uint16x8StoreJS,
]);
b.InstallFunctions(m,2,[
'splat',Bool16x8Splat,
'check',Bool16x8CheckJS,
'extractLane',Bool16x8ExtractLaneJS,
'replaceLane',Bool16x8ReplaceLaneJS,
'and',Bool16x8AndJS,
'or',Bool16x8OrJS,
'xor',Bool16x8XorJS,
'not',Bool16x8NotJS,
'anyTrue',Bool16x8AnyTrueJS,
'allTrue',Bool16x8AllTrueJS,
'swizzle',Bool16x8SwizzleJS,
'shuffle',Bool16x8ShuffleJS,
]);
b.InstallFunctions(h,2,[
'splat',Int8x16Splat,
'check',Int8x16CheckJS,
'extractLane',Int8x16ExtractLaneJS,
'replaceLane',Int8x16ReplaceLaneJS,
'neg',Int8x16NegJS,
'add',Int8x16AddJS,
'sub',Int8x16SubJS,
'addSaturate',Int8x16AddSaturateJS,
'subSaturate',Int8x16SubSaturateJS,
'mul',Int8x16MulJS,
'min',Int8x16MinJS,
'max',Int8x16MaxJS,
'and',Int8x16AndJS,
'or',Int8x16OrJS,
'xor',Int8x16XorJS,
'not',Int8x16NotJS,
'shiftLeftByScalar',Int8x16ShiftLeftByScalarJS,
'shiftRightByScalar',Int8x16ShiftRightByScalarJS,
'lessThan',Int8x16LessThanJS,
'lessThanOrEqual',Int8x16LessThanOrEqualJS,
'greaterThan',Int8x16GreaterThanJS,
'greaterThanOrEqual',Int8x16GreaterThanOrEqualJS,
'equal',Int8x16EqualJS,
'notEqual',Int8x16NotEqualJS,
'select',Int8x16SelectJS,
'swizzle',Int8x16SwizzleJS,
'shuffle',Int8x16ShuffleJS,
'fromUint8x16',Int8x16FromUint8x16JS,
'fromFloat32x4Bits',Int8x16FromFloat32x4BitsJS,
'fromInt32x4Bits',Int8x16FromInt32x4BitsJS,
'fromUint32x4Bits',Int8x16FromUint32x4BitsJS,
'fromInt16x8Bits',Int8x16FromInt16x8BitsJS,
'fromUint16x8Bits',Int8x16FromUint16x8BitsJS,
'fromUint8x16Bits',Int8x16FromUint8x16BitsJS,
'load',Int8x16LoadJS,
'store',Int8x16StoreJS,
]);
b.InstallFunctions(k,2,[
'splat',Uint8x16Splat,
'check',Uint8x16CheckJS,
'extractLane',Uint8x16ExtractLaneJS,
'replaceLane',Uint8x16ReplaceLaneJS,
'add',Uint8x16AddJS,
'sub',Uint8x16SubJS,
'addSaturate',Uint8x16AddSaturateJS,
'subSaturate',Uint8x16SubSaturateJS,
'mul',Uint8x16MulJS,
'min',Uint8x16MinJS,
'max',Uint8x16MaxJS,
'and',Uint8x16AndJS,
'or',Uint8x16OrJS,
'xor',Uint8x16XorJS,
'not',Uint8x16NotJS,
'shiftLeftByScalar',Uint8x16ShiftLeftByScalarJS,
'shiftRightByScalar',Uint8x16ShiftRightByScalarJS,
'lessThan',Uint8x16LessThanJS,
'lessThanOrEqual',Uint8x16LessThanOrEqualJS,
'greaterThan',Uint8x16GreaterThanJS,
'greaterThanOrEqual',Uint8x16GreaterThanOrEqualJS,
'equal',Uint8x16EqualJS,
'notEqual',Uint8x16NotEqualJS,
'select',Uint8x16SelectJS,
'swizzle',Uint8x16SwizzleJS,
'shuffle',Uint8x16ShuffleJS,
'fromInt8x16',Uint8x16FromInt8x16JS,
'fromFloat32x4Bits',Uint8x16FromFloat32x4BitsJS,
'fromInt32x4Bits',Uint8x16FromInt32x4BitsJS,
'fromUint32x4Bits',Uint8x16FromUint32x4BitsJS,
'fromInt16x8Bits',Uint8x16FromInt16x8BitsJS,
'fromUint16x8Bits',Uint8x16FromUint16x8BitsJS,
'fromInt8x16Bits',Uint8x16FromInt8x16BitsJS,
'load',Uint8x16LoadJS,
'store',Uint8x16StoreJS,
]);
b.InstallFunctions(n,2,[
'splat',Bool8x16Splat,
'check',Bool8x16CheckJS,
'extractLane',Bool8x16ExtractLaneJS,
'replaceLane',Bool8x16ReplaceLaneJS,
'and',Bool8x16AndJS,
'or',Bool8x16OrJS,
'xor',Bool8x16XorJS,
'not',Bool8x16NotJS,
'anyTrue',Bool8x16AnyTrueJS,
'allTrue',Bool8x16AllTrueJS,
'swizzle',Bool8x16SwizzleJS,
'shuffle',Bool8x16ShuffleJS,
]);
})

Xharmony-string-paddingY
(function(a,b){
%CheckIsBootstrapping();
var c=a.String;
function StringPad(d,e,f){
e=(%_ToLength(e));
var g=d.length;
if(e<=g)return"";
if((f===(void 0))){
f=" ";
}else{
f=(%_ToString(f));
if(f===""){
return"";
}
}
var h=e-g;
var i=(h/f.length)|0;
var j=(h-f.length*i)|0;
var k="";
while(true){
if(i&1)k+=f;
i>>=1;
if(i===0)break;
f+=f;
}
if(j){
k+=%_SubString(f,0,j);
}
return k;
}
function StringPadStart(e,f){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.padStart")
var d=(%_ToString(this));
return StringPad(d,e,f)+d;
}
%FunctionSetLength(StringPadStart,1);
function StringPadEnd(e,f){
if((%IS_VAR(this)===null)||(this===(void 0)))throw %make_type_error(17,"String.prototype.padEnd")
var d=(%_ToString(this));
return d+StringPad(d,e,f);
}
%FunctionSetLength(StringPadEnd,1);
b.InstallFunctions(c.prototype,2,[
"padStart",StringPadStart,
"padEnd",StringPadEnd
]);
});

@icu-case-mapping±
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.String;
var d=b.OverrideFunction;
var e=b.ImportNow("ToLowerCaseI18N");
var f=b.ImportNow("ToUpperCaseI18N");
var g=b.ImportNow("ToLocaleLowerCaseI18N");
var h=b.ImportNow("ToLocaleUpperCaseI18N");
d(c.prototype,'toLowerCase',e,true);
d(c.prototype,'toUpperCase',f,true);
d(c.prototype,'toLocaleLowerCase',
g,true);
d(c.prototype,'toLocaleUpperCase',
h,true);
})

(intl-extram
(function(a,b){
"use strict";
%CheckIsBootstrapping();
var c=a.Intl;
var d=b.ImportNow("AddBoundMethod");
var e=b.ImportNow("IntlParseDate");
var f=b.ImportNow("IntlParseNumber");
d(c.DateTimeFormat,'v8Parse',e,1,
'dateformat');
d(c.NumberFormat,'v8Parse',f,1,
'numberformat');
})

 dByteLengthQueuingStrategy—
(function(global, binding, v8) {
  'use strict';
  const defineProperty = global.Object.defineProperty;
  class ByteLengthQueuingStrategy {
    constructor(options) {
      defineProperty(this, 'highWaterMark', {
        value: options.highWaterMark,
        enumerable: true,
        configurable: true,
        writable: true
      });
    }
    size(chunk) { return chunk.byteLength; }
  }
  defineProperty(global, 'ByteLengthQueuingStrategy', {
    value: ByteLengthQueuingStrategy,
    enumerable: false,
    configurable: true,
    writable: true
  });
});
PCountQueuingStrategy˝
(function(global, binding, v8) {
  'use strict';
  const defineProperty = global.Object.defineProperty;
  class CountQueuingStrategy {
    constructor(options) {
      defineProperty(this, 'highWaterMark', {
        value: options.highWaterMark,
        enumerable: true,
        configurable: true,
        writable: true
      });
    }
    size(chunk) { return 1; }
  }
  defineProperty(global, 'CountQueuingStrategy', {
    value: CountQueuingStrategy,
    enumerable: false,
    configurable: true,
    writable: true
  });
  class BuiltInCountQueuingStrategy {
    constructor(highWaterMark) {
      defineProperty(this, 'highWaterMark', {value: highWaterMark});
    }
    size(chunk) { return 1; }
  }
  binding.createBuiltInCountQueuingStrategy = highWaterMark =>
      new BuiltInCountQueuingStrategy(highWaterMark);
});
8ReadableStream6›
(function(global, binding, v8) {
  'use strict';
  const readableStreamReader = v8.createPrivateSymbol('[[reader]]');
  const readableStreamStoredError = v8.createPrivateSymbol('[[storedError]]');
  const readableStreamController = v8.createPrivateSymbol('[[controller]]');
  const readableStreamReaderClosedPromise =
      v8.createPrivateSymbol('[[closedPromise]]');
  const readableStreamReaderOwnerReadableStream =
      v8.createPrivateSymbol('[[ownerReadableStream]]');
  const readableStreamDefaultReaderReadRequests =
      v8.createPrivateSymbol('[[readRequests]]');
  const createWithExternalControllerSentinel =
      v8.createPrivateSymbol('flag for UA-created ReadableStream to pass');
  const readableStreamBits = v8.createPrivateSymbol('bit field for [[state]] and [[disturbed]]');
  const DISTURBED = 0b1;
  const STATE_MASK = 0b110;
  const STATE_BITS_OFFSET = 1;
  const STATE_READABLE = 0;
  const STATE_CLOSED = 1;
  const STATE_ERRORED = 2;
  const readableStreamDefaultControllerUnderlyingSource =
      v8.createPrivateSymbol('[[underlyingSource]]');
  const readableStreamDefaultControllerControlledReadableStream =
      v8.createPrivateSymbol('[[controlledReadableStream]]');
  const readableStreamDefaultControllerQueue = v8.createPrivateSymbol('[[queue]]');
  const readableStreamDefaultControllerQueueSize =
      v8.createPrivateSymbol('[[queue]] total size');
  const readableStreamDefaultControllerStrategySize =
      v8.createPrivateSymbol('[[strategySize]]');
  const readableStreamDefaultControllerStrategyHWM =
      v8.createPrivateSymbol('[[strategyHWM]]');
  const readableStreamDefaultControllerBits = v8.createPrivateSymbol(
      'bit field for [[started]], [[closeRequested]], [[pulling]], [[pullAgain]]');
  const STARTED = 0b1;
  const CLOSE_REQUESTED = 0b10;
  const PULLING = 0b100;
  const PULL_AGAIN = 0b1000;
  const EXTERNALLY_CONTROLLED = 0b10000;
  const readableStreamControllerCancel =
      v8.createPrivateSymbol('[[InternalCancel]]');
  const readableStreamControllerPull = v8.createPrivateSymbol('[[InternalPull]]');
  const undefined = global.undefined;
  const Infinity = global.Infinity;
  const defineProperty = global.Object.defineProperty;
  const hasOwnProperty = v8.uncurryThis(global.Object.hasOwnProperty);
  const callFunction = v8.uncurryThis(global.Function.prototype.call);
  const TypeError = global.TypeError;
  const RangeError = global.RangeError;
  const Number = global.Number;
  const Number_isNaN = Number.isNaN;
  const Number_isFinite = Number.isFinite;
  const Promise = global.Promise;
  const thenPromise = v8.uncurryThis(Promise.prototype.then);
  const Promise_resolve = v8.simpleBind(Promise.resolve, Promise);
  const Promise_reject = v8.simpleBind(Promise.reject, Promise);
  const errIllegalInvocation = 'Illegal invocation';
  const errIllegalConstructor = 'Illegal constructor';
  const errCancelLockedStream =
      'Cannot cancel a readable stream that is locked to a reader';
  const errEnqueueCloseRequestedStream =
      'Cannot enqueue a chunk into a readable stream that is closed or has been requested to be closed';
  const errCancelReleasedReader =
      'This readable stream reader has been released and cannot be used to cancel its previous owner stream';
  const errReadReleasedReader =
      'This readable stream reader has been released and cannot be used to read from its previous owner stream';
  const errCloseCloseRequestedStream =
      'Cannot close a readable stream that has already been requested to be closed';
  const errEnqueueClosedStream = 'Cannot enqueue a chunk into a closed readable stream';
  const errEnqueueErroredStream = 'Cannot enqueue a chunk into an errored readable stream';
  const errCloseClosedStream = 'Cannot close a closed readable stream';
  const errCloseErroredStream = 'Cannot close an errored readable stream';
  const errErrorClosedStream = 'Cannot error a close readable stream';
  const errErrorErroredStream =
      'Cannot error a readable stream that is already errored';
  const errGetReaderNotByteStream = 'This readable stream does not support BYOB readers';
  const errGetReaderBadMode = 'Invalid reader mode given: expected undefined or "byob"';
  const errReaderConstructorBadArgument =
      'ReadableStreamReader constructor argument is not a readable stream';
  const errReaderConstructorStreamAlreadyLocked =
      'ReadableStreamReader constructor can only accept readable streams that are not yet locked to a reader';
  const errReleaseReaderWithPendingRead =
      'Cannot release a readable stream reader when it still has outstanding read() calls that have not yet settled';
  const errReleasedReaderClosedPromise =
      'This readable stream reader has been released and cannot be used to monitor the stream\'s state';
  const errInvalidSize =
      'The return value of a queuing strategy\'s size function must be a finite, non-NaN, non-negative number';
  const errSizeNotAFunction =
      'A queuing strategy\'s size property must be a function';
  const errInvalidHWM =
      'A queueing strategy\'s highWaterMark property must be a nonnegative, non-NaN number';
  const errTmplMustBeFunctionOrUndefined = name =>
      `${name} must be a function or undefined`;
  class ReadableStream {
    constructor() {
      const underlyingSource = arguments[0] === undefined ? {} : arguments[0];
      const strategy = arguments[1] === undefined ? {} : arguments[1];
      const size = strategy.size;
      let highWaterMark = strategy.highWaterMark;
      if (highWaterMark === undefined) {
        highWaterMark = 1;
      }
      this[readableStreamBits] = 0b0;
      ReadableStreamSetState(this, STATE_READABLE);
      this[readableStreamReader] = undefined;
      this[readableStreamStoredError] = undefined;
      this[readableStreamController] = undefined;
      const type = underlyingSource.type;
      const typeString = String(type);
      if (typeString === 'bytes') {
        throw new RangeError('bytes type is not yet implemented');
      } else if (type !== undefined) {
        throw new RangeError('Invalid type is specified');
      }
      this[readableStreamController] =
          new ReadableStreamDefaultController(this, underlyingSource, size, highWaterMark, arguments[2] === createWithExternalControllerSentinel);
    }
    get locked() {
      if (IsReadableStream(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      return IsReadableStreamLocked(this);
    }
    cancel(reason) {
      if (IsReadableStream(this) === false) {
        return Promise_reject(new TypeError(errIllegalInvocation));
      }
      if (IsReadableStreamLocked(this) === true) {
        return Promise_reject(new TypeError(errCancelLockedStream));
      }
      return ReadableStreamCancel(this, reason);
    }
    getReader({ mode } = {}) {
      if (IsReadableStream(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      if (mode === 'byob') {
        if (IsReadableByteStreamDefaultController(this[readableStreamController]) === false) {
          throw new TypeError(errGetReaderNotByteStream);
        }
        return AcquireReadableStreamBYOBReader(this);
      }
      if (mode === undefined) {
        return AcquireReadableStreamDefaultReader(this);
      }
      throw new RangeError(errGetReaderBadMode);
    }
    tee() {
      if (IsReadableStream(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      return ReadableStreamTee(this);
    }
  }
  class ReadableStreamDefaultController {
    constructor(stream, underlyingSource, size, highWaterMark, isExternallyControlled) {
      if (IsReadableStream(stream) === false) {
        throw new TypeError(errIllegalConstructor);
      }
      if (stream[readableStreamController] !== undefined) {
        throw new TypeError(errIllegalConstructor);
      }
      this[readableStreamDefaultControllerControlledReadableStream] = stream;
      this[readableStreamDefaultControllerUnderlyingSource] = underlyingSource;
      this[readableStreamDefaultControllerQueue] = new v8.InternalPackedArray();
      this[readableStreamDefaultControllerQueueSize] = 0;
      this[readableStreamDefaultControllerBits] = 0b0;
      if (isExternallyControlled === true) {
        this[readableStreamDefaultControllerBits] |= EXTERNALLY_CONTROLLED;
      }
      const normalizedStrategy =
          ValidateAndNormalizeQueuingStrategy(size, highWaterMark);
      this[readableStreamDefaultControllerStrategySize] = normalizedStrategy.size;
      this[readableStreamDefaultControllerStrategyHWM] = normalizedStrategy.highWaterMark;
      const controller = this;
      const startResult = CallOrNoop(
          underlyingSource, 'start', this, 'underlyingSource.start');
      thenPromise(Promise_resolve(startResult),
          () => {
            controller[readableStreamDefaultControllerBits] |= STARTED;
            ReadableStreamDefaultControllerCallPullIfNeeded(controller);
          },
          r => {
            if (ReadableStreamGetState(stream) === STATE_READABLE) {
              ReadableStreamDefaultControllerError(controller, r);
            }
          });
    }
    get desiredSize() {
      if (IsReadableStreamDefaultController(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      return ReadableStreamDefaultControllerGetDesiredSize(this);
    }
    close() {
      if (IsReadableStreamDefaultController(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      const stream = this[readableStreamDefaultControllerControlledReadableStream];
      if (this[readableStreamDefaultControllerBits] & CLOSE_REQUESTED) {
        throw new TypeError(errCloseCloseRequestedStream);
      }
      const state = ReadableStreamGetState(stream);
      if (state === STATE_ERRORED) {
        throw new TypeError(errCloseErroredStream);
      }
      if (state === STATE_CLOSED) {
        throw new TypeError(errCloseClosedStream);
      }
      return ReadableStreamDefaultControllerClose(this);
    }
    enqueue(chunk) {
      if (IsReadableStreamDefaultController(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      const stream = this[readableStreamDefaultControllerControlledReadableStream];
      if (this[readableStreamDefaultControllerBits] & CLOSE_REQUESTED) {
        throw new TypeError(errEnqueueCloseRequestedStream);
      }
      const state = ReadableStreamGetState(stream);
      if (state === STATE_ERRORED) {
        throw new TypeError(errEnqueueErroredStream);
      }
      if (state === STATE_CLOSED) {
        throw new TypeError(errEnqueueClosedStream);
      }
      return ReadableStreamDefaultControllerEnqueue(this, chunk);
    }
    error(e) {
      if (IsReadableStreamDefaultController(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      const stream = this[readableStreamDefaultControllerControlledReadableStream];
      const state = ReadableStreamGetState(stream);
      if (state === STATE_ERRORED) {
        throw new TypeError(errErrorErroredStream);
      }
      if (state === STATE_CLOSED) {
        throw new TypeError(errErrorClosedStream);
      }
      return ReadableStreamDefaultControllerError(this, e);
    }
  }
  function ReadableStreamDefaultControllerCancel(controller, reason) {
    controller[readableStreamDefaultControllerQueue] = new v8.InternalPackedArray();
    const underlyingSource = controller[readableStreamDefaultControllerUnderlyingSource];
    return PromiseCallOrNoop(underlyingSource, 'cancel', reason, 'underlyingSource.cancel');
  }
  function ReadableStreamDefaultControllerPull(controller) {
    const stream = controller[readableStreamDefaultControllerControlledReadableStream];
    if (controller[readableStreamDefaultControllerQueue].length > 0) {
      const chunk = DequeueValue(controller);
      if ((controller[readableStreamDefaultControllerBits] & CLOSE_REQUESTED) &&
          controller[readableStreamDefaultControllerQueue].length === 0) {
        ReadableStreamClose(stream);
      } else {
        ReadableStreamDefaultControllerCallPullIfNeeded(controller);
      }
      return Promise_resolve(CreateIterResultObject(chunk, false));
    }
    const pendingPromise = ReadableStreamAddReadRequest(stream);
    ReadableStreamDefaultControllerCallPullIfNeeded(controller);
    return pendingPromise;
  }
  function ReadableStreamAddReadRequest(stream) {
    const promise = v8.createPromise();
    stream[readableStreamReader][readableStreamDefaultReaderReadRequests].push(promise);
    return promise;
  }
  class ReadableStreamDefaultReader {
    constructor(stream) {
      if (IsReadableStream(stream) === false) {
        throw new TypeError(errReaderConstructorBadArgument);
      }
      if (IsReadableStreamLocked(stream) === true) {
        throw new TypeError(errReaderConstructorStreamAlreadyLocked);
      }
      ReadableStreamReaderGenericInitialize(this, stream);
      this[readableStreamDefaultReaderReadRequests] = new v8.InternalPackedArray();
    }
    get closed() {
      if (IsReadableStreamDefaultReader(this) === false) {
        return Promise_reject(new TypeError(errIllegalInvocation));
      }
      return this[readableStreamReaderClosedPromise];
    }
    cancel(reason) {
      if (IsReadableStreamDefaultReader(this) === false) {
        return Promise_reject(new TypeError(errIllegalInvocation));
      }
      const stream = this[readableStreamReaderOwnerReadableStream];
      if (stream === undefined) {
        return Promise_reject(new TypeError(errCancelReleasedReader));
      }
      return ReadableStreamReaderGenericCancel(this, reason);
    }
    read() {
      if (IsReadableStreamDefaultReader(this) === false) {
        return Promise_reject(new TypeError(errIllegalInvocation));
      }
      if (this[readableStreamReaderOwnerReadableStream] === undefined) {
        return Promise_reject(new TypeError(errReadReleasedReader));
      }
      return ReadableStreamDefaultReaderRead(this);
    }
    releaseLock() {
      if (IsReadableStreamDefaultReader(this) === false) {
        throw new TypeError(errIllegalInvocation);
      }
      const stream = this[readableStreamReaderOwnerReadableStream];
      if (stream === undefined) {
        return undefined;
      }
      if (this[readableStreamDefaultReaderReadRequests].length > 0) {
        throw new TypeError(errReleaseReaderWithPendingRead);
      }
      ReadableStreamReaderGenericRelease(this);
    }
  }
  function ReadableStreamReaderGenericCancel(reader, reason) {
    return ReadableStreamCancel(reader[readableStreamReaderOwnerReadableStream], reason);
  }
  function AcquireReadableStreamDefaultReader(stream) {
    return new ReadableStreamDefaultReader(stream);
  }
  function ReadableStreamCancel(stream, reason) {
    stream[readableStreamBits] |= DISTURBED;
    const state = ReadableStreamGetState(stream);
    if (state === STATE_CLOSED) {
      return Promise_resolve(undefined);
    }
    if (state === STATE_ERRORED) {
      return Promise_reject(stream[readableStreamStoredError]);
    }
    ReadableStreamClose(stream);
    const sourceCancelPromise = ReadableStreamDefaultControllerCancel(stream[readableStreamController], reason);
    return thenPromise(sourceCancelPromise, () => undefined);
  }
  function ReadableStreamDefaultControllerClose(controller) {
    const stream = controller[readableStreamDefaultControllerControlledReadableStream];
    controller[readableStreamDefaultControllerBits] |= CLOSE_REQUESTED;
    if (controller[readableStreamDefaultControllerQueue].length === 0) {
      ReadableStreamClose(stream);
    }
  }
  function ReadableStreamFulfillReadRequest(stream, chunk, done) {
    const reader = stream[readableStreamReader];
    const readRequest =
        stream[readableStreamReader][readableStreamDefaultReaderReadRequests]
        .shift();
    v8.resolvePromise(readRequest, CreateIterResultObject(chunk, done));
  }
  function ReadableStreamDefaultControllerEnqueue(controller, chunk) {
    const stream = controller[readableStreamDefaultControllerControlledReadableStream];
    if (IsReadableStreamLocked(stream) === true && ReadableStreamGetNumReadRequests(stream) > 0) {
      ReadableStreamFulfillReadRequest(stream, chunk, false);
    } else {
      let chunkSize = 1;
      const strategySize = controller[readableStreamDefaultControllerStrategySize];
      if (strategySize !== undefined) {
        try {
          chunkSize = strategySize(chunk);
        } catch (chunkSizeE) {
          if (ReadableStreamGetState(stream) === STATE_READABLE) {
            ReadableStreamDefaultControllerError(controller, chunkSizeE);
          }
          throw chunkSizeE;
        }
      }
      try {
        EnqueueValueWithSize(controller, chunk, chunkSize);
      } catch (enqueueE) {
        if (ReadableStreamGetState(stream) === STATE_READABLE) {
          ReadableStreamDefaultControllerError(controller, enqueueE);
        }
        throw enqueueE;
      }
    }
    ReadableStreamDefaultControllerCallPullIfNeeded(controller);
  }
  function ReadableStreamGetState(stream) {
    return (stream[readableStreamBits] & STATE_MASK) >> STATE_BITS_OFFSET;
  }
  function ReadableStreamSetState(stream, state) {
    stream[readableStreamBits] = (stream[readableStreamBits] & ~STATE_MASK) |
        (state << STATE_BITS_OFFSET);
  }
  function ReadableStreamDefaultControllerError(controller, e) {
    controller[readableStreamDefaultControllerQueue] = new v8.InternalPackedArray();
    const stream = controller[readableStreamDefaultControllerControlledReadableStream];
    ReadableStreamError(stream, e);
  }
  function ReadableStreamError(stream, e) {
    stream[readableStreamStoredError] = e;
    ReadableStreamSetState(stream, STATE_ERRORED);
    const reader = stream[readableStreamReader];
    if (reader === undefined) {
      return undefined;
    }
    if (IsReadableStreamDefaultReader(reader) === true) {
      const readRequests = reader[readableStreamDefaultReaderReadRequests];
      for (let i = 0; i < readRequests.length; i++) {
        v8.rejectPromise(readRequests[i], e);
      }
      reader[readableStreamDefaultReaderReadRequests] = new v8.InternalPackedArray();
    }
    v8.rejectPromise(reader[readableStreamReaderClosedPromise], e);
  }
  function ReadableStreamClose(stream) {
    ReadableStreamSetState(stream, STATE_CLOSED);
    const reader = stream[readableStreamReader];
    if (reader === undefined) {
      return undefined;
    }
    if (IsReadableStreamDefaultReader(reader) === true) {
      const readRequests = reader[readableStreamDefaultReaderReadRequests];
      for (let i = 0; i < readRequests.length; i++) {
        v8.resolvePromise(
            readRequests[i], CreateIterResultObject(undefined, true));
      }
      reader[readableStreamDefaultReaderReadRequests] = new v8.InternalPackedArray();
    }
    v8.resolvePromise(reader[readableStreamReaderClosedPromise], undefined);
  }
  function ReadableStreamDefaultControllerGetDesiredSize(controller) {
    const queueSize = GetTotalQueueSize(controller);
    return controller[readableStreamDefaultControllerStrategyHWM] - queueSize;
  }
  function IsReadableStream(x) {
    return hasOwnProperty(x, readableStreamController);
  }
  function IsReadableStreamDisturbed(stream) {
    return stream[readableStreamBits] & DISTURBED;
  }
  function IsReadableStreamLocked(stream) {
    return stream[readableStreamReader] !== undefined;
  }
  function IsReadableStreamDefaultController(x) {
    return hasOwnProperty(x, readableStreamDefaultControllerControlledReadableStream);
  }
  function IsReadableStreamDefaultReader(x) {
    return hasOwnProperty(x, readableStreamDefaultReaderReadRequests);
  }
  function IsReadableStreamReadable(stream) {
    return ReadableStreamGetState(stream) === STATE_READABLE;
  }
  function IsReadableStreamClosed(stream) {
    return ReadableStreamGetState(stream) === STATE_CLOSED;
  }
  function IsReadableStreamErrored(stream) {
    return ReadableStreamGetState(stream) === STATE_ERRORED;
  }
  function ReadableStreamReaderGenericInitialize(reader, stream) {
    const controller = stream[readableStreamController];
    if (controller[readableStreamDefaultControllerBits] & EXTERNALLY_CONTROLLED) {
      const underlyingSource = controller[readableStreamDefaultControllerUnderlyingSource];
      callFunction(underlyingSource.notifyLockAcquired, underlyingSource);
    }
    reader[readableStreamReaderOwnerReadableStream] = stream;
    stream[readableStreamReader] = reader;
    switch (ReadableStreamGetState(stream)) {
      case STATE_READABLE:
        reader[readableStreamReaderClosedPromise] = v8.createPromise();
        break;
      case STATE_CLOSED:
        reader[readableStreamReaderClosedPromise] = Promise_resolve(undefined);
        break;
      case STATE_ERRORED:
        reader[readableStreamReaderClosedPromise] =
            Promise_reject(stream[readableStreamStoredError]);
      break;
    }
  }
  function ReadableStreamReaderGenericRelease(reader) {
    const controller = reader[readableStreamReaderOwnerReadableStream][readableStreamController];
    if (controller[readableStreamDefaultControllerBits] & EXTERNALLY_CONTROLLED) {
      const underlyingSource = controller[readableStreamDefaultControllerUnderlyingSource];
      callFunction(underlyingSource.notifyLockReleased, underlyingSource);
    }
    if (ReadableStreamGetState(reader[readableStreamReaderOwnerReadableStream]) === STATE_READABLE) {
      v8.rejectPromise(reader[readableStreamReaderClosedPromise], new TypeError(errReleasedReaderClosedPromise));
    } else {
      reader[readableStreamReaderClosedPromise] = Promise_reject(new TypeError(errReleasedReaderClosedPromise));
    }
    reader[readableStreamReaderOwnerReadableStream][readableStreamReader] =
        undefined;
    reader[readableStreamReaderOwnerReadableStream] = undefined;
  }
  function ReadableStreamDefaultReaderRead(reader) {
    const stream = reader[readableStreamReaderOwnerReadableStream];
    stream[readableStreamBits] |= DISTURBED;
    if (ReadableStreamGetState(stream) === STATE_CLOSED) {
      return Promise_resolve(CreateIterResultObject(undefined, true));
    }
    if (ReadableStreamGetState(stream) === STATE_ERRORED) {
      return Promise_reject(stream[readableStreamStoredError]);
    }
    return ReadableStreamDefaultControllerPull(stream[readableStreamController]);
  }
  function ReadableStreamDefaultControllerCallPullIfNeeded(controller) {
    const shouldPull = ReadableStreamDefaultControllerShouldCallPull(controller);
    if (shouldPull === false) {
      return undefined;
    }
    if (controller[readableStreamDefaultControllerBits] & PULLING) {
      controller[readableStreamDefaultControllerBits] |= PULL_AGAIN;
      return undefined;
    }
    controller[readableStreamDefaultControllerBits] |= PULLING;
    const underlyingSource = controller[readableStreamDefaultControllerUnderlyingSource];
    const pullPromise = PromiseCallOrNoop(
        underlyingSource, 'pull', controller, 'underlyingSource.pull');
    thenPromise(pullPromise,
        () => {
          controller[readableStreamDefaultControllerBits] &= ~PULLING;
          if (controller[readableStreamDefaultControllerBits] & PULL_AGAIN) {
            controller[readableStreamDefaultControllerBits] &= ~PULL_AGAIN;
            ReadableStreamDefaultControllerCallPullIfNeeded(controller);
          }
        },
        e => {
          if (ReadableStreamGetState(controller[readableStreamDefaultControllerControlledReadableStream]) === STATE_READABLE) {
            ReadableStreamDefaultControllerError(controller, e);
          }
        });
  }
  function ReadableStreamDefaultControllerShouldCallPull(controller) {
    const stream = controller[readableStreamDefaultControllerControlledReadableStream];
    const state = ReadableStreamGetState(stream);
    if (state === STATE_CLOSED || state === STATE_ERRORED) {
      return false;
    }
    if (controller[readableStreamDefaultControllerBits] & CLOSE_REQUESTED) {
      return false;
    }
    if (!(controller[readableStreamDefaultControllerBits] & STARTED)) {
      return false;
    }
    if (IsReadableStreamLocked(stream) === true && ReadableStreamGetNumReadRequests(stream) > 0) {
      return true;
    }
    const desiredSize = ReadableStreamDefaultControllerGetDesiredSize(controller);
    if (desiredSize > 0) {
      return true;
    }
    return false;
  }
  function ReadableStreamGetNumReadRequests(stream) {
    const reader = stream[readableStreamReader];
    const readRequests = reader[readableStreamDefaultReaderReadRequests];
    return readRequests.length;
  }
  function ReadableStreamTee(stream) {
    const reader = AcquireReadableStreamDefaultReader(stream);
    let closedOrErrored = false;
    let canceled1 = false;
    let canceled2 = false;
    let reason1;
    let reason2;
    let promise = v8.createPromise();
    const branch1Stream = new ReadableStream({pull, cancel: cancel1});
    const branch2Stream = new ReadableStream({pull, cancel: cancel2});
    const branch1 = branch1Stream[readableStreamController];
    const branch2 = branch2Stream[readableStreamController];
    thenPromise(
        reader[readableStreamReaderClosedPromise], undefined, function(r) {
          if (closedOrErrored === true) {
            return;
          }
          ReadableStreamDefaultControllerError(branch1, r);
          ReadableStreamDefaultControllerError(branch2, r);
          closedOrErrored = true;
        });
    return [branch1Stream, branch2Stream];
    function pull() {
      return thenPromise(
          ReadableStreamDefaultReaderRead(reader), function(result) {
            const value = result.value;
            const done = result.done;
            if (done === true && closedOrErrored === false) {
              if (canceled1 === false) {
                ReadableStreamDefaultControllerClose(branch1);
              }
              if (canceled2 === false) {
                ReadableStreamDefaultControllerClose(branch2);
              }
              closedOrErrored = true;
            }
            if (closedOrErrored === true) {
              return;
            }
            if (canceled1 === false) {
              ReadableStreamDefaultControllerEnqueue(branch1, value);
            }
            if (canceled2 === false) {
              ReadableStreamDefaultControllerEnqueue(branch2, value);
            }
          });
    }
    function cancel1(reason) {
      canceled1 = true;
      reason1 = reason;
      if (canceled2 === true) {
        const compositeReason = [reason1, reason2];
        const cancelResult = ReadableStreamCancel(stream, compositeReason);
        v8.resolvePromise(promise, cancelResult);
      }
      return promise;
    }
    function cancel2(reason) {
      canceled2 = true;
      reason2 = reason;
      if (canceled1 === true) {
        const compositeReason = [reason1, reason2];
        const cancelResult = ReadableStreamCancel(stream, compositeReason);
        v8.resolvePromise(promise, cancelResult);
      }
      return promise;
    }
  }
  function DequeueValue(controller) {
    const result = controller[readableStreamDefaultControllerQueue].shift();
    controller[readableStreamDefaultControllerQueueSize] -= result.size;
    return result.value;
  }
  function EnqueueValueWithSize(controller, value, size) {
    size = Number(size);
    if (Number_isNaN(size) || size === +Infinity || size < 0) {
      throw new RangeError(errInvalidSize);
    }
    controller[readableStreamDefaultControllerQueueSize] += size;
    controller[readableStreamDefaultControllerQueue].push({value, size});
  }
  function GetTotalQueueSize(controller) { return controller[readableStreamDefaultControllerQueueSize]; }
  function ValidateAndNormalizeQueuingStrategy(size, highWaterMark) {
    if (size !== undefined && typeof size !== 'function') {
      throw new TypeError(errSizeNotAFunction);
    }
    highWaterMark = Number(highWaterMark);
    if (Number_isNaN(highWaterMark)) {
      throw new TypeError(errInvalidHWM);
    }
    if (highWaterMark < 0) {
      throw new RangeError(errInvalidHWM);
    }
    return {size, highWaterMark};
  }
  function CallOrNoop(O, P, arg, nameForError) {
    const method = O[P];
    if (method === undefined) {
      return undefined;
    }
    if (typeof method !== 'function') {
      throw new TypeError(errTmplMustBeFunctionOrUndefined(nameForError));
    }
    return callFunction(method, O, arg);
  }
  function PromiseCallOrNoop(O, P, arg, nameForError) {
    let method;
    try {
      method = O[P];
    } catch (methodE) {
      return Promise_reject(methodE);
    }
    if (method === undefined) {
      return Promise_resolve(undefined);
    }
    if (typeof method !== 'function') {
      return Promise_reject(new TypeError(errTmplMustBeFunctionOrUndefined(nameForError)));
    }
    try {
      return Promise_resolve(callFunction(method, O, arg));
    } catch (e) {
      return Promise_reject(e);
    }
  }
  function CreateIterResultObject(value, done) { return {value, done}; }
  defineProperty(global, 'ReadableStream', {
    value: ReadableStream,
    enumerable: false,
    configurable: true,
    writable: true
  });
  binding.AcquireReadableStreamDefaultReader = AcquireReadableStreamDefaultReader;
  binding.IsReadableStream = IsReadableStream;
  binding.IsReadableStreamDisturbed = IsReadableStreamDisturbed;
  binding.IsReadableStreamLocked = IsReadableStreamLocked;
  binding.IsReadableStreamReadable = IsReadableStreamReadable;
  binding.IsReadableStreamClosed = IsReadableStreamClosed;
  binding.IsReadableStreamErrored = IsReadableStreamErrored;
  binding.IsReadableStreamDefaultReader = IsReadableStreamDefaultReader;
  binding.ReadableStreamDefaultReaderRead = ReadableStreamDefaultReaderRead;
  binding.ReadableStreamTee = ReadableStreamTee;
  binding.ReadableStreamDefaultControllerClose = ReadableStreamDefaultControllerClose;
  binding.ReadableStreamDefaultControllerGetDesiredSize = ReadableStreamDefaultControllerGetDesiredSize;
  binding.ReadableStreamDefaultControllerEnqueue = ReadableStreamDefaultControllerEnqueue;
  binding.ReadableStreamDefaultControllerError = ReadableStreamDefaultControllerError;
  binding.createReadableStreamWithExternalController =
      (underlyingSource, strategy) => {
        return new ReadableStream(
            underlyingSource, strategy, createWithExternalControllerSentinel);
      };
});
 dummy<(function() {})